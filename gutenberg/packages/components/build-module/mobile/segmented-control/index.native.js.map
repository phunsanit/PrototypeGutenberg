{"version":3,"sources":["@wordpress/components/src/mobile/segmented-control/index.native.js"],"names":["View","TouchableWithoutFeedback","Text","Platform","LayoutAnimation","Animated","Easing","take","values","map","reduce","useState","useEffect","usePreferredColorSchemeStyle","styles","ANIMATION_DURATION","isIOS","OS","Segment","isSelected","title","onPress","onLayout","isSelectedIOS","segmentStyle","segment","segmentIOS","textStyle","buttonTextDefault","buttonTextDefaultDark","selectedTextStyle","buttonTextSelected","buttonTextSelectedDark","shadowStyle","shadowIOS","SegmentedControls","segments","segmentHandler","selectedIndex","addonLeft","addonRight","selectedSegmentIndex","activeSegmentIndex","setActiveSegmentIndex","width","height","segmentsDimensions","setSegmentsDimensions","Value","positionAnimationValue","setValue","calculateEndValue","containerStyle","container","containerDark","performAnimation","index","timing","toValue","duration","easing","ease","start","containerIOS","offset","paddingLeft","widths","widthsDistance","widthsDistanceSum","sum","n","endValue","onHandlePress","configureNext","create","Types","easeInEaseOut","Properties","opacity","segmentOnLayout","event","nativeEvent","layout","selectedStyle","selected","selectedDark","outlineStyle","outline","outlineIOS","row","flex","left"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tView,\n\tTouchableWithoutFeedback,\n\tText,\n\tPlatform,\n\tLayoutAnimation,\n\tAnimated,\n\tEasing,\n} from 'react-native';\nimport { take, values, map, reduce } from 'lodash';\n/**\n * WordPress dependencies\n */\nimport { useState, useEffect } from '@wordpress/element';\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\n\nconst ANIMATION_DURATION = 200;\n\nconst isIOS = Platform.OS === 'ios';\n\nconst Segment = ( { isSelected, title, onPress, onLayout } ) => {\n\tconst isSelectedIOS = isIOS && isSelected;\n\n\tconst segmentStyle = [ styles.segment, isIOS && styles.segmentIOS ];\n\n\tconst textStyle = usePreferredColorSchemeStyle(\n\t\tstyles.buttonTextDefault,\n\t\tstyles.buttonTextDefaultDark\n\t);\n\tconst selectedTextStyle = usePreferredColorSchemeStyle(\n\t\tstyles.buttonTextSelected,\n\t\tstyles.buttonTextSelectedDark\n\t);\n\tconst shadowStyle = usePreferredColorSchemeStyle( styles.shadowIOS, {} );\n\n\treturn (\n\t\t<View style={ isSelectedIOS && shadowStyle }>\n\t\t\t<TouchableWithoutFeedback onPress={ onPress }>\n\t\t\t\t<View style={ segmentStyle } onLayout={ onLayout }>\n\t\t\t\t\t<Text\n\t\t\t\t\t\tstyle={ [ textStyle, isSelected && selectedTextStyle ] }\n\t\t\t\t\t\tmaxFontSizeMultiplier={ 2 }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ title }\n\t\t\t\t\t</Text>\n\t\t\t\t</View>\n\t\t\t</TouchableWithoutFeedback>\n\t\t</View>\n\t);\n};\n\nconst SegmentedControls = ( {\n\tsegments,\n\tsegmentHandler,\n\tselectedIndex,\n\taddonLeft,\n\taddonRight,\n} ) => {\n\tconst selectedSegmentIndex = selectedIndex || 0;\n\tconst [ activeSegmentIndex, setActiveSegmentIndex ] = useState(\n\t\tselectedSegmentIndex\n\t);\n\tconst [ segmentsDimensions, setSegmentsDimensions ] = useState( {\n\t\t[ activeSegmentIndex ]: { width: 0, height: 0 },\n\t} );\n\tconst [ positionAnimationValue ] = useState( new Animated.Value( 0 ) );\n\n\tuseEffect( () => {\n\t\tsetActiveSegmentIndex( selectedSegmentIndex );\n\t\tsegmentHandler( segments[ selectedSegmentIndex ] );\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tpositionAnimationValue.setValue(\n\t\t\tcalculateEndValue( activeSegmentIndex )\n\t\t);\n\t}, [ segmentsDimensions ] );\n\n\tconst containerStyle = usePreferredColorSchemeStyle(\n\t\tstyles.container,\n\t\tstyles.containerDark\n\t);\n\n\tfunction performAnimation( index ) {\n\t\tAnimated.timing( positionAnimationValue, {\n\t\t\ttoValue: calculateEndValue( index ),\n\t\t\tduration: ANIMATION_DURATION,\n\t\t\teasing: Easing.ease,\n\t\t} ).start();\n\t}\n\n\tfunction calculateEndValue( index ) {\n\t\tconst { paddingLeft: offset } = isIOS\n\t\t\t? styles.containerIOS\n\t\t\t: styles.container;\n\t\tconst widths = map( values( segmentsDimensions ), 'width' );\n\t\tconst widthsDistance = take( widths, index );\n\t\tconst widthsDistanceSum = reduce(\n\t\t\twidthsDistance,\n\t\t\t( sum, n ) => sum + n\n\t\t);\n\n\t\tconst endValue = index === 0 ? 0 : widthsDistanceSum;\n\t\treturn endValue + offset;\n\t}\n\n\tfunction onHandlePress( segment, index ) {\n\t\tLayoutAnimation.configureNext(\n\t\t\tLayoutAnimation.create(\n\t\t\t\tANIMATION_DURATION,\n\t\t\t\tLayoutAnimation.Types.easeInEaseOut,\n\t\t\t\tLayoutAnimation.Properties.opacity\n\t\t\t)\n\t\t);\n\t\tsetActiveSegmentIndex( index );\n\t\tsegmentHandler( segment );\n\t\tperformAnimation( index, segment );\n\t}\n\n\tfunction segmentOnLayout( event, index ) {\n\t\tconst { width, height } = event.nativeEvent.layout;\n\n\t\tsetSegmentsDimensions( {\n\t\t\t...segmentsDimensions,\n\t\t\t[ index ]: { width, height },\n\t\t} );\n\t}\n\n\tconst selectedStyle = usePreferredColorSchemeStyle(\n\t\tstyles.selected,\n\t\tstyles.selectedDark\n\t);\n\n\tconst width = segmentsDimensions[ activeSegmentIndex ].width;\n\tconst height = segmentsDimensions[ activeSegmentIndex ].height;\n\n\tconst outlineStyle = [ styles.outline, isIOS && styles.outlineIOS ];\n\n\treturn (\n\t\t<View style={ styles.row }>\n\t\t\t<View style={ styles.flex }>{ addonLeft }</View>\n\t\t\t<View style={ [ containerStyle, isIOS && styles.containerIOS ] }>\n\t\t\t\t{ segments.map( ( segment, index ) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Segment\n\t\t\t\t\t\t\ttitle={ segment }\n\t\t\t\t\t\t\tonPress={ () => onHandlePress( segment, index ) }\n\t\t\t\t\t\t\tisSelected={ activeSegmentIndex === index }\n\t\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\t\tonLayout={ ( event ) =>\n\t\t\t\t\t\t\t\tsegmentOnLayout( event, index )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\t\t\t\t<Animated.View\n\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twidth,\n\t\t\t\t\t\t\tleft: positionAnimationValue,\n\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectedStyle,\n\t\t\t\t\t\toutlineStyle,\n\t\t\t\t\t] }\n\t\t\t\t/>\n\t\t\t</View>\n\t\t\t<View style={ styles.flex }>{ addonRight }</View>\n\t\t</View>\n\t);\n};\n\nexport default SegmentedControls;\n"]}