{"version":3,"sources":["@wordpress/components/src/number-control/index.js"],"names":["clamp","classNames","forwardRef","Input","add","getValue","roundClamp","subtract","isValueEmpty","inputControlActionTypes","composeStateReducers","useRTL","NumberControl","ref","__unstableStateReducer","stateReducer","state","className","dragDirection","hideHTMLArrows","isDragEnabled","isShiftStepEnabled","label","max","Infinity","min","shiftStep","step","type","typeProp","valueProp","value","props","initialValue","baseValue","isRtl","autoComplete","classes","numberControlStateReducer","action","payload","event","currentValue","PRESS_UP","PRESS_DOWN","enableShift","shiftKey","incrementalValue","parseFloat","nextValue","preventDefault","DRAG","delta","x","y","modifier","directionModifier","directionBaseValue","distance","PRESS_ENTER","SUBMIT"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { clamp } from 'lodash';\nimport classNames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { forwardRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { Input } from './styles/number-control-styles';\nimport { add, getValue, roundClamp, subtract } from './utils';\nimport { isValueEmpty } from '../input-control/utils';\nimport {\n\tinputControlActionTypes,\n\tcomposeStateReducers,\n} from '../input-control/state';\nimport { useRTL } from '../utils/style-mixins';\n\nexport function NumberControl(\n\t{\n\t\t__unstableStateReducer: stateReducer = ( state ) => state,\n\t\tclassName,\n\t\tdragDirection = 'n',\n\t\thideHTMLArrows = false,\n\t\tisDragEnabled = true,\n\t\tisShiftStepEnabled = true,\n\t\tlabel,\n\t\tmax = Infinity,\n\t\tmin = -Infinity,\n\t\tshiftStep = 10,\n\t\tstep = 1,\n\t\ttype: typeProp = 'number',\n\t\tvalue: valueProp,\n\t\t...props\n\t},\n\tref\n) {\n\tconst initialValue = getValue( valueProp, min, max );\n\tconst baseValue = clamp( 0, min, max );\n\tconst isRtl = useRTL();\n\n\tconst autoComplete = typeProp === 'number' ? 'off' : null;\n\tconst classes = classNames( 'components-number-control', className );\n\n\t/**\n\t * \"Middleware\" function that intercepts updates from InputControl.\n\t * This allows us to tap into actions to transform the (next) state for\n\t * InputControl.\n\t *\n\t * @param {Object} state State from InputControl\n\t * @param {Object} action Action triggering state change\n\t * @return {Object} The updated state to apply to InputControl\n\t */\n\tconst numberControlStateReducer = ( state, action ) => {\n\t\tconst { type, payload } = action;\n\t\tconst event = payload?.event;\n\n\t\tconst currentValue = state.value;\n\n\t\t/**\n\t\t * Handles custom UP and DOWN Keyboard events\n\t\t */\n\t\tif (\n\t\t\ttype === inputControlActionTypes.PRESS_UP ||\n\t\t\ttype === inputControlActionTypes.PRESS_DOWN\n\t\t) {\n\t\t\tconst enableShift = event.shiftKey && isShiftStepEnabled;\n\n\t\t\tconst incrementalValue = enableShift\n\t\t\t\t? parseFloat( shiftStep )\n\t\t\t\t: parseFloat( step );\n\t\t\tlet nextValue = isValueEmpty( currentValue )\n\t\t\t\t? baseValue\n\t\t\t\t: currentValue;\n\n\t\t\tif ( event?.preventDefault ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\n\t\t\tif ( type === inputControlActionTypes.PRESS_UP ) {\n\t\t\t\tnextValue = add( nextValue, incrementalValue );\n\t\t\t}\n\n\t\t\tif ( type === inputControlActionTypes.PRESS_DOWN ) {\n\t\t\t\tnextValue = subtract( nextValue, incrementalValue );\n\t\t\t}\n\n\t\t\tnextValue = roundClamp( nextValue, min, max, incrementalValue );\n\n\t\t\tstate.value = nextValue;\n\t\t}\n\n\t\t/**\n\t\t * Handles drag to update events\n\t\t */\n\t\tif ( type === inputControlActionTypes.DRAG && isDragEnabled ) {\n\t\t\tconst { delta, shiftKey } = payload;\n\t\t\tconst [ x, y ] = delta;\n\t\t\tconst modifier = shiftKey ? shiftStep : 1;\n\n\t\t\tlet directionModifier;\n\t\t\tlet directionBaseValue;\n\n\t\t\tswitch ( dragDirection ) {\n\t\t\t\tcase 'n':\n\t\t\t\t\tdirectionBaseValue = y;\n\t\t\t\t\tdirectionModifier = -1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'e':\n\t\t\t\t\tdirectionBaseValue = x;\n\t\t\t\t\tdirectionModifier = isRtl ? -1 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 's':\n\t\t\t\t\tdirectionBaseValue = y;\n\t\t\t\t\tdirectionModifier = 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'w':\n\t\t\t\t\tdirectionBaseValue = x;\n\t\t\t\t\tdirectionModifier = isRtl ? 1 : -1;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst distance = directionBaseValue * modifier * directionModifier;\n\t\t\tlet nextValue;\n\n\t\t\tif ( distance !== 0 ) {\n\t\t\t\tnextValue = roundClamp(\n\t\t\t\t\tadd( currentValue, distance ),\n\t\t\t\t\tmin,\n\t\t\t\t\tmax,\n\t\t\t\t\tmodifier\n\t\t\t\t);\n\n\t\t\t\tstate.value = nextValue;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Handles ENTER key press and submit\n\t\t */\n\t\tif (\n\t\t\ttype === inputControlActionTypes.PRESS_ENTER ||\n\t\t\ttype === inputControlActionTypes.SUBMIT\n\t\t) {\n\t\t\tstate.value = roundClamp( currentValue, min, max );\n\t\t}\n\n\t\treturn state;\n\t};\n\n\treturn (\n\t\t<Input\n\t\t\tautoComplete={ autoComplete }\n\t\t\tinputMode=\"numeric\"\n\t\t\t{ ...props }\n\t\t\tclassName={ classes }\n\t\t\tdragDirection={ dragDirection }\n\t\t\thideHTMLArrows={ hideHTMLArrows }\n\t\t\tisDragEnabled={ isDragEnabled }\n\t\t\tlabel={ label }\n\t\t\tmax={ max }\n\t\t\tmin={ min }\n\t\t\tref={ ref }\n\t\t\ttype={ typeProp }\n\t\t\tvalue={ initialValue }\n\t\t\t__unstableStateReducer={ composeStateReducers(\n\t\t\t\tnumberControlStateReducer,\n\t\t\t\tstateReducer\n\t\t\t) }\n\t\t/>\n\t);\n}\n\nexport default forwardRef( NumberControl );\n"]}