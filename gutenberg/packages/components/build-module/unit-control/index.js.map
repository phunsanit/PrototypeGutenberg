{"version":3,"sources":["@wordpress/components/src/unit-control/index.js"],"names":["noop","classnames","useState","forwardRef","inputControlActionTypes","composeStateReducers","Root","ValueInput","UnitSelectControl","CSS_UNITS","getParsedValue","getValidParsedUnit","UnitControl","ref","__unstableStateReducer","stateReducer","state","autoComplete","className","disabled","disableUnits","isPressEnterToChange","isResetValueOnUnitChange","isUnitSelectTabbable","label","onChange","onUnitChange","size","style","unitProp","unit","units","valueProp","value","props","initialUnit","setUnit","classes","handleOnChange","next","changeProps","parsedValue","parsedUnit","nextValue","handleOnUnitChange","data","default","undefined","unitControlStateReducer","action","type","payload","event","COMMIT","valueToParse","target","inputSuffix","ForwardedUnitControl"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { noop } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useState, forwardRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport {\n\tinputControlActionTypes,\n\tcomposeStateReducers,\n} from '../input-control/state';\nimport { Root, ValueInput } from './styles/unit-control-styles';\nimport UnitSelectControl from './unit-select-control';\nimport { CSS_UNITS, getParsedValue, getValidParsedUnit } from './utils';\n\nfunction UnitControl(\n\t{\n\t\t__unstableStateReducer: stateReducer = ( state ) => state,\n\t\tautoComplete = 'off',\n\t\tclassName,\n\t\tdisabled = false,\n\t\tdisableUnits = false,\n\t\tisPressEnterToChange = false,\n\t\tisResetValueOnUnitChange = false,\n\t\tisUnitSelectTabbable = false,\n\t\tlabel,\n\t\tonChange = noop,\n\t\tonUnitChange = noop,\n\t\tsize = 'default',\n\t\tstyle,\n\t\tunit: unitProp,\n\t\tunits = CSS_UNITS,\n\t\tvalue: valueProp,\n\t\t...props\n\t},\n\tref\n) {\n\tconst [ value, initialUnit ] = getParsedValue( valueProp, unitProp, units );\n\tconst [ unit, setUnit ] = useState( initialUnit );\n\n\tconst classes = classnames( 'components-unit-control', className );\n\n\tconst handleOnChange = ( next, changeProps ) => {\n\t\t/**\n\t\t * Customizing the onChange callback.\n\t\t * This allows as to broadcast a combined value+unit to onChange.\n\t\t */\n\t\tconst [ parsedValue, parsedUnit ] = getValidParsedUnit(\n\t\t\tnext,\n\t\t\tunits,\n\t\t\tvalue,\n\t\t\tunit\n\t\t);\n\t\tconst nextValue = `${ parsedValue }${ parsedUnit }`;\n\n\t\tonChange( nextValue, changeProps );\n\t};\n\n\tconst handleOnUnitChange = ( next, changeProps ) => {\n\t\tconst { data } = changeProps;\n\n\t\tlet nextValue = `${ value }${ next }`;\n\n\t\tif ( isResetValueOnUnitChange && data?.default !== undefined ) {\n\t\t\tnextValue = `${ data.default }${ next }`;\n\t\t}\n\n\t\tonChange( nextValue, changeProps );\n\t\tonUnitChange( next, changeProps );\n\n\t\tsetUnit( next );\n\t};\n\n\t/**\n\t * \"Middleware\" function that intercepts updates from InputControl.\n\t * This allows us to tap into actions to transform the (next) state for\n\t * InputControl.\n\t *\n\t * @param {Object} state State from InputControl\n\t * @param {Object} action Action triggering state change\n\t * @return {Object} The updated state to apply to InputControl\n\t */\n\tconst unitControlStateReducer = ( state, action ) => {\n\t\tconst { type, payload } = action;\n\t\tconst event = payload?.event;\n\n\t\t/**\n\t\t * Customizes the commit interaction.\n\t\t *\n\t\t * This occurs when pressing ENTER to fire a change.\n\t\t * By intercepting the state change, we can parse the incoming\n\t\t * value to determine if the unit needs to be updated.\n\t\t */\n\t\tif ( type === inputControlActionTypes.COMMIT ) {\n\t\t\tconst valueToParse = event?.target?.value;\n\n\t\t\tconst [ parsedValue, parsedUnit ] = getValidParsedUnit(\n\t\t\t\tvalueToParse,\n\t\t\t\tunits,\n\t\t\t\tvalue,\n\t\t\t\tunit\n\t\t\t);\n\n\t\t\tstate.value = parsedValue;\n\n\t\t\t// Update unit if the incoming parsed unit is different.\n\t\t\tif ( unit !== parsedUnit ) {\n\t\t\t\thandleOnUnitChange( parsedUnit, { event } );\n\t\t\t}\n\t\t}\n\n\t\treturn state;\n\t};\n\n\tconst inputSuffix = ! disableUnits ? (\n\t\t<UnitSelectControl\n\t\t\tdisabled={ disabled }\n\t\t\tisTabbable={ isUnitSelectTabbable }\n\t\t\toptions={ units }\n\t\t\tonChange={ handleOnUnitChange }\n\t\t\tsize={ size }\n\t\t\tvalue={ unit }\n\t\t/>\n\t) : null;\n\n\treturn (\n\t\t<Root className=\"components-unit-control-wrapper\" style={ style }>\n\t\t\t<ValueInput\n\t\t\t\taria-label={ label }\n\t\t\t\ttype={ isPressEnterToChange ? 'text' : 'number' }\n\t\t\t\t{ ...props }\n\t\t\t\tautoComplete={ autoComplete }\n\t\t\t\tclassName={ classes }\n\t\t\t\tdisabled={ disabled }\n\t\t\t\tdisableUnits={ disableUnits }\n\t\t\t\tisPressEnterToChange={ isPressEnterToChange }\n\t\t\t\tlabel={ label }\n\t\t\t\tonChange={ handleOnChange }\n\t\t\t\tref={ ref }\n\t\t\t\tsize={ size }\n\t\t\t\tsuffix={ inputSuffix }\n\t\t\t\tvalue={ value }\n\t\t\t\t__unstableStateReducer={ composeStateReducers(\n\t\t\t\t\tunitControlStateReducer,\n\t\t\t\t\tstateReducer\n\t\t\t\t) }\n\t\t\t/>\n\t\t</Root>\n\t);\n}\n\nconst ForwardedUnitControl = forwardRef( UnitControl );\n\nexport default ForwardedUnitControl;\n"]}