{"version":3,"sources":["@wordpress/components/src/color-palette/index.native.js"],"names":["ScrollView","TouchableWithoutFeedback","View","Animated","Easing","map","uniq","useState","useEffect","createRef","usePreferredColorSchemeStyle","styles","ColorIndicator","colorsUtils","ANIMATION_DURATION","ColorPalette","setColor","activeColor","isGradientColor","defaultSettings","currentSegment","onCustomPress","shouldEnableBottomSheetScroll","customSwatchGradients","scrollViewRef","isGradientSegment","segments","Value","scale","opacity","defaultColors","colors","defaultGradientColors","gradients","current","scrollTo","x","y","isSelectedCustom","includes","isSelected","color","timingAnimation","property","toValue","timing","duration","easing","ease","useNativeDriver","performAnimation","setValue","parallel","start","scaleInterpolation","interpolate","inputRange","outputRange","onColorPress","verticalSeparatorStyle","verticalSeparator","verticalSeparatorDark","contentContainer","container","scaleValue","transform","colorIndicator"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tScrollView,\n\tTouchableWithoutFeedback,\n\tView,\n\tAnimated,\n\tEasing,\n} from 'react-native';\nimport { map, uniq } from 'lodash';\n/**\n * WordPress dependencies\n */\nimport { useState, useEffect, createRef } from '@wordpress/element';\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport ColorIndicator from '../color-indicator';\nimport { colorsUtils } from '../mobile/color-settings/utils';\n\nconst ANIMATION_DURATION = 200;\n\nfunction ColorPalette( {\n\tsetColor,\n\tactiveColor,\n\tisGradientColor,\n\tdefaultSettings,\n\tcurrentSegment,\n\tonCustomPress,\n\tshouldEnableBottomSheetScroll,\n} ) {\n\tconst customSwatchGradients = [\n\t\t'linear-gradient(120deg, rgba(255,0,0,.8), 0%, rgba(255,255,255,1) 70.71%)',\n\t\t'linear-gradient(240deg, rgba(0,255,0,.8), 0%, rgba(0,255,0,0) 70.71%)',\n\t\t'linear-gradient(360deg, rgba(0,0,255,.8), 0%, rgba(0,0,255,0) 70.71%)',\n\t];\n\n\tconst scrollViewRef = createRef();\n\n\tconst isGradientSegment = currentSegment === colorsUtils.segments[ 1 ];\n\n\tconst [ scale ] = useState( new Animated.Value( 1 ) );\n\tconst [ opacity ] = useState( new Animated.Value( 1 ) );\n\n\tconst defaultColors = uniq( map( defaultSettings.colors, 'color' ) );\n\tconst defaultGradientColors = uniq(\n\t\tmap( defaultSettings.gradients, 'gradient' )\n\t);\n\tconst colors = isGradientSegment ? defaultGradientColors : defaultColors;\n\n\tuseEffect( () => {\n\t\tscrollViewRef.current.scrollTo( { x: 0, y: 0 } );\n\t}, [ currentSegment ] );\n\n\tfunction isSelectedCustom() {\n\t\treturn (\n\t\t\t! isGradientColor && activeColor && ! colors.includes( activeColor )\n\t\t);\n\t}\n\n\tfunction isSelected( color ) {\n\t\treturn ! isSelectedCustom() && activeColor === color;\n\t}\n\n\tfunction timingAnimation( property, toValue ) {\n\t\treturn Animated.timing( property, {\n\t\t\ttoValue,\n\t\t\tduration: ANIMATION_DURATION,\n\t\t\teasing: Easing.ease,\n\t\t\tuseNativeDriver: true,\n\t\t} );\n\t}\n\n\tfunction performAnimation( color ) {\n\t\topacity.setValue( isSelected( color ) ? 1 : 0 );\n\t\tscale.setValue( 1 );\n\n\t\tAnimated.parallel( [\n\t\t\ttimingAnimation( scale, 2 ),\n\t\t\ttimingAnimation( opacity, 1 ),\n\t\t] ).start();\n\t}\n\n\tconst scaleInterpolation = scale.interpolate( {\n\t\tinputRange: [ 1, 1.5, 2 ],\n\t\toutputRange: [ 1, 0.7, 1 ],\n\t} );\n\n\tfunction onColorPress( color ) {\n\t\tperformAnimation( color );\n\t\tsetColor( color );\n\t}\n\n\tconst verticalSeparatorStyle = usePreferredColorSchemeStyle(\n\t\tstyles.verticalSeparator,\n\t\tstyles.verticalSeparatorDark\n\t);\n\n\treturn (\n\t\t<ScrollView\n\t\t\tcontentContainerStyle={ styles.contentContainer }\n\t\t\tstyle={ styles.container }\n\t\t\thorizontal\n\t\t\tshowsHorizontalScrollIndicator={ false }\n\t\t\tkeyboardShouldPersistTaps=\"always\"\n\t\t\tdisableScrollViewPanResponder\n\t\t\tonScrollBeginDrag={ () => shouldEnableBottomSheetScroll( false ) }\n\t\t\tonScrollEndDrag={ () => shouldEnableBottomSheetScroll( true ) }\n\t\t\tref={ scrollViewRef }\n\t\t>\n\t\t\t{ colors.map( ( color ) => {\n\t\t\t\tconst scaleValue = isSelected( color ) ? scaleInterpolation : 1;\n\t\t\t\treturn (\n\t\t\t\t\t<TouchableWithoutFeedback\n\t\t\t\t\t\tonPress={ () => onColorPress( color ) }\n\t\t\t\t\t\tkey={ `${ color }-${ isSelected( color ) }` }\n\t\t\t\t\t>\n\t\t\t\t\t\t<Animated.View\n\t\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t\ttransform: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tscale: scaleValue,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ColorIndicator\n\t\t\t\t\t\t\t\tcolor={ color }\n\t\t\t\t\t\t\t\tisSelected={ isSelected( color ) }\n\t\t\t\t\t\t\t\topacity={ opacity }\n\t\t\t\t\t\t\t\tstyle={ styles.colorIndicator }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Animated.View>\n\t\t\t\t\t</TouchableWithoutFeedback>\n\t\t\t\t);\n\t\t\t} ) }\n\t\t\t{ ! isGradientSegment && (\n\t\t\t\t<>\n\t\t\t\t\t<View style={ verticalSeparatorStyle } />\n\t\t\t\t\t<TouchableWithoutFeedback onPress={ onCustomPress }>\n\t\t\t\t\t\t<View>\n\t\t\t\t\t\t\t<ColorIndicator\n\t\t\t\t\t\t\t\twithCustomPicker={ ! isGradientSegment }\n\t\t\t\t\t\t\t\tcolor={ customSwatchGradients }\n\t\t\t\t\t\t\t\tisSelected={ isSelectedCustom() }\n\t\t\t\t\t\t\t\tstyle={ styles.colorIndicator }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</TouchableWithoutFeedback>\n\t\t\t\t</>\n\t\t\t) }\n\t\t</ScrollView>\n\t);\n}\n\nexport default ColorPalette;\n"]}