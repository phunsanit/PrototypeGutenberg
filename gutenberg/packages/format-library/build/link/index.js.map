{"version":3,"sources":["@wordpress/format-library/src/link/index.js"],"names":["name","title","link","tagName","className","attributes","url","type","id","target","__unstablePasteRule","value","html","plainText","pastedText","replace","trim","window","console","log","edit","arguments","addLink","bind","stopAddingLink","onRemoveFormat","state","addingLink","props","onChange","text","setState","onFocus","speak","isActive","activeAttributes","linkOff","linkIcon","Component"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { withSpokenMessages } from '@wordpress/components';\nimport {\n\tgetTextContent,\n\tapplyFormat,\n\tremoveFormat,\n\tslice,\n\tisCollapsed,\n} from '@wordpress/rich-text';\nimport { isURL, isEmail } from '@wordpress/url';\nimport {\n\tRichTextToolbarButton,\n\tRichTextShortcut,\n} from '@wordpress/block-editor';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { link as linkIcon, linkOff } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport InlineLinkUI from './inline';\n\nconst name = 'core/link';\nconst title = __( 'Link' );\n\nexport const link = {\n\tname,\n\ttitle,\n\ttagName: 'a',\n\tclassName: null,\n\tattributes: {\n\t\turl: 'href',\n\t\ttype: 'data-type',\n\t\tid: 'data-id',\n\t\ttarget: 'target',\n\t},\n\t__unstablePasteRule( value, { html, plainText } ) {\n\t\tif ( isCollapsed( value ) ) {\n\t\t\treturn value;\n\t\t}\n\n\t\tconst pastedText = ( html || plainText )\n\t\t\t.replace( /<[^>]+>/g, '' )\n\t\t\t.trim();\n\n\t\t// A URL was pasted, turn the selection into a link\n\t\tif ( ! isURL( pastedText ) ) {\n\t\t\treturn value;\n\t\t}\n\n\t\t// Allows us to ask for this information when we get a report.\n\t\twindow.console.log( 'Created link:\\n\\n', pastedText );\n\n\t\treturn applyFormat( value, {\n\t\t\ttype: name,\n\t\t\tattributes: {\n\t\t\t\turl: decodeEntities( pastedText ),\n\t\t\t},\n\t\t} );\n\t},\n\tedit: withSpokenMessages(\n\t\tclass LinkEdit extends Component {\n\t\t\tconstructor() {\n\t\t\t\tsuper( ...arguments );\n\n\t\t\t\tthis.addLink = this.addLink.bind( this );\n\t\t\t\tthis.stopAddingLink = this.stopAddingLink.bind( this );\n\t\t\t\tthis.onRemoveFormat = this.onRemoveFormat.bind( this );\n\t\t\t\tthis.state = {\n\t\t\t\t\taddingLink: false,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\taddLink() {\n\t\t\t\tconst { value, onChange } = this.props;\n\t\t\t\tconst text = getTextContent( slice( value ) );\n\n\t\t\t\tif ( text && isURL( text ) ) {\n\t\t\t\t\tonChange(\n\t\t\t\t\t\tapplyFormat( value, {\n\t\t\t\t\t\t\ttype: name,\n\t\t\t\t\t\t\tattributes: { url: text },\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\t\t\t\t} else if ( text && isEmail( text ) ) {\n\t\t\t\t\tonChange(\n\t\t\t\t\t\tapplyFormat( value, {\n\t\t\t\t\t\t\ttype: name,\n\t\t\t\t\t\t\tattributes: { url: `mailto:${ text }` },\n\t\t\t\t\t\t} )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tthis.setState( { addingLink: true } );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstopAddingLink() {\n\t\t\t\tthis.setState( { addingLink: false } );\n\t\t\t\tthis.props.onFocus();\n\t\t\t}\n\n\t\t\tonRemoveFormat() {\n\t\t\t\tconst { value, onChange, speak } = this.props;\n\n\t\t\t\tonChange( removeFormat( value, name ) );\n\t\t\t\tspeak( __( 'Link removed.' ), 'assertive' );\n\t\t\t}\n\n\t\t\trender() {\n\t\t\t\tconst {\n\t\t\t\t\tisActive,\n\t\t\t\t\tactiveAttributes,\n\t\t\t\t\tvalue,\n\t\t\t\t\tonChange,\n\t\t\t\t} = this.props;\n\n\t\t\t\treturn (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<RichTextShortcut\n\t\t\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t\t\tcharacter=\"k\"\n\t\t\t\t\t\t\tonUse={ this.addLink }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<RichTextShortcut\n\t\t\t\t\t\t\ttype=\"primaryShift\"\n\t\t\t\t\t\t\tcharacter=\"k\"\n\t\t\t\t\t\t\tonUse={ this.onRemoveFormat }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{ isActive && (\n\t\t\t\t\t\t\t<RichTextToolbarButton\n\t\t\t\t\t\t\t\tname=\"link\"\n\t\t\t\t\t\t\t\ticon={ linkOff }\n\t\t\t\t\t\t\t\ttitle={ __( 'Unlink' ) }\n\t\t\t\t\t\t\t\tonClick={ this.onRemoveFormat }\n\t\t\t\t\t\t\t\tisActive={ isActive }\n\t\t\t\t\t\t\t\tshortcutType=\"primaryShift\"\n\t\t\t\t\t\t\t\tshortcutCharacter=\"k\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ ! isActive && (\n\t\t\t\t\t\t\t<RichTextToolbarButton\n\t\t\t\t\t\t\t\tname=\"link\"\n\t\t\t\t\t\t\t\ticon={ linkIcon }\n\t\t\t\t\t\t\t\ttitle={ title }\n\t\t\t\t\t\t\t\tonClick={ this.addLink }\n\t\t\t\t\t\t\t\tisActive={ isActive }\n\t\t\t\t\t\t\t\tshortcutType=\"primary\"\n\t\t\t\t\t\t\t\tshortcutCharacter=\"k\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ ( this.state.addingLink || isActive ) && (\n\t\t\t\t\t\t\t<InlineLinkUI\n\t\t\t\t\t\t\t\taddingLink={ this.state.addingLink }\n\t\t\t\t\t\t\t\tstopAddingLink={ this.stopAddingLink }\n\t\t\t\t\t\t\t\tisActive={ isActive }\n\t\t\t\t\t\t\t\tactiveAttributes={ activeAttributes }\n\t\t\t\t\t\t\t\tvalue={ value }\n\t\t\t\t\t\t\t\tonChange={ onChange }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</>\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t),\n};\n"]}