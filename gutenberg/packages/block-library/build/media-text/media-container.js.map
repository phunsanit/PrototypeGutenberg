{"version":3,"sources":["@wordpress/block-library/src/media-text/media-container.js"],"names":["ALLOWED_MEDIA_TYPES","imageFillStyles","url","focalPoint","backgroundImage","backgroundPosition","x","y","ResizableBoxContainer","isSelected","isStackedOnMobile","props","isMobile","MediaContainer","arguments","onUploadError","bind","message","noticeOperations","removeAllNotices","createErrorNotice","onSelectMedia","mediaUrl","mediaId","mediaAlt","className","imageFill","backgroundStyles","renderToolbarEditButton","noticeUI","icon","title","mediaPosition","mediaType","mediaWidth","commitWidthChange","onWidthChange","toggleSelection","onResizeStart","onResize","event","direction","elt","parseInt","style","width","onResizeStop","enablePositions","right","left","mediaElement","renderImage","renderVideo","renderPlaceholder","Component","dispatch","withNotices"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { ResizableBox, withNotices } from '@wordpress/components';\nimport {\n\tBlockControls,\n\tBlockIcon,\n\tMediaPlaceholder,\n\tMediaReplaceFlow,\n} from '@wordpress/block-editor';\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { compose, useViewportMatch } from '@wordpress/compose';\nimport { withDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport icon from './media-container-icon';\n\n/**\n * Constants\n */\nconst ALLOWED_MEDIA_TYPES = [ 'image', 'video' ];\n\nexport function imageFillStyles( url, focalPoint ) {\n\treturn url\n\t\t? {\n\t\t\t\tbackgroundImage: `url(${ url })`,\n\t\t\t\tbackgroundPosition: focalPoint\n\t\t\t\t\t? `${ focalPoint.x * 100 }% ${ focalPoint.y * 100 }%`\n\t\t\t\t\t: `50% 50%`,\n\t\t  }\n\t\t: {};\n}\n\nfunction ResizableBoxContainer( { isSelected, isStackedOnMobile, ...props } ) {\n\tconst isMobile = useViewportMatch( 'small', '<' );\n\treturn (\n\t\t<ResizableBox\n\t\t\tshowHandle={ isSelected && ( ! isMobile || ! isStackedOnMobile ) }\n\t\t\t{ ...props }\n\t\t/>\n\t);\n}\nclass MediaContainer extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.onUploadError = this.onUploadError.bind( this );\n\t}\n\n\tonUploadError( message ) {\n\t\tconst { noticeOperations } = this.props;\n\t\tnoticeOperations.removeAllNotices();\n\t\tnoticeOperations.createErrorNotice( message );\n\t}\n\n\trenderToolbarEditButton() {\n\t\tconst { onSelectMedia, mediaUrl, mediaId } = this.props;\n\t\treturn (\n\t\t\t<BlockControls>\n\t\t\t\t<MediaReplaceFlow\n\t\t\t\t\tmediaId={ mediaId }\n\t\t\t\t\tmediaURL={ mediaUrl }\n\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\taccept=\"image/*,video/*\"\n\t\t\t\t\tonSelect={ onSelectMedia }\n\t\t\t\t/>\n\t\t\t</BlockControls>\n\t\t);\n\t}\n\n\trenderImage() {\n\t\tconst {\n\t\t\tmediaAlt,\n\t\t\tmediaUrl,\n\t\t\tclassName,\n\t\t\timageFill,\n\t\t\tfocalPoint,\n\t\t} = this.props;\n\t\tconst backgroundStyles = imageFill\n\t\t\t? imageFillStyles( mediaUrl, focalPoint )\n\t\t\t: {};\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ this.renderToolbarEditButton() }\n\t\t\t\t<figure className={ className } style={ backgroundStyles }>\n\t\t\t\t\t<img src={ mediaUrl } alt={ mediaAlt } />\n\t\t\t\t</figure>\n\t\t\t</>\n\t\t);\n\t}\n\n\trenderVideo() {\n\t\tconst { mediaUrl, className } = this.props;\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ this.renderToolbarEditButton() }\n\t\t\t\t<figure className={ className }>\n\t\t\t\t\t<video controls src={ mediaUrl } />\n\t\t\t\t</figure>\n\t\t\t</>\n\t\t);\n\t}\n\n\trenderPlaceholder() {\n\t\tconst { onSelectMedia, className, noticeUI } = this.props;\n\t\treturn (\n\t\t\t<MediaPlaceholder\n\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\t\tlabels={ {\n\t\t\t\t\ttitle: __( 'Media area' ),\n\t\t\t\t} }\n\t\t\t\tclassName={ className }\n\t\t\t\tonSelect={ onSelectMedia }\n\t\t\t\taccept=\"image/*,video/*\"\n\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\tnotices={ noticeUI }\n\t\t\t\tonError={ this.onUploadError }\n\t\t\t/>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tmediaPosition,\n\t\t\tmediaUrl,\n\t\t\tmediaType,\n\t\t\tmediaWidth,\n\t\t\tcommitWidthChange,\n\t\t\tonWidthChange,\n\t\t\ttoggleSelection,\n\t\t\tisSelected,\n\t\t\tisStackedOnMobile,\n\t\t} = this.props;\n\t\tif ( mediaType && mediaUrl ) {\n\t\t\tconst onResizeStart = () => {\n\t\t\t\ttoggleSelection( false );\n\t\t\t};\n\t\t\tconst onResize = ( event, direction, elt ) => {\n\t\t\t\tonWidthChange( parseInt( elt.style.width ) );\n\t\t\t};\n\t\t\tconst onResizeStop = ( event, direction, elt ) => {\n\t\t\t\ttoggleSelection( true );\n\t\t\t\tcommitWidthChange( parseInt( elt.style.width ) );\n\t\t\t};\n\t\t\tconst enablePositions = {\n\t\t\t\tright: mediaPosition === 'left',\n\t\t\t\tleft: mediaPosition === 'right',\n\t\t\t};\n\n\t\t\tlet mediaElement = null;\n\t\t\tswitch ( mediaType ) {\n\t\t\t\tcase 'image':\n\t\t\t\t\tmediaElement = this.renderImage();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'video':\n\t\t\t\t\tmediaElement = this.renderVideo();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<ResizableBoxContainer\n\t\t\t\t\tclassName=\"editor-media-container__resizer\"\n\t\t\t\t\tsize={ { width: mediaWidth + '%' } }\n\t\t\t\t\tminWidth=\"10%\"\n\t\t\t\t\tmaxWidth=\"100%\"\n\t\t\t\t\tenable={ enablePositions }\n\t\t\t\t\tonResizeStart={ onResizeStart }\n\t\t\t\t\tonResize={ onResize }\n\t\t\t\t\tonResizeStop={ onResizeStop }\n\t\t\t\t\taxis=\"x\"\n\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\tisStackedOnMobile={ isStackedOnMobile }\n\t\t\t\t>\n\t\t\t\t\t{ mediaElement }\n\t\t\t\t</ResizableBoxContainer>\n\t\t\t);\n\t\t}\n\t\treturn this.renderPlaceholder();\n\t}\n}\n\nexport default compose( [\n\twithDispatch( ( dispatch ) => {\n\t\tconst { toggleSelection } = dispatch( 'core/block-editor' );\n\n\t\treturn {\n\t\t\ttoggleSelection,\n\t\t};\n\t} ),\n\twithNotices,\n] )( MediaContainer );\n"]}