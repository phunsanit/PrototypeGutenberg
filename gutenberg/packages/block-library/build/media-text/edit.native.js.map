{"version":3,"sources":["@wordpress/block-library/src/media-text/edit.native.js"],"names":["ALLOWED_BLOCKS","TEMPLATE","WIDTH_CONSTRAINT_PERCENTAGE","BREAKPOINTS","mobile","applyWidthConstraints","width","Math","max","min","MediaTextEdit","arguments","onSelectMedia","bind","onMediaUpdate","onWidthChange","commitWidthChange","onLayoutChange","state","mediaWidth","containerWidth","media","setAttributes","props","mediaType","src","media_type","type","sizes","mediaAlt","alt","mediaId","id","mediaUrl","url","imageFill","undefined","focalPoint","setState","nativeEvent","layout","attributes","isSelected","mediaPosition","onFocus","backgroundColor","isRTL","wrapperProps","isStackedOnMobile","verticalAlignment","isMobile","shouldStack","temporaryMediaWidth","widthString","innerBlockContainerStyle","styles","innerBlock","innerBlockStackMediaLeft","innerBlockStackMediaRight","containerStyles","style","color","innerBlockWidth","innerBlockWidthString","mediaContainerStyle","mediaStackLeft","mediaStackRight","mediaLeft","mediaRight","toolbarControls","icon","pullRight","pullLeft","title","isActive","onClick","onVerticalAlignmentChange","alignment","renderMediaArea","Component","select","clientId","getSelectedBlockClientId","getBlockRootClientId","getBlockParents","getSettings","parents","selectedBlockClientId","isParentSelected","isAncestorSelected","includes"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { get } from 'lodash';\nimport { View } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport {\n\tBlockControls,\n\tBlockVerticalAlignmentToolbar,\n\tInnerBlocks,\n\twithColors,\n} from '@wordpress/block-editor';\nimport { Component } from '@wordpress/element';\nimport { ToolbarGroup } from '@wordpress/components';\nimport { withSelect } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { pullLeft, pullRight } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport MediaContainer from './media-container';\nimport styles from './style.scss';\n\n/**\n * Constants\n */\nconst ALLOWED_BLOCKS = [\n\t'core/button',\n\t'core/paragraph',\n\t'core/heading',\n\t'core/list',\n];\nconst TEMPLATE = [ [ 'core/paragraph' ] ];\n// this limits the resize to a safe zone to avoid making broken layouts\nconst WIDTH_CONSTRAINT_PERCENTAGE = 15;\nconst BREAKPOINTS = {\n\tmobile: 480,\n};\nconst applyWidthConstraints = ( width ) =>\n\tMath.max(\n\t\tWIDTH_CONSTRAINT_PERCENTAGE,\n\t\tMath.min( width, 100 - WIDTH_CONSTRAINT_PERCENTAGE )\n\t);\n\nclass MediaTextEdit extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onSelectMedia = this.onSelectMedia.bind( this );\n\t\tthis.onMediaUpdate = this.onMediaUpdate.bind( this );\n\t\tthis.onWidthChange = this.onWidthChange.bind( this );\n\t\tthis.commitWidthChange = this.commitWidthChange.bind( this );\n\t\tthis.onLayoutChange = this.onLayoutChange.bind( this );\n\n\t\tthis.state = {\n\t\t\tmediaWidth: null,\n\t\t\tcontainerWidth: 0,\n\t\t};\n\t}\n\n\tonSelectMedia( media ) {\n\t\tconst { setAttributes } = this.props;\n\n\t\tlet mediaType;\n\t\tlet src;\n\t\t// for media selections originated from a file upload.\n\t\tif ( media.media_type ) {\n\t\t\tif ( media.media_type === 'image' ) {\n\t\t\t\tmediaType = 'image';\n\t\t\t} else {\n\t\t\t\t// only images and videos are accepted so if the media_type is not an image we can assume it is a video.\n\t\t\t\t// video contain the media type of 'file' in the object returned from the rest api.\n\t\t\t\tmediaType = 'video';\n\t\t\t}\n\t\t} else {\n\t\t\t// for media selections originated from existing files in the media library.\n\t\t\tmediaType = media.type;\n\t\t}\n\n\t\tif ( mediaType === 'image' && media.sizes ) {\n\t\t\t// Try the \"large\" size URL, falling back to the \"full\" size URL below.\n\t\t\tsrc =\n\t\t\t\tget( media, [ 'sizes', 'large', 'url' ] ) ||\n\t\t\t\tget( media, [\n\t\t\t\t\t'media_details',\n\t\t\t\t\t'sizes',\n\t\t\t\t\t'large',\n\t\t\t\t\t'source_url',\n\t\t\t\t] );\n\t\t}\n\n\t\tsetAttributes( {\n\t\t\tmediaAlt: media.alt,\n\t\t\tmediaId: media.id,\n\t\t\tmediaType,\n\t\t\tmediaUrl: src || media.url,\n\t\t\timageFill: undefined,\n\t\t\tfocalPoint: undefined,\n\t\t} );\n\t}\n\n\tonMediaUpdate( media ) {\n\t\tconst { setAttributes } = this.props;\n\n\t\tsetAttributes( {\n\t\t\tmediaId: media.id,\n\t\t\tmediaUrl: media.url,\n\t\t} );\n\t}\n\n\tonWidthChange( width ) {\n\t\tthis.setState( {\n\t\t\tmediaWidth: applyWidthConstraints( width ),\n\t\t} );\n\t}\n\n\tcommitWidthChange( width ) {\n\t\tconst { setAttributes } = this.props;\n\n\t\tsetAttributes( {\n\t\t\tmediaWidth: applyWidthConstraints( width ),\n\t\t} );\n\t\tthis.setState( {\n\t\t\tmediaWidth: null,\n\t\t} );\n\t}\n\n\tonLayoutChange( { nativeEvent } ) {\n\t\tconst { width } = nativeEvent.layout;\n\t\tconst { containerWidth } = this.state;\n\n\t\tif ( containerWidth === width ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.setState( {\n\t\t\tcontainerWidth: width,\n\t\t} );\n\t}\n\n\trenderMediaArea() {\n\t\tconst { attributes, isSelected } = this.props;\n\t\tconst {\n\t\t\tmediaAlt,\n\t\t\tmediaId,\n\t\t\tmediaPosition,\n\t\t\tmediaType,\n\t\t\tmediaUrl,\n\t\t\tmediaWidth,\n\t\t\timageFill,\n\t\t\tfocalPoint,\n\t\t} = attributes;\n\n\t\treturn (\n\t\t\t<MediaContainer\n\t\t\t\tonSelectMedia={ this.onSelectMedia }\n\t\t\t\tonMediaUpdate={ this.onMediaUpdate }\n\t\t\t\tonWidthChange={ this.onWidthChange }\n\t\t\t\tcommitWidthChange={ this.commitWidthChange }\n\t\t\t\tonFocus={ this.props.onFocus }\n\t\t\t\t{ ...{\n\t\t\t\t\tmediaAlt,\n\t\t\t\t\tmediaId,\n\t\t\t\t\tmediaType,\n\t\t\t\t\tmediaUrl,\n\t\t\t\t\tmediaPosition,\n\t\t\t\t\tmediaWidth,\n\t\t\t\t\timageFill,\n\t\t\t\t\tfocalPoint,\n\t\t\t\t\tisSelected,\n\t\t\t\t} }\n\t\t\t/>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tattributes,\n\t\t\tbackgroundColor,\n\t\t\tsetAttributes,\n\t\t\tisSelected,\n\t\t\tisRTL,\n\t\t\twrapperProps,\n\t\t} = this.props;\n\t\tconst {\n\t\t\tisStackedOnMobile,\n\t\t\tmediaPosition,\n\t\t\tmediaWidth,\n\t\t\tverticalAlignment,\n\t\t} = attributes;\n\t\tconst { containerWidth } = this.state;\n\n\t\tconst isMobile = containerWidth < BREAKPOINTS.mobile;\n\t\tconst shouldStack = isStackedOnMobile && isMobile;\n\t\tconst temporaryMediaWidth = shouldStack\n\t\t\t? 100\n\t\t\t: this.state.mediaWidth || mediaWidth;\n\t\tconst widthString = `${ temporaryMediaWidth }%`;\n\n\t\tconst innerBlockContainerStyle = ! shouldStack\n\t\t\t? styles.innerBlock\n\t\t\t: {\n\t\t\t\t\t...( mediaPosition === 'left'\n\t\t\t\t\t\t? styles.innerBlockStackMediaLeft\n\t\t\t\t\t\t: styles.innerBlockStackMediaRight ),\n\t\t\t  };\n\n\t\tconst containerStyles = {\n\t\t\t...styles[ 'wp-block-media-text' ],\n\t\t\t...styles[\n\t\t\t\t`is-vertically-aligned-${ verticalAlignment || 'center' }`\n\t\t\t],\n\t\t\t...( mediaPosition === 'right'\n\t\t\t\t? styles[ 'has-media-on-the-right' ]\n\t\t\t\t: {} ),\n\t\t\t...( shouldStack && styles[ 'is-stacked-on-mobile' ] ),\n\t\t\t...( shouldStack && mediaPosition === 'right'\n\t\t\t\t? styles[ 'is-stacked-on-mobile.has-media-on-the-right' ]\n\t\t\t\t: {} ),\n\t\t\t...( isSelected && styles[ 'is-selected' ] ),\n\t\t\tbackgroundColor:\n\t\t\t\twrapperProps?.style?.backgroundColor || backgroundColor.color,\n\t\t};\n\n\t\tconst innerBlockWidth = shouldStack ? 100 : 100 - temporaryMediaWidth;\n\t\tconst innerBlockWidthString = `${ innerBlockWidth }%`;\n\n\t\tconst mediaContainerStyle = shouldStack\n\t\t\t? {\n\t\t\t\t\t...( mediaPosition === 'left' && styles.mediaStackLeft ),\n\t\t\t\t\t...( mediaPosition === 'right' && styles.mediaStackRight ),\n\t\t\t  }\n\t\t\t: {\n\t\t\t\t\t...( mediaPosition === 'left' && styles.mediaLeft ),\n\t\t\t\t\t...( mediaPosition === 'right' && styles.mediaRight ),\n\t\t\t  };\n\n\t\tconst toolbarControls = [\n\t\t\t{\n\t\t\t\ticon: isRTL ? pullRight : pullLeft,\n\t\t\t\ttitle: __( 'Show media on left' ),\n\t\t\t\tisActive: mediaPosition === 'left',\n\t\t\t\tonClick: () => setAttributes( { mediaPosition: 'left' } ),\n\t\t\t},\n\t\t\t{\n\t\t\t\ticon: isRTL ? pullLeft : pullRight,\n\t\t\t\ttitle: __( 'Show media on right' ),\n\t\t\t\tisActive: mediaPosition === 'right',\n\t\t\t\tonClick: () => setAttributes( { mediaPosition: 'right' } ),\n\t\t\t},\n\t\t];\n\n\t\tconst onVerticalAlignmentChange = ( alignment ) => {\n\t\t\tsetAttributes( { verticalAlignment: alignment } );\n\t\t};\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<BlockControls>\n\t\t\t\t\t<ToolbarGroup controls={ toolbarControls } />\n\t\t\t\t\t<BlockVerticalAlignmentToolbar\n\t\t\t\t\t\tonChange={ onVerticalAlignmentChange }\n\t\t\t\t\t\tvalue={ verticalAlignment }\n\t\t\t\t\t/>\n\t\t\t\t</BlockControls>\n\t\t\t\t<View\n\t\t\t\t\tstyle={ containerStyles }\n\t\t\t\t\tonLayout={ this.onLayoutChange }\n\t\t\t\t>\n\t\t\t\t\t<View\n\t\t\t\t\t\tstyle={ { width: widthString, ...mediaContainerStyle } }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ this.renderMediaArea() }\n\t\t\t\t\t</View>\n\t\t\t\t\t<View\n\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\twidth: innerBlockWidthString,\n\t\t\t\t\t\t\t...innerBlockContainerStyle,\n\t\t\t\t\t\t} }\n\t\t\t\t\t>\n\t\t\t\t\t\t<InnerBlocks\n\t\t\t\t\t\t\tallowedBlocks={ ALLOWED_BLOCKS }\n\t\t\t\t\t\t\ttemplate={ TEMPLATE }\n\t\t\t\t\t\t\ttemplateInsertUpdatesSelection={ false }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</View>\n\t\t\t\t</View>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithColors( 'backgroundColor' ),\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst {\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockParents,\n\t\t\tgetSettings,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst parents = getBlockParents( clientId, true );\n\n\t\tconst selectedBlockClientId = getSelectedBlockClientId();\n\t\tconst isParentSelected =\n\t\t\tselectedBlockClientId &&\n\t\t\tselectedBlockClientId === getBlockRootClientId( clientId );\n\t\tconst isAncestorSelected =\n\t\t\tselectedBlockClientId && parents.includes( selectedBlockClientId );\n\n\t\treturn {\n\t\t\tisSelected: selectedBlockClientId === clientId,\n\t\t\tisParentSelected,\n\t\t\tisAncestorSelected,\n\t\t\tisRTL: getSettings().isRTL,\n\t\t};\n\t} )\n)( MediaTextEdit );\n"]}