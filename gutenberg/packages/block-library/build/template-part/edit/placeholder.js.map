{"version":3,"sources":["@wordpress/block-library/src/template-part/edit/placeholder.js"],"names":["TemplatePartPreview","blocks","TemplatePartPlaceholder","setAttributes","slug","_setSlug","theme","setTheme","help","setHelp","postId","preview","select","templatePart","getEntityRecord","setSlug","nextSlug","saveEntityRecord","onChooseOrCreate","nextAttributes","undefined","cleanSlug","title","status","meta","id","layout"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useEntityBlockEditor, EntityProvider } from '@wordpress/core-data';\nimport { __ } from '@wordpress/i18n';\nimport { BlockPreview } from '@wordpress/block-editor';\nimport { useState, useCallback } from '@wordpress/element';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { cleanForSlug } from '@wordpress/url';\nimport { Placeholder, TextControl, Button } from '@wordpress/components';\nimport { layout } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport useTemplatePartPost from './use-template-part-post';\n\nfunction TemplatePartPreview() {\n\tconst [ blocks ] = useEntityBlockEditor( 'postType', 'wp_template_part' );\n\treturn (\n\t\t<div className=\"wp-block-template-part__placeholder-preview\">\n\t\t\t<div className=\"wp-block-template-part__placeholder-preview-title\">\n\t\t\t\t{ __( 'Preview' ) }\n\t\t\t</div>\n\t\t\t<BlockPreview blocks={ blocks } viewportWidth={ 1200 } />\n\t\t</div>\n\t);\n}\n\nexport default function TemplatePartPlaceholder( { setAttributes } ) {\n\tconst [ slug, _setSlug ] = useState( '' );\n\tconst [ theme, setTheme ] = useState( '' );\n\tconst [ help, setHelp ] = useState();\n\n\t// Try to find an existing template part.\n\tconst postId = useTemplatePartPost( null, slug, theme );\n\n\t// If found, get its preview.\n\tconst preview = useSelect(\n\t\t( select ) => {\n\t\t\tif ( ! postId ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst templatePart = select( 'core' ).getEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\t'wp_template_part',\n\t\t\t\tpostId\n\t\t\t);\n\t\t\tif ( templatePart ) {\n\t\t\t\treturn (\n\t\t\t\t\t<EntityProvider\n\t\t\t\t\t\tkind=\"postType\"\n\t\t\t\t\t\ttype=\"wp_template_part\"\n\t\t\t\t\t\tid={ postId }\n\t\t\t\t\t>\n\t\t\t\t\t\t<TemplatePartPreview />\n\t\t\t\t\t</EntityProvider>\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\t[ postId ]\n\t);\n\n\tconst setSlug = useCallback( ( nextSlug ) => {\n\t\t_setSlug( nextSlug );\n\t\tsetHelp( cleanForSlug( nextSlug ) );\n\t}, [] );\n\n\tconst { saveEntityRecord } = useDispatch( 'core' );\n\tconst onChooseOrCreate = useCallback( async () => {\n\t\tconst nextAttributes = { slug, theme };\n\t\tif ( postId !== undefined && postId !== null ) {\n\t\t\t// Existing template part found.\n\t\t\tnextAttributes.postId = postId;\n\t\t} else {\n\t\t\t// Create a new template part.\n\t\t\ttry {\n\t\t\t\tconst cleanSlug = cleanForSlug( slug );\n\t\t\t\tconst templatePart = await saveEntityRecord(\n\t\t\t\t\t'postType',\n\t\t\t\t\t'wp_template_part',\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: cleanSlug,\n\t\t\t\t\t\tstatus: 'publish',\n\t\t\t\t\t\tslug: cleanSlug,\n\t\t\t\t\t\tmeta: { theme },\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tnextAttributes.postId = templatePart.id;\n\t\t\t} catch ( err ) {\n\t\t\t\tsetHelp( __( 'Error adding template.' ) );\n\t\t\t}\n\t\t}\n\t\tsetAttributes( nextAttributes );\n\t}, [ postId, slug, theme ] );\n\treturn (\n\t\t<Placeholder\n\t\t\ticon={ layout }\n\t\t\tlabel={ __( 'Template Part' ) }\n\t\t\tinstructions={ __(\n\t\t\t\t'Choose a template part by slug and theme, or create a new one.'\n\t\t\t) }\n\t\t>\n\t\t\t<div className=\"wp-block-template-part__placeholder-input-container\">\n\t\t\t\t<TextControl\n\t\t\t\t\tlabel={ __( 'Slug' ) }\n\t\t\t\t\tplaceholder={ __( 'header' ) }\n\t\t\t\t\tvalue={ slug }\n\t\t\t\t\tonChange={ setSlug }\n\t\t\t\t\thelp={ help }\n\t\t\t\t\tclassName=\"wp-block-template-part__placeholder-input\"\n\t\t\t\t/>\n\t\t\t\t<TextControl\n\t\t\t\t\tlabel={ __( 'Theme' ) }\n\t\t\t\t\tplaceholder={ __( 'twentytwenty' ) }\n\t\t\t\t\tvalue={ theme }\n\t\t\t\t\tonChange={ setTheme }\n\t\t\t\t\tclassName=\"wp-block-template-part__placeholder-input\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{ preview }\n\t\t\t<Button\n\t\t\t\tisPrimary\n\t\t\t\tdisabled={ ! slug || ! theme }\n\t\t\t\tonClick={ onChooseOrCreate }\n\t\t\t>\n\t\t\t\t{ postId ? __( 'Choose' ) : __( 'Create' ) }\n\t\t\t</Button>\n\t\t</Placeholder>\n\t);\n}\n"]}