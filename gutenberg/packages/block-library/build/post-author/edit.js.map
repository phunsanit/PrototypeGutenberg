{"version":3,"sources":["@wordpress/block-library/src/post-author/edit.js"],"names":["DEFAULT_AVATAR_SIZE","PostAuthorEdit","isSelected","fontSize","setFontSize","context","attributes","setAttributes","postType","postId","select","getEditedEntityRecord","getUser","getAuthors","_authorId","author","authorId","authorDetails","authors","editEntityRecord","ref","name","property","className","contrastCheckers","backgroundColor","textColor","size","colorDetector","targetRef","colorPanelProps","initialOpen","TextColor","BackgroundColor","InspectorControlsColorPanel","ColorPanel","align","showAvatar","showBio","byline","avatarSizes","avatar_urls","url","push","value","label","avatarSize","blockClassNames","class","blockInlineStyles","undefined","map","id","nextAuthorId","Number","nextAlign","RichText","isEmpty","description"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { forEach } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport {\n\tAlignmentToolbar,\n\tBlockControls,\n\tFontSizePicker,\n\tInspectorControls,\n\tRichText,\n\t__experimentalUseColors,\n\tBlockColorsStyleSelector,\n\twithFontSizes,\n} from '@wordpress/block-editor';\nimport { PanelBody, SelectControl, ToggleControl } from '@wordpress/components';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { __ } from '@wordpress/i18n';\n\nconst DEFAULT_AVATAR_SIZE = 24;\n\nfunction PostAuthorEdit( {\n\tisSelected,\n\tfontSize,\n\tsetFontSize,\n\tcontext,\n\tattributes,\n\tsetAttributes,\n} ) {\n\tconst { postType, postId } = context;\n\n\tconst { authorId, authorDetails, authors } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEditedEntityRecord, getUser, getAuthors } = select(\n\t\t\t\t'core'\n\t\t\t);\n\t\t\tconst _authorId = getEditedEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\tpostType,\n\t\t\t\tpostId\n\t\t\t)?.author;\n\n\t\t\treturn {\n\t\t\t\tauthorId: _authorId,\n\t\t\t\tauthorDetails: _authorId ? getUser( _authorId ) : null,\n\t\t\t\tauthors: getAuthors(),\n\t\t\t};\n\t\t},\n\t\t[ postType, postId ]\n\t);\n\n\tconst { editEntityRecord } = useDispatch( 'core' );\n\n\tconst ref = useRef();\n\tconst {\n\t\tTextColor,\n\t\tBackgroundColor,\n\t\tInspectorControlsColorPanel,\n\t\tColorPanel,\n\t} = __experimentalUseColors(\n\t\t[\n\t\t\t{ name: 'textColor', property: 'color' },\n\t\t\t{ name: 'backgroundColor', className: 'background-color' },\n\t\t],\n\t\t{\n\t\t\tcontrastCheckers: [\n\t\t\t\t{\n\t\t\t\t\tbackgroundColor: true,\n\t\t\t\t\ttextColor: true,\n\t\t\t\t\tfontSize: fontSize.size,\n\t\t\t\t},\n\t\t\t],\n\t\t\tcolorDetector: { targetRef: ref },\n\t\t\tcolorPanelProps: {\n\t\t\t\tinitialOpen: true,\n\t\t\t},\n\t\t},\n\t\t[ fontSize.size ]\n\t);\n\n\tconst { align, showAvatar, showBio, byline } = attributes;\n\n\tconst avatarSizes = [];\n\tif ( authorDetails ) {\n\t\tforEach( authorDetails.avatar_urls, ( url, size ) => {\n\t\t\tavatarSizes.push( {\n\t\t\t\tvalue: size,\n\t\t\t\tlabel: `${ size } x ${ size }`,\n\t\t\t} );\n\t\t} );\n\t}\n\n\tlet avatarSize = DEFAULT_AVATAR_SIZE;\n\tif ( !! attributes.avatarSize ) {\n\t\tavatarSize = attributes.avatarSize;\n\t}\n\n\tconst blockClassNames = classnames( 'wp-block-post-author', {\n\t\t[ fontSize.class ]: fontSize.class,\n\t} );\n\tconst blockInlineStyles = {\n\t\tfontSize: fontSize.size ? fontSize.size + 'px' : undefined,\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Author Settings' ) }>\n\t\t\t\t\t<SelectControl\n\t\t\t\t\t\tlabel={ __( 'Author' ) }\n\t\t\t\t\t\tvalue={ authorId }\n\t\t\t\t\t\toptions={ authors.map( ( { id, name } ) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tvalue: id,\n\t\t\t\t\t\t\t\tlabel: name,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} ) }\n\t\t\t\t\t\tonChange={ ( nextAuthorId ) => {\n\t\t\t\t\t\t\teditEntityRecord( 'postType', postType, postId, {\n\t\t\t\t\t\t\t\tauthor: nextAuthorId,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show avatar' ) }\n\t\t\t\t\t\tchecked={ showAvatar }\n\t\t\t\t\t\tonChange={ () =>\n\t\t\t\t\t\t\tsetAttributes( { showAvatar: ! showAvatar } )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t\t{ showAvatar && (\n\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\tlabel={ __( 'Avatar size' ) }\n\t\t\t\t\t\t\tvalue={ attributes.avatarSize }\n\t\t\t\t\t\t\toptions={ avatarSizes }\n\t\t\t\t\t\t\tonChange={ ( size ) => {\n\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\tavatarSize: Number( size ),\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show bio' ) }\n\t\t\t\t\t\tchecked={ showBio }\n\t\t\t\t\t\tonChange={ () =>\n\t\t\t\t\t\t\tsetAttributes( { showBio: ! showBio } )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t\t<PanelBody title={ __( 'Text settings' ) }>\n\t\t\t\t\t<FontSizePicker\n\t\t\t\t\t\tvalue={ fontSize.size }\n\t\t\t\t\t\tonChange={ setFontSize }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\n\t\t\t{ InspectorControlsColorPanel }\n\n\t\t\t<BlockControls>\n\t\t\t\t<AlignmentToolbar\n\t\t\t\t\tvalue={ align }\n\t\t\t\t\tonChange={ ( nextAlign ) => {\n\t\t\t\t\t\tsetAttributes( { align: nextAlign } );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t\t<BlockColorsStyleSelector\n\t\t\t\t\tTextColor={ TextColor }\n\t\t\t\t\tBackgroundColor={ BackgroundColor }\n\t\t\t\t>\n\t\t\t\t\t{ ColorPanel }\n\t\t\t\t</BlockColorsStyleSelector>\n\t\t\t</BlockControls>\n\n\t\t\t<TextColor>\n\t\t\t\t<BackgroundColor>\n\t\t\t\t\t<div\n\t\t\t\t\t\tref={ ref }\n\t\t\t\t\t\tclassName={ classnames( blockClassNames, {\n\t\t\t\t\t\t\t[ `has-text-align-${ align }` ]: align,\n\t\t\t\t\t\t} ) }\n\t\t\t\t\t\tstyle={ blockInlineStyles }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ showAvatar && authorDetails && (\n\t\t\t\t\t\t\t<div className=\"wp-block-post-author__avatar\">\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\twidth={ avatarSize }\n\t\t\t\t\t\t\t\t\tsrc={\n\t\t\t\t\t\t\t\t\t\tauthorDetails.avatar_urls[ avatarSize ]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\talt={ authorDetails.name }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<div className=\"wp-block-post-author__content\">\n\t\t\t\t\t\t\t{ ( ! RichText.isEmpty( byline ) ||\n\t\t\t\t\t\t\t\tisSelected ) && (\n\t\t\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\t\t\tclassName=\"wp-block-post-author__byline\"\n\t\t\t\t\t\t\t\t\tmultiline={ false }\n\t\t\t\t\t\t\t\t\tplaceholder={ __( 'Write byline …' ) }\n\t\t\t\t\t\t\t\t\twithoutInteractiveFormatting\n\t\t\t\t\t\t\t\t\tallowedFormats={ [\n\t\t\t\t\t\t\t\t\t\t'core/bold',\n\t\t\t\t\t\t\t\t\t\t'core/italic',\n\t\t\t\t\t\t\t\t\t\t'core/strikethrough',\n\t\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t\t\tvalue={ byline }\n\t\t\t\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\t\t\t\tsetAttributes( { byline: value } )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<p className=\"wp-block-post-author__name\">\n\t\t\t\t\t\t\t\t{ authorDetails?.name }\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t{ showBio && (\n\t\t\t\t\t\t\t\t<p className={ 'wp-block-post-author__bio' }>\n\t\t\t\t\t\t\t\t\t{ authorDetails?.description }\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</BackgroundColor>\n\t\t\t</TextColor>\n\t\t</>\n\t);\n}\n\nexport default withFontSizes( 'fontSize' )( PostAuthorEdit );\n"]}