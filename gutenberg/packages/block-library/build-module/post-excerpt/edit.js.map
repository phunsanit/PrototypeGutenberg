{"version":3,"sources":["@wordpress/block-library/src/post-excerpt/edit.js"],"names":["useEntityProp","useEntityId","useMemo","InspectorControls","RichText","PanelBody","RangeControl","ToggleControl","__","usePostContentExcerpt","wordCount","rawPostContent","raw","excerptElement","document","createElement","innerHTML","excerpt","textContent","innerText","trim","split","join","PostExcerptEditor","attributes","moreText","showMoreOnNewLine","setAttributes","isSelected","setExcerpt","postContentExcerpt","newExcerptLength","newShowMoreOnNewLine","newMoreText","PostExcerptEdit"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useEntityProp, useEntityId } from '@wordpress/core-data';\nimport { useMemo } from '@wordpress/element';\nimport { InspectorControls, RichText } from '@wordpress/block-editor';\nimport { PanelBody, RangeControl, ToggleControl } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n\nfunction usePostContentExcerpt( wordCount ) {\n\tconst [ , , { raw: rawPostContent } ] = useEntityProp(\n\t\t'postType',\n\t\t'post',\n\t\t'content'\n\t);\n\treturn useMemo( () => {\n\t\tif ( ! rawPostContent ) {\n\t\t\treturn '';\n\t\t}\n\t\tconst excerptElement = document.createElement( 'div' );\n\t\texcerptElement.innerHTML = rawPostContent;\n\t\tconst excerpt =\n\t\t\texcerptElement.textContent || excerptElement.innerText || '';\n\t\treturn excerpt\n\t\t\t.trim()\n\t\t\t.split( ' ', wordCount )\n\t\t\t.join( ' ' );\n\t}, [ rawPostContent, wordCount ] );\n}\n\nfunction PostExcerptEditor( {\n\tattributes: { wordCount, moreText, showMoreOnNewLine },\n\tsetAttributes,\n\tisSelected,\n} ) {\n\tconst [ excerpt, setExcerpt ] = useEntityProp(\n\t\t'postType',\n\t\t'post',\n\t\t'excerpt'\n\t);\n\tconst postContentExcerpt = usePostContentExcerpt( wordCount );\n\treturn (\n\t\t<>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Post Excerpt Settings' ) }>\n\t\t\t\t\t{ ! excerpt && (\n\t\t\t\t\t\t<RangeControl\n\t\t\t\t\t\t\tlabel={ __( 'Max words' ) }\n\t\t\t\t\t\t\tvalue={ wordCount }\n\t\t\t\t\t\t\tonChange={ ( newExcerptLength ) =>\n\t\t\t\t\t\t\t\tsetAttributes( { wordCount: newExcerptLength } )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmin={ 10 }\n\t\t\t\t\t\t\tmax={ 100 }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show link on new line' ) }\n\t\t\t\t\t\tchecked={ showMoreOnNewLine }\n\t\t\t\t\t\tonChange={ ( newShowMoreOnNewLine ) =>\n\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\tshowMoreOnNewLine: newShowMoreOnNewLine,\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<RichText\n\t\t\t\tclassName={\n\t\t\t\t\t! showMoreOnNewLine &&\n\t\t\t\t\t'wp-block-post-excerpt__excerpt is-inline'\n\t\t\t\t}\n\t\t\t\tplaceholder={ postContentExcerpt }\n\t\t\t\tvalue={ excerpt || ( isSelected ? '' : postContentExcerpt ) }\n\t\t\t\tonChange={ setExcerpt }\n\t\t\t\tkeepPlaceholderOnFocus\n\t\t\t/>\n\t\t\t{ ! showMoreOnNewLine && ' ' }\n\t\t\t{ showMoreOnNewLine ? (\n\t\t\t\t<p>\n\t\t\t\t\t<RichText\n\t\t\t\t\t\ttagName=\"a\"\n\t\t\t\t\t\tplaceholder={ __( 'Read more…' ) }\n\t\t\t\t\t\tvalue={ moreText }\n\t\t\t\t\t\tonChange={ ( newMoreText ) =>\n\t\t\t\t\t\t\tsetAttributes( { moreText: newMoreText } )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</p>\n\t\t\t) : (\n\t\t\t\t<RichText\n\t\t\t\t\ttagName=\"a\"\n\t\t\t\t\tplaceholder={ __( 'Read more…' ) }\n\t\t\t\t\tvalue={ moreText }\n\t\t\t\t\tonChange={ ( newMoreText ) =>\n\t\t\t\t\t\tsetAttributes( { moreText: newMoreText } )\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t) }\n\t\t</>\n\t);\n}\n\nexport default function PostExcerptEdit( {\n\tattributes,\n\tsetAttributes,\n\tisSelected,\n} ) {\n\tif ( ! useEntityId( 'postType', 'post' ) ) {\n\t\treturn 'Post Excerpt Placeholder';\n\t}\n\treturn (\n\t\t<PostExcerptEditor\n\t\t\tattributes={ attributes }\n\t\t\tsetAttributes={ setAttributes }\n\t\t\tisSelected={ isSelected }\n\t\t/>\n\t);\n}\n"]}