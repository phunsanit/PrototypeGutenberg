{"version":3,"sources":["@wordpress/block-library/src/media-text/media-container.native.js"],"names":["View","ImageBackground","Text","TouchableWithoutFeedback","mediaUploadSync","requestImageFailedRetryDialog","requestImageUploadCancelDialog","Icon","Button","ToolbarGroup","withNotices","BlockControls","MEDIA_TYPE_IMAGE","MEDIA_TYPE_VIDEO","MediaPlaceholder","MediaUpload","MediaUploadProgress","VIDEO_ASPECT_RATIO","VideoPlayer","Component","__","isURL","getProtocol","compose","withPreferredColorScheme","replace","styles","icon","SvgIconRetry","ALLOWED_MEDIA_TYPES","imageFillStyles","MediaContainer","arguments","onUploadError","bind","updateMediaProgress","finishMediaUploadWithSuccess","finishMediaUploadWithFailure","mediaUploadStateReset","onSelectMediaUploadOption","onMediaPressed","state","isUploadInProgress","props","mediaId","mediaUrl","message","noticeOperations","removeAllNotices","createErrorNotice","params","id","url","type","onSelectMedia","media_type","isRetryIcon","isVideo","iconRetry","iconRetryVideo","iconStyle","getStylesFromColorScheme","iconDark","open","setState","payload","onMediaUpdate","mediaServerId","openMediaOptions","mediaAlt","isSelected","finalWidth","finalHeight","imageWidthWithinContainer","isUploadFailed","retryMessage","opacity","contentStyle","content","contentCentered","imageContainer","getIcon","width","height","uri","uploadFailed","modalIcon","uploadFailedText","showVideo","videoContainer","video","videoPlaceholder","uploadFailedTextVideo","mediaType","mediaElement","renderImage","renderVideo","title","onFocus","coverUrl","getMediaOptions","flex","renderToolbarEditButton","renderContent","renderPlaceholder"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tView,\n\tImageBackground,\n\tText,\n\tTouchableWithoutFeedback,\n} from 'react-native';\nimport {\n\tmediaUploadSync,\n\trequestImageFailedRetryDialog,\n\trequestImageUploadCancelDialog,\n} from 'react-native-gutenberg-bridge';\n\n/**\n * WordPress dependencies\n */\nimport { Icon, Button, ToolbarGroup, withNotices } from '@wordpress/components';\nimport {\n\tBlockControls,\n\tMEDIA_TYPE_IMAGE,\n\tMEDIA_TYPE_VIDEO,\n\tMediaPlaceholder,\n\tMediaUpload,\n\tMediaUploadProgress,\n\tVIDEO_ASPECT_RATIO,\n\tVideoPlayer,\n} from '@wordpress/block-editor';\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { isURL, getProtocol } from '@wordpress/url';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport { replace } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport icon from './media-container-icon';\nimport SvgIconRetry from './icon-retry';\n\n/**\n * Constants\n */\nconst ALLOWED_MEDIA_TYPES = [ MEDIA_TYPE_IMAGE, MEDIA_TYPE_VIDEO ];\n\nexport { imageFillStyles } from './media-container.js';\n\nclass MediaContainer extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.onUploadError = this.onUploadError.bind( this );\n\t\tthis.updateMediaProgress = this.updateMediaProgress.bind( this );\n\t\tthis.finishMediaUploadWithSuccess = this.finishMediaUploadWithSuccess.bind(\n\t\t\tthis\n\t\t);\n\t\tthis.finishMediaUploadWithFailure = this.finishMediaUploadWithFailure.bind(\n\t\t\tthis\n\t\t);\n\t\tthis.mediaUploadStateReset = this.mediaUploadStateReset.bind( this );\n\t\tthis.onSelectMediaUploadOption = this.onSelectMediaUploadOption.bind(\n\t\t\tthis\n\t\t);\n\t\tthis.onMediaPressed = this.onMediaPressed.bind( this );\n\n\t\tthis.state = {\n\t\t\tisUploadInProgress: false,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { mediaId, mediaUrl } = this.props;\n\n\t\t// Make sure we mark any temporary images as failed if they failed while\n\t\t// the editor wasn't open\n\t\tif ( mediaId && mediaUrl && getProtocol( mediaUrl ) === 'file:' ) {\n\t\t\tmediaUploadSync();\n\t\t}\n\t}\n\n\tonUploadError( message ) {\n\t\tconst { noticeOperations } = this.props;\n\t\tnoticeOperations.removeAllNotices();\n\t\tnoticeOperations.createErrorNotice( message );\n\t}\n\n\tonSelectMediaUploadOption( params ) {\n\t\tconst { id, url, type } = params;\n\t\tconst { onSelectMedia } = this.props;\n\n\t\tonSelectMedia( {\n\t\t\tmedia_type: type,\n\t\t\tid,\n\t\t\turl,\n\t\t} );\n\t}\n\n\tonMediaPressed() {\n\t\tconst { mediaId, mediaUrl } = this.props;\n\n\t\tif ( this.state.isUploadInProgress ) {\n\t\t\trequestImageUploadCancelDialog( mediaId );\n\t\t} else if ( mediaId && getProtocol( mediaUrl ) === 'file:' ) {\n\t\t\trequestImageFailedRetryDialog( mediaId );\n\t\t}\n\t}\n\n\tgetIcon( isRetryIcon, isVideo ) {\n\t\tif ( isRetryIcon ) {\n\t\t\treturn (\n\t\t\t\t<Icon\n\t\t\t\t\ticon={ SvgIconRetry }\n\t\t\t\t\t{ ...( styles.iconRetry,\n\t\t\t\t\tisVideo ? styles.iconRetryVideo : {} ) }\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\tconst iconStyle = this.props.getStylesFromColorScheme(\n\t\t\tstyles.icon,\n\t\t\tstyles.iconDark\n\t\t);\n\t\treturn <Icon icon={ icon } { ...iconStyle } />;\n\t}\n\n\trenderToolbarEditButton( open ) {\n\t\treturn (\n\t\t\t<BlockControls>\n\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"components-toolbar__control\"\n\t\t\t\t\t\tlabel={ __( 'Edit media' ) }\n\t\t\t\t\t\ticon={ replace }\n\t\t\t\t\t\tonClick={ open }\n\t\t\t\t\t/>\n\t\t\t\t</ToolbarGroup>\n\t\t\t</BlockControls>\n\t\t);\n\t}\n\n\tupdateMediaProgress() {\n\t\tif ( ! this.state.isUploadInProgress ) {\n\t\t\tthis.setState( { isUploadInProgress: true } );\n\t\t}\n\t}\n\n\tfinishMediaUploadWithSuccess( payload ) {\n\t\tconst { onMediaUpdate } = this.props;\n\n\t\tonMediaUpdate( {\n\t\t\tid: payload.mediaServerId,\n\t\t\turl: payload.mediaUrl,\n\t\t} );\n\t\tthis.setState( { isUploadInProgress: false } );\n\t}\n\n\tfinishMediaUploadWithFailure() {\n\t\tthis.setState( { isUploadInProgress: false } );\n\t}\n\n\tmediaUploadStateReset() {\n\t\tconst { onMediaUpdate } = this.props;\n\n\t\tonMediaUpdate( { id: null, url: null } );\n\t\tthis.setState( { isUploadInProgress: false } );\n\t}\n\n\trenderImage( params, openMediaOptions ) {\n\t\tconst { isUploadInProgress } = this.state;\n\t\tconst { mediaAlt, mediaUrl, isSelected } = this.props;\n\t\tconst {\n\t\t\tfinalWidth,\n\t\t\tfinalHeight,\n\t\t\timageWidthWithinContainer,\n\t\t\tisUploadFailed,\n\t\t\tretryMessage,\n\t\t} = params;\n\t\tconst opacity = isUploadInProgress ? 0.3 : 1;\n\n\t\tconst contentStyle = ! imageWidthWithinContainer\n\t\t\t? styles.content\n\t\t\t: styles.contentCentered;\n\n\t\treturn (\n\t\t\t<TouchableWithoutFeedback\n\t\t\t\taccessible={ ! isSelected }\n\t\t\t\tonPress={ this.onMediaPressed }\n\t\t\t\tonLongPress={ openMediaOptions }\n\t\t\t\tdisabled={ ! isSelected }\n\t\t\t>\n\t\t\t\t<View style={ contentStyle }>\n\t\t\t\t\t{ ! imageWidthWithinContainer && (\n\t\t\t\t\t\t<View style={ styles.imageContainer }>\n\t\t\t\t\t\t\t{ this.getIcon( false ) }\n\t\t\t\t\t\t</View>\n\t\t\t\t\t) }\n\t\t\t\t\t<ImageBackground\n\t\t\t\t\t\taccessible={ true }\n\t\t\t\t\t\taccessibilityLabel={ mediaAlt }\n\t\t\t\t\t\taccessibilityHint={ __(\n\t\t\t\t\t\t\t'Double tap and hold to edit'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\taccessibilityRole={ 'imagebutton' }\n\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\twidth: finalWidth,\n\t\t\t\t\t\t\theight: finalHeight,\n\t\t\t\t\t\t\topacity,\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tresizeMethod=\"scale\"\n\t\t\t\t\t\tsource={ { uri: mediaUrl } }\n\t\t\t\t\t\tkey={ mediaUrl }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ isUploadFailed && (\n\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\t\t\tstyles.imageContainer,\n\t\t\t\t\t\t\t\t\tstyles.uploadFailed,\n\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<View style={ styles.modalIcon }>\n\t\t\t\t\t\t\t\t\t{ this.getIcon( isUploadFailed ) }\n\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t\t<Text style={ styles.uploadFailedText }>\n\t\t\t\t\t\t\t\t\t{ retryMessage }\n\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</ImageBackground>\n\t\t\t\t</View>\n\t\t\t</TouchableWithoutFeedback>\n\t\t);\n\t}\n\n\trenderVideo( params, openMediaOptions ) {\n\t\tconst { mediaUrl, isSelected } = this.props;\n\t\tconst { isUploadInProgress } = this.state;\n\t\tconst { isUploadFailed, retryMessage } = params;\n\t\tconst showVideo =\n\t\t\tisURL( mediaUrl ) && ! isUploadInProgress && ! isUploadFailed;\n\n\t\treturn (\n\t\t\t<TouchableWithoutFeedback\n\t\t\t\taccessible={ ! isSelected }\n\t\t\t\tonPress={ this.onMediaPressed }\n\t\t\t\tonLongPress={ openMediaOptions }\n\t\t\t\tdisabled={ ! isSelected }\n\t\t\t>\n\t\t\t\t<View aspectRatio={ VIDEO_ASPECT_RATIO }>\n\t\t\t\t\t{ showVideo && (\n\t\t\t\t\t\t<View style={ styles.videoContainer }>\n\t\t\t\t\t\t\t<VideoPlayer\n\t\t\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\t\t\tstyle={ styles.video }\n\t\t\t\t\t\t\t\tsource={ { uri: mediaUrl } }\n\t\t\t\t\t\t\t\tpaused={ true }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t) }\n\t\t\t\t\t{ ! showVideo && (\n\t\t\t\t\t\t<View style={ styles.videoPlaceholder }>\n\t\t\t\t\t\t\t<View style={ styles.modalIcon }>\n\t\t\t\t\t\t\t\t{ isUploadFailed\n\t\t\t\t\t\t\t\t\t? this.getIcon( isUploadFailed )\n\t\t\t\t\t\t\t\t\t: this.getIcon( false ) }\n\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t{ isUploadFailed && (\n\t\t\t\t\t\t\t\t<Text\n\t\t\t\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\t\t\t\tstyles.uploadFailedText,\n\t\t\t\t\t\t\t\t\t\tstyles.uploadFailedTextVideo,\n\t\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ retryMessage }\n\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</View>\n\t\t\t\t\t) }\n\t\t\t\t</View>\n\t\t\t</TouchableWithoutFeedback>\n\t\t);\n\t}\n\n\trenderContent( params, openMediaOptions ) {\n\t\tconst { mediaType } = this.props;\n\t\tlet mediaElement = null;\n\n\t\tswitch ( mediaType ) {\n\t\t\tcase MEDIA_TYPE_IMAGE:\n\t\t\t\tmediaElement = this.renderImage( params, openMediaOptions );\n\t\t\t\tbreak;\n\t\t\tcase MEDIA_TYPE_VIDEO:\n\t\t\t\tmediaElement = this.renderVideo( params, openMediaOptions );\n\t\t\t\tbreak;\n\t\t}\n\t\treturn mediaElement;\n\t}\n\n\trenderPlaceholder() {\n\t\treturn (\n\t\t\t<MediaPlaceholder\n\t\t\t\ticon={ this.getIcon( false ) }\n\t\t\t\tlabels={ {\n\t\t\t\t\ttitle: __( 'Media area' ),\n\t\t\t\t} }\n\t\t\t\tonSelect={ this.onSelectMediaUploadOption }\n\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\tonFocus={ this.props.onFocus }\n\t\t\t\tonError={ this.onUploadError }\n\t\t\t/>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst { mediaUrl, mediaId, mediaType } = this.props;\n\t\tconst coverUrl = mediaType === MEDIA_TYPE_IMAGE ? mediaUrl : null;\n\n\t\tif ( mediaUrl ) {\n\t\t\treturn (\n\t\t\t\t<View>\n\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\tonSelect={ this.onSelectMediaUploadOption }\n\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\tvalue={ mediaId }\n\t\t\t\t\t\trender={ ( { open, getMediaOptions } ) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<View style={ { flex: 1 } }>\n\t\t\t\t\t\t\t\t\t{ getMediaOptions() }\n\t\t\t\t\t\t\t\t\t{ this.renderToolbarEditButton( open ) }\n\n\t\t\t\t\t\t\t\t\t<MediaUploadProgress\n\t\t\t\t\t\t\t\t\t\tcoverUrl={ coverUrl }\n\t\t\t\t\t\t\t\t\t\tmediaId={ mediaId }\n\t\t\t\t\t\t\t\t\t\tonUpdateMediaProgress={\n\t\t\t\t\t\t\t\t\t\t\tthis.updateMediaProgress\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonFinishMediaUploadWithSuccess={\n\t\t\t\t\t\t\t\t\t\t\tthis.finishMediaUploadWithSuccess\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonFinishMediaUploadWithFailure={\n\t\t\t\t\t\t\t\t\t\t\tthis.finishMediaUploadWithFailure\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonMediaUploadStateReset={\n\t\t\t\t\t\t\t\t\t\t\tthis.mediaUploadStateReset\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\trenderContent={ ( params ) => {\n\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t<View style={ styles.content }>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ this.renderContent(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tparams,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\topen\n\t\t\t\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t);\n\t\t}\n\t\treturn this.renderPlaceholder();\n\t}\n}\n\nexport default compose(\n\twithNotices,\n\twithPreferredColorScheme\n)( MediaContainer );\n"]}