{"version":3,"sources":["@wordpress/block-library/src/image/image-size.js"],"names":["useState","useEffect","calculatePreferedImageSize","useImageSize","ref","src","dependencies","imageWidth","imageHeight","imageWidthWithinContainer","imageHeightWithinContainer","state","setState","defaultView","current","ownerDocument","image","Image","calculateSize","width","height","addEventListener","removeEventListener"],"mappings":";;;AAAA;;;AAGA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,oBAApC;AAEA;;;;AAGA,SAASC,0BAAT,QAA2C,SAA3C;AAEA,eAAe,SAASC,YAAT,CAAuBC,GAAvB,EAA4BC,GAA5B,EAAiCC,YAAjC,EAAgD;AAAA,kBAClCN,QAAQ,CAAE;AACrCO,IAAAA,UAAU,EAAE,IADyB;AAErCC,IAAAA,WAAW,EAAE,IAFwB;AAGrCC,IAAAA,yBAAyB,EAAE,IAHU;AAIrCC,IAAAA,0BAA0B,EAAE;AAJS,GAAF,CAD0B;AAAA;AAAA,MACtDC,KADsD;AAAA,MAC/CC,QAD+C;;AAQ9DX,EAAAA,SAAS,CAAE,YAAM;AAChB,QAAK,CAAEI,GAAP,EAAa;AACZ;AACA;;AAHe,QAKRQ,WALQ,GAKQT,GAAG,CAACU,OAAJ,CAAYC,aALpB,CAKRF,WALQ;AAMhB,QAAMG,KAAK,GAAG,IAAIH,WAAW,CAACI,KAAhB,EAAd;;AAEA,aAASC,aAAT,GAAyB;AAAA,kCACEhB,0BAA0B,CACnDc,KADmD,EAEnDZ,GAAG,CAACU,OAF+C,CAD5B;AAAA,UAChBK,KADgB,yBAChBA,KADgB;AAAA,UACTC,MADS,yBACTA,MADS;;AAMxBR,MAAAA,QAAQ,CAAE;AACTL,QAAAA,UAAU,EAAES,KAAK,CAACG,KADT;AAETX,QAAAA,WAAW,EAAEQ,KAAK,CAACI,MAFV;AAGTX,QAAAA,yBAAyB,EAAEU,KAHlB;AAITT,QAAAA,0BAA0B,EAAEU;AAJnB,OAAF,CAAR;AAMA;;AAEDP,IAAAA,WAAW,CAACQ,gBAAZ,CAA8B,QAA9B,EAAwCH,aAAxC;AACAF,IAAAA,KAAK,CAACK,gBAAN,CAAwB,MAAxB,EAAgCH,aAAhC;AACAF,IAAAA,KAAK,CAACX,GAAN,GAAYA,GAAZ;AAEA,WAAO,YAAM;AACZQ,MAAAA,WAAW,CAACS,mBAAZ,CAAiC,QAAjC,EAA2CJ,aAA3C;AACAF,MAAAA,KAAK,CAACM,mBAAN,CAA2B,MAA3B,EAAmCJ,aAAnC;AACA,KAHD;AAIA,GA9BQ,GA8BJb,GA9BI,4BA8BIC,YA9BJ,GAAT;AAgCA,SAAOK,KAAP;AACA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState, useEffect } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { calculatePreferedImageSize } from './utils';\n\nexport default function useImageSize( ref, src, dependencies ) {\n\tconst [ state, setState ] = useState( {\n\t\timageWidth: null,\n\t\timageHeight: null,\n\t\timageWidthWithinContainer: null,\n\t\timageHeightWithinContainer: null,\n\t} );\n\n\tuseEffect( () => {\n\t\tif ( ! src ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { defaultView } = ref.current.ownerDocument;\n\t\tconst image = new defaultView.Image();\n\n\t\tfunction calculateSize() {\n\t\t\tconst { width, height } = calculatePreferedImageSize(\n\t\t\t\timage,\n\t\t\t\tref.current\n\t\t\t);\n\n\t\t\tsetState( {\n\t\t\t\timageWidth: image.width,\n\t\t\t\timageHeight: image.height,\n\t\t\t\timageWidthWithinContainer: width,\n\t\t\t\timageHeightWithinContainer: height,\n\t\t\t} );\n\t\t}\n\n\t\tdefaultView.addEventListener( 'resize', calculateSize );\n\t\timage.addEventListener( 'load', calculateSize );\n\t\timage.src = src;\n\n\t\treturn () => {\n\t\t\tdefaultView.removeEventListener( 'resize', calculateSize );\n\t\t\timage.removeEventListener( 'load', calculateSize );\n\t\t};\n\t}, [ src, ...dependencies ] );\n\n\treturn state;\n}\n"]}