{"version":3,"sources":["@wordpress/block-library/src/embed/settings.js"],"names":["getEmbedEditComponent","classnames","__","compose","RichText","withSelect","withDispatch","embedAttributes","url","type","caption","source","selector","providerNameSlug","allowResponsive","default","getEmbedBlockSettings","title","description","icon","category","transforms","keywords","supports","responsive","blockDescription","edit","attributes","align","select","ownProps","core","getEmbedPreview","isPreviewEmbedFallback","isRequestingEmbedPreview","getThemeSupports","preview","undefined","previewIsFallback","fetching","themeSupports","badEmbedProvider","html","wordpressCantEmbed","data","status","validPreview","cannotEmbed","themeSupportsResponsive","dispatch","coreData","tryAgain","invalidateResolution","save","embedClassName","isEmpty","deprecated"],"mappings":"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","sourcesContent":["/**\n * Internal dependencies\n */\nimport { getEmbedEditComponent } from './edit';\n\n/**\n * External dependencies\n */\nimport classnames from 'classnames/dedupe';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { compose } from '@wordpress/compose';\nimport { RichText } from '@wordpress/block-editor';\nimport { withSelect, withDispatch } from '@wordpress/data';\n\nconst embedAttributes = {\n\turl: {\n\t\ttype: 'string',\n\t},\n\tcaption: {\n\t\ttype: 'string',\n\t\tsource: 'html',\n\t\tselector: 'figcaption',\n\t},\n\ttype: {\n\t\ttype: 'string',\n\t},\n\tproviderNameSlug: {\n\t\ttype: 'string',\n\t},\n\tallowResponsive: {\n\t\ttype: 'boolean',\n\t\tdefault: true,\n\t},\n};\n\nexport function getEmbedBlockSettings( {\n\ttitle,\n\tdescription,\n\ticon,\n\tcategory = 'embed',\n\ttransforms,\n\tkeywords = [],\n\tsupports = {},\n\tresponsive = true,\n} ) {\n\tconst blockDescription =\n\t\tdescription ||\n\t\t__(\n\t\t\t'Add a block that displays content pulled from other sites, like Twitter, Instagram or YouTube.'\n\t\t);\n\tconst edit = getEmbedEditComponent( title, icon, responsive );\n\treturn {\n\t\ttitle,\n\t\tdescription: blockDescription,\n\t\ticon,\n\t\tcategory,\n\t\tkeywords,\n\t\tattributes: embedAttributes,\n\n\t\tsupports: {\n\t\t\talign: true,\n\t\t\t...supports,\n\t\t},\n\n\t\ttransforms,\n\n\t\tedit: compose(\n\t\t\twithSelect( ( select, ownProps ) => {\n\t\t\t\tconst { url } = ownProps.attributes;\n\t\t\t\tconst core = select( 'core' );\n\t\t\t\tconst {\n\t\t\t\t\tgetEmbedPreview,\n\t\t\t\t\tisPreviewEmbedFallback,\n\t\t\t\t\tisRequestingEmbedPreview,\n\t\t\t\t\tgetThemeSupports,\n\t\t\t\t} = core;\n\t\t\t\tconst preview = undefined !== url && getEmbedPreview( url );\n\t\t\t\tconst previewIsFallback =\n\t\t\t\t\tundefined !== url && isPreviewEmbedFallback( url );\n\t\t\t\tconst fetching =\n\t\t\t\t\tundefined !== url && isRequestingEmbedPreview( url );\n\t\t\t\tconst themeSupports = getThemeSupports();\n\t\t\t\t// The external oEmbed provider does not exist. We got no type info and no html.\n\t\t\t\tconst badEmbedProvider =\n\t\t\t\t\t!! preview &&\n\t\t\t\t\tundefined === preview.type &&\n\t\t\t\t\tfalse === preview.html;\n\t\t\t\t// Some WordPress URLs that can't be embedded will cause the API to return\n\t\t\t\t// a valid JSON response with no HTML and `data.status` set to 404, rather\n\t\t\t\t// than generating a fallback response as other embeds do.\n\t\t\t\tconst wordpressCantEmbed =\n\t\t\t\t\t!! preview && preview.data && preview.data.status === 404;\n\t\t\t\tconst validPreview =\n\t\t\t\t\t!! preview && ! badEmbedProvider && ! wordpressCantEmbed;\n\t\t\t\tconst cannotEmbed =\n\t\t\t\t\tundefined !== url &&\n\t\t\t\t\t( ! validPreview || previewIsFallback );\n\t\t\t\treturn {\n\t\t\t\t\tpreview: validPreview ? preview : undefined,\n\t\t\t\t\tfetching,\n\t\t\t\t\tthemeSupportsResponsive:\n\t\t\t\t\t\tthemeSupports[ 'responsive-embeds' ],\n\t\t\t\t\tcannotEmbed,\n\t\t\t\t};\n\t\t\t} ),\n\t\t\twithDispatch( ( dispatch, ownProps ) => {\n\t\t\t\tconst { url } = ownProps.attributes;\n\t\t\t\tconst coreData = dispatch( 'core/data' );\n\t\t\t\tconst tryAgain = () => {\n\t\t\t\t\tcoreData.invalidateResolution( 'core', 'getEmbedPreview', [\n\t\t\t\t\t\turl,\n\t\t\t\t\t] );\n\t\t\t\t};\n\t\t\t\treturn {\n\t\t\t\t\ttryAgain,\n\t\t\t\t};\n\t\t\t} )\n\t\t)( edit ),\n\n\t\tsave( { attributes } ) {\n\t\t\tconst { url, caption, type, providerNameSlug } = attributes;\n\n\t\t\tif ( ! url ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst embedClassName = classnames( 'wp-block-embed', {\n\t\t\t\t[ `is-type-${ type }` ]: type,\n\t\t\t\t[ `is-provider-${ providerNameSlug }` ]: providerNameSlug,\n\t\t\t} );\n\n\t\t\treturn (\n\t\t\t\t<figure className={ embedClassName }>\n\t\t\t\t\t<div className=\"wp-block-embed__wrapper\">\n\t\t\t\t\t\t{ `\\n${ url }\\n` /* URL needs to be on its own line. */ }\n\t\t\t\t\t</div>\n\t\t\t\t\t{ ! RichText.isEmpty( caption ) && (\n\t\t\t\t\t\t<RichText.Content\n\t\t\t\t\t\t\ttagName=\"figcaption\"\n\t\t\t\t\t\t\tvalue={ caption }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</figure>\n\t\t\t);\n\t\t},\n\n\t\tdeprecated: [\n\t\t\t{\n\t\t\t\tattributes: embedAttributes,\n\t\t\t\tsave( { attributes } ) {\n\t\t\t\t\tconst { url, caption, type, providerNameSlug } = attributes;\n\n\t\t\t\t\tif ( ! url ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst embedClassName = classnames( 'wp-block-embed', {\n\t\t\t\t\t\t[ `is-type-${ type }` ]: type,\n\t\t\t\t\t\t[ `is-provider-${ providerNameSlug }` ]: providerNameSlug,\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<figure className={ embedClassName }>\n\t\t\t\t\t\t\t{ `\\n${ url }\\n` /* URL needs to be on its own line. */ }\n\t\t\t\t\t\t\t{ ! RichText.isEmpty( caption ) && (\n\t\t\t\t\t\t\t\t<RichText.Content\n\t\t\t\t\t\t\t\t\ttagName=\"figcaption\"\n\t\t\t\t\t\t\t\t\tvalue={ caption }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</figure>\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t};\n}\n"]}