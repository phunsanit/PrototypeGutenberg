{"version":3,"sources":["@wordpress/block-library/src/button/edit.js"],"names":["classnames","__","useCallback","useState","KeyboardShortcuts","PanelBody","RangeControl","TextControl","ToggleControl","ToolbarButton","ToolbarGroup","Popover","BlockControls","InspectorControls","RichText","__experimentalBlock","Block","__experimentalLinkControl","LinkControl","rawShortcut","displayShortcut","link","createBlock","ColorEdit","getColorAndStyleProps","NEW_TAB_REL","MIN_BORDER_RADIUS_VALUE","MAX_BORDER_RADIUS_VALUE","INITIAL_BORDER_RADIUS_POSITION","BorderPanel","borderRadius","setAttributes","setBorderRadius","newBorderRadius","URLPicker","isSelected","url","opensInNewTab","onToggleOpenInNewTab","isURLPickerOpen","setIsURLPickerOpen","openLinkControl","linkControl","newURL","newOpensInNewTab","primary","ButtonEdit","props","attributes","className","onReplace","mergeBlocks","linkTarget","placeholder","rel","text","onSetLinkRel","value","newLinkTarget","undefined","updatedRel","colorProps","style"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { useCallback, useState } from '@wordpress/element';\nimport {\n\tKeyboardShortcuts,\n\tPanelBody,\n\tRangeControl,\n\tTextControl,\n\tToggleControl,\n\tToolbarButton,\n\tToolbarGroup,\n\tPopover,\n} from '@wordpress/components';\nimport {\n\tBlockControls,\n\tInspectorControls,\n\tRichText,\n\t__experimentalBlock as Block,\n\t__experimentalLinkControl as LinkControl,\n} from '@wordpress/block-editor';\nimport { rawShortcut, displayShortcut } from '@wordpress/keycodes';\nimport { link } from '@wordpress/icons';\nimport { createBlock } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport ColorEdit from './color-edit';\nimport getColorAndStyleProps from './color-props';\n\nconst NEW_TAB_REL = 'noreferrer noopener';\nconst MIN_BORDER_RADIUS_VALUE = 0;\nconst MAX_BORDER_RADIUS_VALUE = 50;\nconst INITIAL_BORDER_RADIUS_POSITION = 5;\n\nfunction BorderPanel( { borderRadius = '', setAttributes } ) {\n\tconst setBorderRadius = useCallback(\n\t\t( newBorderRadius ) => {\n\t\t\tsetAttributes( { borderRadius: newBorderRadius } );\n\t\t},\n\t\t[ setAttributes ]\n\t);\n\treturn (\n\t\t<PanelBody title={ __( 'Border settings' ) }>\n\t\t\t<RangeControl\n\t\t\t\tvalue={ borderRadius }\n\t\t\t\tlabel={ __( 'Border radius' ) }\n\t\t\t\tmin={ MIN_BORDER_RADIUS_VALUE }\n\t\t\t\tmax={ MAX_BORDER_RADIUS_VALUE }\n\t\t\t\tinitialPosition={ INITIAL_BORDER_RADIUS_POSITION }\n\t\t\t\tallowReset\n\t\t\t\tonChange={ setBorderRadius }\n\t\t\t/>\n\t\t</PanelBody>\n\t);\n}\n\nfunction URLPicker( {\n\tisSelected,\n\turl,\n\tsetAttributes,\n\topensInNewTab,\n\tonToggleOpenInNewTab,\n} ) {\n\tconst [ isURLPickerOpen, setIsURLPickerOpen ] = useState( false );\n\tconst openLinkControl = () => {\n\t\tsetIsURLPickerOpen( true );\n\n\t\t// prevents default behaviour for event\n\t\treturn false;\n\t};\n\tconst linkControl = isURLPickerOpen && (\n\t\t<Popover\n\t\t\tposition=\"bottom center\"\n\t\t\tonClose={ () => setIsURLPickerOpen( false ) }\n\t\t>\n\t\t\t<LinkControl\n\t\t\t\tclassName=\"wp-block-navigation-link__inline-link-input\"\n\t\t\t\tvalue={ { url, opensInNewTab } }\n\t\t\t\tonChange={ ( {\n\t\t\t\t\turl: newURL = '',\n\t\t\t\t\topensInNewTab: newOpensInNewTab,\n\t\t\t\t} ) => {\n\t\t\t\t\tsetAttributes( { url: newURL } );\n\n\t\t\t\t\tif ( opensInNewTab !== newOpensInNewTab ) {\n\t\t\t\t\t\tonToggleOpenInNewTab( newOpensInNewTab );\n\t\t\t\t\t}\n\t\t\t\t} }\n\t\t\t/>\n\t\t</Popover>\n\t);\n\treturn (\n\t\t<>\n\t\t\t<BlockControls>\n\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\tname=\"link\"\n\t\t\t\t\t\ticon={ link }\n\t\t\t\t\t\ttitle={ __( 'Link' ) }\n\t\t\t\t\t\tshortcut={ displayShortcut.primary( 'k' ) }\n\t\t\t\t\t\tonClick={ openLinkControl }\n\t\t\t\t\t/>\n\t\t\t\t</ToolbarGroup>\n\t\t\t</BlockControls>\n\t\t\t{ isSelected && (\n\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\tbindGlobal\n\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t[ rawShortcut.primary( 'k' ) ]: openLinkControl,\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t{ linkControl }\n\t\t</>\n\t);\n}\n\nfunction ButtonEdit( props ) {\n\tconst {\n\t\tattributes,\n\t\tsetAttributes,\n\t\tclassName,\n\t\tisSelected,\n\t\tonReplace,\n\t\tmergeBlocks,\n\t} = props;\n\tconst {\n\t\tborderRadius,\n\t\tlinkTarget,\n\t\tplaceholder,\n\t\trel,\n\t\ttext,\n\t\turl,\n\t} = attributes;\n\tconst onSetLinkRel = useCallback(\n\t\t( value ) => {\n\t\t\tsetAttributes( { rel: value } );\n\t\t},\n\t\t[ setAttributes ]\n\t);\n\n\tconst onToggleOpenInNewTab = useCallback(\n\t\t( value ) => {\n\t\t\tconst newLinkTarget = value ? '_blank' : undefined;\n\n\t\t\tlet updatedRel = rel;\n\t\t\tif ( newLinkTarget && ! rel ) {\n\t\t\t\tupdatedRel = NEW_TAB_REL;\n\t\t\t} else if ( ! newLinkTarget && rel === NEW_TAB_REL ) {\n\t\t\t\tupdatedRel = undefined;\n\t\t\t}\n\n\t\t\tsetAttributes( {\n\t\t\t\tlinkTarget: newLinkTarget,\n\t\t\t\trel: updatedRel,\n\t\t\t} );\n\t\t},\n\t\t[ rel, setAttributes ]\n\t);\n\n\tconst colorProps = getColorAndStyleProps( attributes );\n\n\treturn (\n\t\t<>\n\t\t\t<ColorEdit { ...props } />\n\t\t\t<Block.div>\n\t\t\t\t<RichText\n\t\t\t\t\tplaceholder={ placeholder || __( 'Add text…' ) }\n\t\t\t\t\tvalue={ text }\n\t\t\t\t\tonChange={ ( value ) => setAttributes( { text: value } ) }\n\t\t\t\t\twithoutInteractiveFormatting\n\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\tclassName,\n\t\t\t\t\t\t'wp-block-button__link',\n\t\t\t\t\t\tcolorProps.className,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'no-border-radius': borderRadius === 0,\n\t\t\t\t\t\t}\n\t\t\t\t\t) }\n\t\t\t\t\tstyle={ {\n\t\t\t\t\t\tborderRadius: borderRadius\n\t\t\t\t\t\t\t? borderRadius + 'px'\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t...colorProps.style,\n\t\t\t\t\t} }\n\t\t\t\t\tonSplit={ ( value ) =>\n\t\t\t\t\t\tcreateBlock( 'core/button', {\n\t\t\t\t\t\t\t...attributes,\n\t\t\t\t\t\t\ttext: value,\n\t\t\t\t\t\t} )\n\t\t\t\t\t}\n\t\t\t\t\tonReplace={ onReplace }\n\t\t\t\t\tonMerge={ mergeBlocks }\n\t\t\t\t\tidentifier=\"text\"\n\t\t\t\t/>\n\t\t\t</Block.div>\n\t\t\t<URLPicker\n\t\t\t\turl={ url }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\tisSelected={ isSelected }\n\t\t\t\topensInNewTab={ linkTarget === '_blank' }\n\t\t\t\tonToggleOpenInNewTab={ onToggleOpenInNewTab }\n\t\t\t/>\n\t\t\t<InspectorControls>\n\t\t\t\t<BorderPanel\n\t\t\t\t\tborderRadius={ borderRadius }\n\t\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\t/>\n\t\t\t\t<PanelBody title={ __( 'Link settings' ) }>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Open in new tab' ) }\n\t\t\t\t\t\tonChange={ onToggleOpenInNewTab }\n\t\t\t\t\t\tchecked={ linkTarget === '_blank' }\n\t\t\t\t\t/>\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={ __( 'Link rel' ) }\n\t\t\t\t\t\tvalue={ rel || '' }\n\t\t\t\t\t\tonChange={ onSetLinkRel }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t</>\n\t);\n}\n\nexport default ButtonEdit;\n"]}