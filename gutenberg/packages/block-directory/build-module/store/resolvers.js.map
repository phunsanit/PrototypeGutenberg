{"version":3,"sources":["@wordpress/block-directory/src/store/resolvers.js"],"names":["camelCase","mapKeys","apiFetch","fetchDownloadableBlocks","receiveDownloadableBlocks","setInstallBlocksPermission","getDownloadableBlocks","filterValue","path","results","blocks","map","result","value","key","code","hasInstallBlocksPermission"],"mappings":";;AAAA;;;AAGA,SAASA,SAAT,EAAoBC,OAApB,QAAmC,QAAnC;AAEA;;;;AAGA,SAASC,QAAT,QAAyB,0BAAzB;AAEA;;;;AAGA,SACCC,uBADD,EAECC,yBAFD,EAGCC,0BAHD,QAIO,WAJP;AAMA,eAAe;AACbC,EAAAA,qBADa,uEACUC,WADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAENA,WAFM;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAOZ,mBAAMJ,uBAAuB,CAAEI,WAAF,CAA7B;;AAPY;AAAA;AAQI,mBAAML,QAAQ,CAAE;AAC/BM,cAAAA,IAAI,uDAAiDD,WAAjD;AAD2B,aAAF,CAAd;;AARJ;AAQNE,YAAAA,OARM;AAWNC,YAAAA,MAXM,GAWGD,OAAO,CAACE,GAAR,CAAa,UAAEC,MAAF;AAAA,qBAC3BX,OAAO,CAAEW,MAAF,EAAU,UAAEC,KAAF,EAASC,GAAT,EAAkB;AAClC,uBAAOd,SAAS,CAAEc,GAAF,CAAhB;AACA,eAFM,CADoB;AAAA,aAAb,CAXH;AAAA;AAiBZ,mBAAMV,yBAAyB,CAAEM,MAAF,EAAUH,WAAV,CAA/B;;AAjBY;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA,kBAmBP,YAAMQ,IAAN,KAAe,uBAnBR;AAAA;AAAA;AAAA;;AAAA;AAoBX,mBAAMV,0BAA0B,CAAE,KAAF,CAAhC;;AApBW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAwBbW,EAAAA,0BAxBa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0BZ,mBAAMd,QAAQ,CAAE;AACfM,cAAAA,IAAI;AADW,aAAF,CAAd;;AA1BY;AAAA;AA6BZ,mBAAMH,0BAA0B,CAAE,IAAF,CAAhC;;AA7BY;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA,kBA+BP,aAAMU,IAAN,KAAe,uBA/BR;AAAA;AAAA;AAAA;;AAAA;AAgCX,mBAAMV,0BAA0B,CAAE,KAAF,CAAhC;;AAhCW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { camelCase, mapKeys } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { apiFetch } from '@wordpress/data-controls';\n\n/**\n * Internal dependencies\n */\nimport {\n\tfetchDownloadableBlocks,\n\treceiveDownloadableBlocks,\n\tsetInstallBlocksPermission,\n} from './actions';\n\nexport default {\n\t*getDownloadableBlocks( filterValue ) {\n\t\tif ( ! filterValue ) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tyield fetchDownloadableBlocks( filterValue );\n\t\t\tconst results = yield apiFetch( {\n\t\t\t\tpath: `__experimental/block-directory/search?term=${ filterValue }`,\n\t\t\t} );\n\t\t\tconst blocks = results.map( ( result ) =>\n\t\t\t\tmapKeys( result, ( value, key ) => {\n\t\t\t\t\treturn camelCase( key );\n\t\t\t\t} )\n\t\t\t);\n\n\t\t\tyield receiveDownloadableBlocks( blocks, filterValue );\n\t\t} catch ( error ) {\n\t\t\tif ( error.code === 'rest_user_cannot_view' ) {\n\t\t\t\tyield setInstallBlocksPermission( false );\n\t\t\t}\n\t\t}\n\t},\n\t*hasInstallBlocksPermission() {\n\t\ttry {\n\t\t\tyield apiFetch( {\n\t\t\t\tpath: `__experimental/block-directory/search?term=`,\n\t\t\t} );\n\t\t\tyield setInstallBlocksPermission( true );\n\t\t} catch ( error ) {\n\t\t\tif ( error.code === 'rest_user_cannot_view' ) {\n\t\t\t\tyield setInstallBlocksPermission( false );\n\t\t\t}\n\t\t}\n\t},\n};\n"]}