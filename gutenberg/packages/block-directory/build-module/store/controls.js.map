{"version":3,"sources":["@wordpress/block-directory/src/store/controls.js"],"names":["loadScript","asset","test","Promise","reject","Error","resolve","existing","document","querySelector","parentNode","removeChild","script","createElement","src","onload","onerror","body","appendChild","loadStyle","link","rel","href","loadAssets","assets","type","controls","LOAD_ASSETS","scripts","map","match","all"],"mappings":"AAAA;;;;;;;AAOA,OAAO,IAAMA,UAAU,GAAG,SAAbA,UAAa,CAAEC,KAAF,EAAa;AACtC,MAAK,CAAEA,KAAF,IAAW,CAAE,QAAQC,IAAR,CAAcD,KAAd,CAAlB,EAA0C;AACzC,WAAOE,OAAO,CAACC,MAAR,CAAgB,IAAIC,KAAJ,CAAW,kBAAX,CAAhB,CAAP;AACA;;AACD,SAAO,IAAIF,OAAJ,CAAa,UAAEG,OAAF,EAAWF,MAAX,EAAuB;AAC1C,QAAMG,QAAQ,GAAGC,QAAQ,CAACC,aAAT,wBAAwCR,KAAxC,SAAjB;;AACA,QAAKM,QAAL,EAAgB;AACfA,MAAAA,QAAQ,CAACG,UAAT,CAAoBC,WAApB,CAAiCJ,QAAjC;AACA;;AACD,QAAMK,MAAM,GAAGJ,QAAQ,CAACK,aAAT,CAAwB,QAAxB,CAAf;AACAD,IAAAA,MAAM,CAACE,GAAP,GAAab,KAAb;;AACAW,IAAAA,MAAM,CAACG,MAAP,GAAgB;AAAA,aAAMT,OAAO,CAAE,IAAF,CAAb;AAAA,KAAhB;;AACAM,IAAAA,MAAM,CAACI,OAAP,GAAiB;AAAA,aAAMZ,MAAM,CAAE,IAAIC,KAAJ,CAAW,uBAAX,CAAF,CAAZ;AAAA,KAAjB;;AACAG,IAAAA,QAAQ,CAACS,IAAT,CAAcC,WAAd,CAA2BN,MAA3B;AACA,GAVM,CAAP;AAWA,CAfM;AAiBP;;;;;;;;AAOA,OAAO,IAAMO,SAAS,GAAG,SAAZA,SAAY,CAAElB,KAAF,EAAa;AACrC,MAAK,CAAEA,KAAF,IAAW,CAAE,SAASC,IAAT,CAAeD,KAAf,CAAlB,EAA2C;AAC1C,WAAOE,OAAO,CAACC,MAAR,CAAgB,IAAIC,KAAJ,CAAW,iBAAX,CAAhB,CAAP;AACA;;AACD,SAAO,IAAIF,OAAJ,CAAa,UAAEG,OAAF,EAAWF,MAAX,EAAuB;AAC1C,QAAMgB,IAAI,GAAGZ,QAAQ,CAACK,aAAT,CAAwB,MAAxB,CAAb;AACAO,IAAAA,IAAI,CAACC,GAAL,GAAW,YAAX;AACAD,IAAAA,IAAI,CAACE,IAAL,GAAYrB,KAAZ;;AACAmB,IAAAA,IAAI,CAACL,MAAL,GAAc;AAAA,aAAMT,OAAO,CAAE,IAAF,CAAb;AAAA,KAAd;;AACAc,IAAAA,IAAI,CAACJ,OAAL,GAAe;AAAA,aAAMZ,MAAM,CAAE,IAAIC,KAAJ,CAAW,sBAAX,CAAF,CAAZ;AAAA,KAAf;;AACAG,IAAAA,QAAQ,CAACS,IAAT,CAAcC,WAAd,CAA2BE,IAA3B;AACA,GAPM,CAAP;AAQA,CAZM;AAcP;;;;;;;;AAOA,OAAO,SAASG,UAAT,CAAqBC,MAArB,EAA8B;AACpC,SAAO;AACNC,IAAAA,IAAI,EAAE,aADA;AAEND,IAAAA,MAAM,EAANA;AAFM,GAAP;AAIA;AAED,IAAME,QAAQ,GAAG;AAChBC,EAAAA,WADgB,6BACU;AAAA,QAAXH,MAAW,QAAXA,MAAW;AACzB,QAAMI,OAAO,GAAGJ,MAAM,CAACK,GAAP,CAAY,UAAE5B,KAAF;AAAA,aAC3BA,KAAK,CAAC6B,KAAN,CAAa,OAAb,MAA2B,IAA3B,GACG9B,UAAU,CAAEC,KAAF,CADb,GAEGkB,SAAS,CAAElB,KAAF,CAHe;AAAA,KAAZ,CAAhB;AAMA,WAAOE,OAAO,CAAC4B,GAAR,CAAaH,OAAb,CAAP;AACA;AATe,CAAjB;AAYA,eAAeF,QAAf","sourcesContent":["/**\n * Loads a JavaScript file.\n *\n * @param {string} asset The url for this file.\n *\n * @return {Promise} Promise which will resolve when the asset is loaded.\n */\nexport const loadScript = ( asset ) => {\n\tif ( ! asset || ! /\\.js$/.test( asset ) ) {\n\t\treturn Promise.reject( new Error( 'No script found.' ) );\n\t}\n\treturn new Promise( ( resolve, reject ) => {\n\t\tconst existing = document.querySelector( `script[src=\"${ asset }\"]` );\n\t\tif ( existing ) {\n\t\t\texisting.parentNode.removeChild( existing );\n\t\t}\n\t\tconst script = document.createElement( 'script' );\n\t\tscript.src = asset;\n\t\tscript.onload = () => resolve( true );\n\t\tscript.onerror = () => reject( new Error( 'Error loading script.' ) );\n\t\tdocument.body.appendChild( script );\n\t} );\n};\n\n/**\n * Loads a CSS file.\n *\n * @param {string} asset The url for this file.\n *\n * @return {Promise} Promise which will resolve when the asset is added.\n */\nexport const loadStyle = ( asset ) => {\n\tif ( ! asset || ! /\\.css$/.test( asset ) ) {\n\t\treturn Promise.reject( new Error( 'No style found.' ) );\n\t}\n\treturn new Promise( ( resolve, reject ) => {\n\t\tconst link = document.createElement( 'link' );\n\t\tlink.rel = 'stylesheet';\n\t\tlink.href = asset;\n\t\tlink.onload = () => resolve( true );\n\t\tlink.onerror = () => reject( new Error( 'Error loading style.' ) );\n\t\tdocument.body.appendChild( link );\n\t} );\n};\n\n/**\n * Load the asset files for a block\n *\n * @param {Array} assets A collection of URLs for the assets.\n *\n * @return {Object} Control descriptor.\n */\nexport function loadAssets( assets ) {\n\treturn {\n\t\ttype: 'LOAD_ASSETS',\n\t\tassets,\n\t};\n}\n\nconst controls = {\n\tLOAD_ASSETS( { assets } ) {\n\t\tconst scripts = assets.map( ( asset ) =>\n\t\t\tasset.match( /\\.js$/ ) !== null\n\t\t\t\t? loadScript( asset )\n\t\t\t\t: loadStyle( asset )\n\t\t);\n\n\t\treturn Promise.all( scripts );\n\t},\n};\n\nexport default controls;\n"]}