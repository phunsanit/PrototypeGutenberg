{"version":3,"sources":["@wordpress/block-directory/src/store/resolvers.js"],"names":["getDownloadableBlocks","filterValue","path","results","blocks","map","result","value","key","code","hasInstallBlocksPermission"],"mappings":";;;;;;;;;;;AAGA;;AAKA;;AAKA;;AAbA;;;;AAKA;;;;AAKA;;;eASe;AACbA,EAAAA,qBADa,wEACUC,WADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAENA,WAFM;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAOZ,mBAAM,sCAAyBA,WAAzB,CAAN;;AAPY;AAAA;AAQI,mBAAM,4BAAU;AAC/BC,cAAAA,IAAI,uDAAiDD,WAAjD;AAD2B,aAAV,CAAN;;AARJ;AAQNE,YAAAA,OARM;AAWNC,YAAAA,MAXM,GAWGD,OAAO,CAACE,GAAR,CAAa,UAAEC,MAAF;AAAA,qBAC3B,qBAASA,MAAT,EAAiB,UAAEC,KAAF,EAASC,GAAT,EAAkB;AAClC,uBAAO,uBAAWA,GAAX,CAAP;AACA,eAFD,CAD2B;AAAA,aAAb,CAXH;AAAA;AAiBZ,mBAAM,wCAA2BJ,MAA3B,EAAmCH,WAAnC,CAAN;;AAjBY;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA,kBAmBP,YAAMQ,IAAN,KAAe,uBAnBR;AAAA;AAAA;AAAA;;AAAA;AAoBX,mBAAM,yCAA4B,KAA5B,CAAN;;AApBW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAwBbC,EAAAA,0BAxBa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0BZ,mBAAM,4BAAU;AACfR,cAAAA,IAAI;AADW,aAAV,CAAN;;AA1BY;AAAA;AA6BZ,mBAAM,yCAA4B,IAA5B,CAAN;;AA7BY;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA,kBA+BP,aAAMO,IAAN,KAAe,uBA/BR;AAAA;AAAA;AAAA;;AAAA;AAgCX,mBAAM,yCAA4B,KAA5B,CAAN;;AAhCW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,C","sourcesContent":["/**\n * External dependencies\n */\nimport { camelCase, mapKeys } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { apiFetch } from '@wordpress/data-controls';\n\n/**\n * Internal dependencies\n */\nimport {\n\tfetchDownloadableBlocks,\n\treceiveDownloadableBlocks,\n\tsetInstallBlocksPermission,\n} from './actions';\n\nexport default {\n\t*getDownloadableBlocks( filterValue ) {\n\t\tif ( ! filterValue ) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tyield fetchDownloadableBlocks( filterValue );\n\t\t\tconst results = yield apiFetch( {\n\t\t\t\tpath: `__experimental/block-directory/search?term=${ filterValue }`,\n\t\t\t} );\n\t\t\tconst blocks = results.map( ( result ) =>\n\t\t\t\tmapKeys( result, ( value, key ) => {\n\t\t\t\t\treturn camelCase( key );\n\t\t\t\t} )\n\t\t\t);\n\n\t\t\tyield receiveDownloadableBlocks( blocks, filterValue );\n\t\t} catch ( error ) {\n\t\t\tif ( error.code === 'rest_user_cannot_view' ) {\n\t\t\t\tyield setInstallBlocksPermission( false );\n\t\t\t}\n\t\t}\n\t},\n\t*hasInstallBlocksPermission() {\n\t\ttry {\n\t\t\tyield apiFetch( {\n\t\t\t\tpath: `__experimental/block-directory/search?term=`,\n\t\t\t} );\n\t\t\tyield setInstallBlocksPermission( true );\n\t\t} catch ( error ) {\n\t\t\tif ( error.code === 'rest_user_cannot_view' ) {\n\t\t\t\tyield setInstallBlocksPermission( false );\n\t\t\t}\n\t\t}\n\t},\n};\n"]}