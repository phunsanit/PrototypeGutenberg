{"version":3,"sources":["@wordpress/edit-navigation/src/components/menus-editor/index.js"],"names":["MenusEditor","blockEditorSettings","select","getMenus","hasFinishedResolution","menus","hasLoadedMenus","hasCompletedFirstLoad","setHasCompletedFirstLoad","menuId","setMenuId","stateMenus","setStateMenus","showCreateMenuPanel","setShowCreateMenuPanel","length","id","hasMenus","isCreateMenuPanelVisible","map","menu","value","label","name","selectedMenuId","undefined","newMenuId","deletedMenu","newStateMenus","filter"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect } from '@wordpress/data';\nimport { useState, useEffect } from '@wordpress/element';\nimport {\n\tButton,\n\tCard,\n\tCardBody,\n\tSpinner,\n\tSelectControl,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport CreateMenuPanel from './create-menu-panel';\nimport MenuEditor from '../menu-editor';\n\nexport default function MenusEditor( { blockEditorSettings } ) {\n\tconst { menus, hasLoadedMenus } = useSelect( ( select ) => {\n\t\tconst { getMenus, hasFinishedResolution } = select( 'core' );\n\t\treturn {\n\t\t\tmenus: getMenus(),\n\t\t\thasLoadedMenus: hasFinishedResolution( 'getMenus' ),\n\t\t};\n\t}, [] );\n\n\tconst [ hasCompletedFirstLoad, setHasCompletedFirstLoad ] = useState(\n\t\tfalse\n\t);\n\n\tuseEffect( () => {\n\t\tif ( ! hasCompletedFirstLoad && hasLoadedMenus ) {\n\t\t\tsetHasCompletedFirstLoad( true );\n\t\t}\n\t}, [ hasLoadedMenus ] );\n\n\tconst [ menuId, setMenuId ] = useState();\n\tconst [ stateMenus, setStateMenus ] = useState();\n\tconst [ showCreateMenuPanel, setShowCreateMenuPanel ] = useState( false );\n\n\tuseEffect( () => {\n\t\tif ( menus?.length ) {\n\t\t\tsetStateMenus( menus );\n\n\t\t\t// Only set menuId if it's currently unset.\n\t\t\tif ( ! menuId ) {\n\t\t\t\tsetMenuId( menus[ 0 ].id );\n\t\t\t}\n\t\t}\n\t}, [ menus, menuId ] );\n\n\tif ( ! hasCompletedFirstLoad ) {\n\t\treturn <Spinner />;\n\t}\n\n\tconst hasMenus = !! stateMenus?.length;\n\tconst isCreateMenuPanelVisible =\n\t\thasCompletedFirstLoad && ( ! hasMenus || showCreateMenuPanel );\n\n\treturn (\n\t\t<>\n\t\t\t<Card className=\"edit-navigation-menus-editor__menu-selection-card\">\n\t\t\t\t<CardBody className=\"edit-navigation-menus-editor__menu-selection-card-body\">\n\t\t\t\t\t{ hasCompletedFirstLoad && ! hasMenus && (\n\t\t\t\t\t\t<p className=\"edit-navigation-menus-editor__menu-selection-card-instructional-text\">\n\t\t\t\t\t\t\t{ __( 'Create your first menu below.' ) }\n\t\t\t\t\t\t</p>\n\t\t\t\t\t) }\n\t\t\t\t\t{ hasMenus && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\t\tclassName=\"edit-navigation-menus-editor__menu-select-control\"\n\t\t\t\t\t\t\t\tlabel={ __( 'Select navigation to edit:' ) }\n\t\t\t\t\t\t\t\toptions={ stateMenus?.map( ( menu ) => ( {\n\t\t\t\t\t\t\t\t\tvalue: menu.id,\n\t\t\t\t\t\t\t\t\tlabel: menu.name,\n\t\t\t\t\t\t\t\t} ) ) }\n\t\t\t\t\t\t\t\tonChange={ ( selectedMenuId ) =>\n\t\t\t\t\t\t\t\t\tsetMenuId( selectedMenuId )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvalue={ menuId }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tisLink\n\t\t\t\t\t\t\t\tonClick={ () => setShowCreateMenuPanel( true ) }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'Create a new menu' ) }\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) }\n\t\t\t\t</CardBody>\n\t\t\t</Card>\n\t\t\t{ isCreateMenuPanelVisible && (\n\t\t\t\t<CreateMenuPanel\n\t\t\t\t\tmenus={ stateMenus }\n\t\t\t\t\tonCancel={\n\t\t\t\t\t\t// User can only cancel out of menu creation if there\n\t\t\t\t\t\t// are other menus to fall back to showing.\n\t\t\t\t\t\thasMenus\n\t\t\t\t\t\t\t? () => setShowCreateMenuPanel( false )\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t}\n\t\t\t\t\tonCreateMenu={ ( newMenuId ) => {\n\t\t\t\t\t\tsetMenuId( newMenuId );\n\t\t\t\t\t\tsetShowCreateMenuPanel( false );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\t{ hasMenus && (\n\t\t\t\t<MenuEditor\n\t\t\t\t\tmenuId={ menuId }\n\t\t\t\t\tblockEditorSettings={ blockEditorSettings }\n\t\t\t\t\tonDeleteMenu={ ( deletedMenu ) => {\n\t\t\t\t\t\tconst newStateMenus = stateMenus.filter( ( menu ) => {\n\t\t\t\t\t\t\treturn menu.id !== deletedMenu;\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tsetStateMenus( newStateMenus );\n\t\t\t\t\t\tif ( newStateMenus.length ) {\n\t\t\t\t\t\t\tsetMenuId( newStateMenus[ 0 ].id );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetMenuId();\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</>\n\t);\n}\n"]}