{"version":3,"sources":["@wordpress/edit-site/src/components/navigate-to-link/index.js"],"names":["window","fetch","getPathFromLink","link","path","queryString","value","NavigateToLink","url","type","id","activePage","onActivePageAndTemplateIdChange","templateId","setTemplateId","effect","then","res","json","success","data","newTemplateId","ID","getEntityRecords","resolved","slug","post_name","Error","onClick","page","context","postType","postId"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { getPath, getQueryString, addQueryArgs } from '@wordpress/url';\nimport { useState, useEffect, useMemo } from '@wordpress/element';\nimport { __experimentalResolveSelect as resolveSelect } from '@wordpress/data';\nimport { Button } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Browser dependencies\n */\nconst { fetch } = window;\n\nfunction getPathFromLink( link ) {\n\t// TODO: Explore abstracting this into `@wordpress/url`.\n\tconst path = getPath( link );\n\tconst queryString = getQueryString( link );\n\tlet value = '/';\n\tif ( path ) value += path;\n\tif ( queryString ) value += `?${ queryString }`;\n\treturn value;\n}\nexport default function NavigateToLink( {\n\turl,\n\ttype,\n\tid,\n\tactivePage,\n\tonActivePageAndTemplateIdChange,\n} ) {\n\tconst [ templateId, setTemplateId ] = useState();\n\tuseEffect( () => {\n\t\tconst effect = async () => {\n\t\t\ttry {\n\t\t\t\tconst { success, data } = await fetch(\n\t\t\t\t\taddQueryArgs( url, { '_wp-find-template': true } )\n\t\t\t\t).then( ( res ) => res.json() );\n\t\t\t\tif ( success ) {\n\t\t\t\t\tlet newTemplateId = data.ID;\n\t\t\t\t\tif ( newTemplateId === null ) {\n\t\t\t\t\t\tnewTemplateId = (\n\t\t\t\t\t\t\tawait resolveSelect( 'core' ).getEntityRecords(\n\t\t\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t\t\t'wp_template',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tresolved: true,\n\t\t\t\t\t\t\t\t\tslug: data.post_name,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t )[ 0 ].id;\n\t\t\t\t\t}\n\t\t\t\t\tsetTemplateId( newTemplateId );\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error();\n\t\t\t\t}\n\t\t\t} catch ( err ) {\n\t\t\t\tsetTemplateId( null );\n\t\t\t}\n\t\t};\n\t\teffect();\n\t}, [ url ] );\n\tconst onClick = useMemo( () => {\n\t\tif ( ! templateId || ! type || ! id || type === 'URL' ) return null;\n\t\tconst path = getPathFromLink( url );\n\t\tif ( path === activePage.path ) return null;\n\t\treturn () =>\n\t\t\tonActivePageAndTemplateIdChange( {\n\t\t\t\tpage: {\n\t\t\t\t\tpath,\n\t\t\t\t\tcontext: { postType: type, postId: id },\n\t\t\t\t},\n\t\t\t\ttemplateId,\n\t\t\t} );\n\t}, [\n\t\ttemplateId,\n\t\ttype,\n\t\tid,\n\t\tgetPathFromLink,\n\t\turl,\n\t\tonActivePageAndTemplateIdChange,\n\t] );\n\treturn (\n\t\tonClick && (\n\t\t\t<Button\n\t\t\t\ticon=\"welcome-write-blog\"\n\t\t\t\tlabel={ __( 'Edit Page Template' ) }\n\t\t\t\tonClick={ onClick }\n\t\t\t/>\n\t\t)\n\t);\n}\n"]}