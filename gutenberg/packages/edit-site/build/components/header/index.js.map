{"version":3,"sources":["@wordpress/edit-site/src/components/header/index.js"],"names":["window","fetch","Header","openEntitiesSavedStates","isInserterOpen","onToggleInserter","settings","setSettings","setActiveTemplateId","newTemplateId","prevSettings","templateId","templateType","setActiveTemplatePartId","newTemplatePartId","addTemplateId","templateIds","setActivePage","newPage","path","then","res","json","success","data","ID","getEntityRecords","resolved","slug","post_name","id","page","select","__experimentalGetPreviewDeviceType","isFeatureActive","deviceType","hasFixedToolbar","setPreviewDeviceType","__experimentalSetPreviewDeviceType","isLargeViewport","displayBlockToolbar","plus","showOnFront","templatePartIds","homeTemplateId"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useViewportMatch } from '@wordpress/compose';\nimport { useCallback } from '@wordpress/element';\nimport { addQueryArgs } from '@wordpress/url';\nimport {\n\tBlockNavigationDropdown,\n\tToolSelector,\n\tBlockToolbar,\n\t__experimentalPreviewOptions as PreviewOptions,\n} from '@wordpress/block-editor';\nimport {\n\t__experimentalResolveSelect as resolveSelect,\n\tuseSelect,\n\tuseDispatch,\n} from '@wordpress/data';\nimport {\n\tPinnedItems,\n\t__experimentalMainDashboardButton as MainDashboardButton,\n} from '@wordpress/interface';\nimport { _x } from '@wordpress/i18n';\nimport { plus } from '@wordpress/icons';\nimport { Button } from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport { useEditorContext } from '../editor';\nimport MoreMenu from './more-menu';\nimport PageSwitcher from '../page-switcher';\nimport TemplateSwitcher from '../template-switcher';\nimport SaveButton from '../save-button';\nimport UndoButton from './undo-redo/undo';\nimport RedoButton from './undo-redo/redo';\nimport FullscreenModeClose from './fullscreen-mode-close';\n\n/**\n * Browser dependencies\n */\nconst { fetch } = window;\n\nexport default function Header( {\n\topenEntitiesSavedStates,\n\tisInserterOpen,\n\tonToggleInserter,\n} ) {\n\tconst { settings, setSettings } = useEditorContext();\n\tconst setActiveTemplateId = useCallback(\n\t\t( newTemplateId ) =>\n\t\t\tsetSettings( ( prevSettings ) => ( {\n\t\t\t\t...prevSettings,\n\t\t\t\ttemplateId: newTemplateId,\n\t\t\t\ttemplateType: 'wp_template',\n\t\t\t} ) ),\n\t\t[]\n\t);\n\tconst setActiveTemplatePartId = useCallback(\n\t\t( newTemplatePartId ) =>\n\t\t\tsetSettings( ( prevSettings ) => ( {\n\t\t\t\t...prevSettings,\n\t\t\t\ttemplateId: newTemplatePartId,\n\t\t\t\ttemplateType: 'wp_template_part',\n\t\t\t} ) ),\n\t\t[]\n\t);\n\tconst addTemplateId = useCallback(\n\t\t( newTemplateId ) =>\n\t\t\tsetSettings( ( prevSettings ) => ( {\n\t\t\t\t...prevSettings,\n\t\t\t\ttemplateId: newTemplateId,\n\t\t\t\ttemplateIds: [ ...prevSettings.templateIds, newTemplateId ],\n\t\t\t} ) ),\n\t\t[]\n\t);\n\tconst setActivePage = useCallback( async ( newPage ) => {\n\t\ttry {\n\t\t\tconst { success, data } = await fetch(\n\t\t\t\taddQueryArgs( newPage.path, { '_wp-find-template': true } )\n\t\t\t).then( ( res ) => res.json() );\n\t\t\tif ( success ) {\n\t\t\t\tlet newTemplateId = data.ID;\n\t\t\t\tif ( newTemplateId === null ) {\n\t\t\t\t\tnewTemplateId = (\n\t\t\t\t\t\tawait resolveSelect( 'core' ).getEntityRecords(\n\t\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t\t'wp_template',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresolved: true,\n\t\t\t\t\t\t\t\tslug: data.post_name,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t )[ 0 ].id;\n\t\t\t\t}\n\t\t\t\tsetSettings( ( prevSettings ) => ( {\n\t\t\t\t\t...prevSettings,\n\t\t\t\t\tpage: newPage,\n\t\t\t\t\ttemplateId: newTemplateId,\n\t\t\t\t\ttemplateType: 'wp_template',\n\t\t\t\t} ) );\n\t\t\t}\n\t\t} catch ( err ) {}\n\t}, [] );\n\n\tconst { deviceType, hasFixedToolbar } = useSelect( ( select ) => {\n\t\tconst { __experimentalGetPreviewDeviceType, isFeatureActive } = select(\n\t\t\t'core/edit-site'\n\t\t);\n\t\treturn {\n\t\t\tdeviceType: __experimentalGetPreviewDeviceType(),\n\t\t\thasFixedToolbar: isFeatureActive( 'fixedToolbar' ),\n\t\t};\n\t}, [] );\n\n\tconst {\n\t\t__experimentalSetPreviewDeviceType: setPreviewDeviceType,\n\t} = useDispatch( 'core/edit-site' );\n\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst displayBlockToolbar =\n\t\t! isLargeViewport || deviceType !== 'Desktop' || hasFixedToolbar;\n\n\treturn (\n\t\t<div className=\"edit-site-header\">\n\t\t\t<MainDashboardButton.Slot>\n\t\t\t\t<FullscreenModeClose />\n\t\t\t</MainDashboardButton.Slot>\n\t\t\t<div className=\"edit-site-header__toolbar\">\n\t\t\t\t<Button\n\t\t\t\t\tisPrimary\n\t\t\t\t\tisPressed={ isInserterOpen }\n\t\t\t\t\tonClick={ onToggleInserter }\n\t\t\t\t\ticon={ plus }\n\t\t\t\t\tlabel={ _x(\n\t\t\t\t\t\t'Add block',\n\t\t\t\t\t\t'Generic label for block inserter button'\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t\t<ToolSelector />\n\t\t\t\t<UndoButton />\n\t\t\t\t<RedoButton />\n\t\t\t\t<BlockNavigationDropdown />\n\t\t\t\t{ displayBlockToolbar && (\n\t\t\t\t\t<div className=\"edit-site-header-toolbar__block-toolbar\">\n\t\t\t\t\t\t<BlockToolbar hideDragHandle />\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t\t<div className=\"edit-site-header__toolbar-switchers\">\n\t\t\t\t\t<PageSwitcher\n\t\t\t\t\t\tshowOnFront={ settings.showOnFront }\n\t\t\t\t\t\tactivePage={ settings.page }\n\t\t\t\t\t\tonActivePageChange={ setActivePage }\n\t\t\t\t\t/>\n\t\t\t\t\t<div className=\"edit-site-header__toolbar-switchers-separator\">\n\t\t\t\t\t\t/\n\t\t\t\t\t</div>\n\t\t\t\t\t<TemplateSwitcher\n\t\t\t\t\t\tids={ settings.templateIds }\n\t\t\t\t\t\ttemplatePartIds={ settings.templatePartIds }\n\t\t\t\t\t\tactiveId={ settings.templateId }\n\t\t\t\t\t\thomeId={ settings.homeTemplateId }\n\t\t\t\t\t\tisTemplatePart={\n\t\t\t\t\t\t\tsettings.templateType === 'wp_template_part'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonActiveIdChange={ setActiveTemplateId }\n\t\t\t\t\t\tonActiveTemplatePartIdChange={ setActiveTemplatePartId }\n\t\t\t\t\t\tonAddTemplateId={ addTemplateId }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"edit-site-header__actions\">\n\t\t\t\t<PreviewOptions\n\t\t\t\t\tdeviceType={ deviceType }\n\t\t\t\t\tsetDeviceType={ setPreviewDeviceType }\n\t\t\t\t/>\n\t\t\t\t<SaveButton\n\t\t\t\t\topenEntitiesSavedStates={ openEntitiesSavedStates }\n\t\t\t\t/>\n\t\t\t\t<PinnedItems.Slot scope=\"core/edit-site\" />\n\t\t\t\t<MoreMenu />\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"]}