{"version":3,"sources":["@wordpress/edit-site/src/components/template-switcher/index.js"],"names":["__","useSelect","useState","useCallback","Tooltip","DropdownMenu","MenuGroup","MenuItemsChoice","MenuItem","Icon","home","plus","AddTemplate","TemplatePreview","ThemePreview","TemplateLabel","template","homeId","slug","id","status","TemplateSwitcher","ids","templatePartIds","activeId","isTemplatePart","onActiveIdChange","onActiveTemplatePartIdChange","onAddTemplateId","hoveredTemplate","setHoveredTemplate","themePreviewVisible","setThemePreviewVisible","onHoverTemplate","type","onHoverTemplatePart","onMouseEnterTheme","onMouseLeaveTheme","select","getCurrentTheme","getEntityRecord","currentTheme","templates","map","label","value","templateParts","isAddTemplateOpen","setIsAddTemplateOpen","className","position","children","find","choice","onClose","undefined","name"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { useSelect } from '@wordpress/data';\nimport { useState, useCallback } from '@wordpress/element';\nimport {\n\tTooltip,\n\tDropdownMenu,\n\tMenuGroup,\n\tMenuItemsChoice,\n\tMenuItem,\n} from '@wordpress/components';\nimport { Icon, home, plus } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport AddTemplate from '../add-template';\nimport TemplatePreview from './template-preview';\nimport ThemePreview from './theme-preview';\n\nfunction TemplateLabel( { template, homeId } ) {\n\treturn (\n\t\t<>\n\t\t\t{ template.slug }{ ' ' }\n\t\t\t{ template.id === homeId && (\n\t\t\t\t<Tooltip text={ __( 'Home' ) }>\n\t\t\t\t\t<div className=\"edit-site-template-switcher__label-home-icon\">\n\t\t\t\t\t\t<Icon icon={ home } />\n\t\t\t\t\t</div>\n\t\t\t\t</Tooltip>\n\t\t\t) }\n\t\t\t{ template.status !== 'auto-draft' && (\n\t\t\t\t<Tooltip text={ __( 'Customized' ) }>\n\t\t\t\t\t<span className=\"edit-site-template-switcher__label-customized-dot\" />\n\t\t\t\t</Tooltip>\n\t\t\t) }\n\t\t</>\n\t);\n}\n\nexport default function TemplateSwitcher( {\n\tids,\n\ttemplatePartIds,\n\tactiveId,\n\thomeId,\n\tisTemplatePart,\n\tonActiveIdChange,\n\tonActiveTemplatePartIdChange,\n\tonAddTemplateId,\n} ) {\n\tconst [ hoveredTemplate, setHoveredTemplate ] = useState();\n\tconst [ themePreviewVisible, setThemePreviewVisible ] = useState( false );\n\n\tconst onHoverTemplate = ( id ) => {\n\t\tsetHoveredTemplate( { id, type: 'template' } );\n\t};\n\tconst onHoverTemplatePart = ( id ) => {\n\t\tsetHoveredTemplate( { id, type: 'template-part' } );\n\t};\n\n\tconst onMouseEnterTheme = () => {\n\t\tsetThemePreviewVisible( () => true );\n\t};\n\tconst onMouseLeaveTheme = () => {\n\t\tsetThemePreviewVisible( () => false );\n\t};\n\n\tconst { currentTheme, templates, templateParts } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getCurrentTheme, getEntityRecord } = select( 'core' );\n\t\t\treturn {\n\t\t\t\tcurrentTheme: getCurrentTheme(),\n\t\t\t\ttemplates: ids.map( ( id ) => {\n\t\t\t\t\tconst template = getEntityRecord(\n\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t'wp_template',\n\t\t\t\t\t\tid\n\t\t\t\t\t);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tlabel: template ? (\n\t\t\t\t\t\t\t<TemplateLabel\n\t\t\t\t\t\t\t\ttemplate={ template }\n\t\t\t\t\t\t\t\thomeId={ homeId }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t__( 'Loading…' )\n\t\t\t\t\t\t),\n\t\t\t\t\t\tvalue: id,\n\t\t\t\t\t\tslug: template ? template.slug : __( 'Loading…' ),\n\t\t\t\t\t};\n\t\t\t\t} ),\n\t\t\t\ttemplateParts: templatePartIds.map( ( id ) => {\n\t\t\t\t\tconst template = getEntityRecord(\n\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t'wp_template_part',\n\t\t\t\t\t\tid\n\t\t\t\t\t);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tlabel: template ? (\n\t\t\t\t\t\t\t<TemplateLabel template={ template } />\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t__( 'Loading…' )\n\t\t\t\t\t\t),\n\t\t\t\t\t\tvalue: id,\n\t\t\t\t\t\tslug: template ? template.slug : __( 'Loading…' ),\n\t\t\t\t\t};\n\t\t\t\t} ),\n\t\t\t};\n\t\t},\n\t\t[ ids, templatePartIds, homeId ]\n\t);\n\tconst [ isAddTemplateOpen, setIsAddTemplateOpen ] = useState( false );\n\treturn (\n\t\t<>\n\t\t\t<DropdownMenu\n\t\t\t\tpopoverProps={ {\n\t\t\t\t\tclassName: 'edit-site-template-switcher__popover',\n\t\t\t\t\tposition: 'bottom right',\n\t\t\t\t} }\n\t\t\t\ticon={ null }\n\t\t\t\tlabel={ __( 'Switch Template' ) }\n\t\t\t\ttoggleProps={ {\n\t\t\t\t\tchildren: ( isTemplatePart\n\t\t\t\t\t\t? templateParts\n\t\t\t\t\t\t: templates\n\t\t\t\t\t).find( ( choice ) => choice.value === activeId ).slug,\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t{ ( { onClose } ) => (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<MenuGroup label={ __( 'Templates' ) }>\n\t\t\t\t\t\t\t<MenuItemsChoice\n\t\t\t\t\t\t\t\tchoices={ templates }\n\t\t\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\t\t\t! isTemplatePart ? activeId : undefined\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tonSelect={ onActiveIdChange }\n\t\t\t\t\t\t\t\tonHover={ onHoverTemplate }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\ticon={ plus }\n\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t\tsetIsAddTemplateOpen( true );\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'New' ) }\n\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t\t<MenuGroup label={ __( 'Template Parts' ) }>\n\t\t\t\t\t\t\t<MenuItemsChoice\n\t\t\t\t\t\t\t\tchoices={ templateParts }\n\t\t\t\t\t\t\t\tvalue={ isTemplatePart ? activeId : undefined }\n\t\t\t\t\t\t\t\tonSelect={ onActiveTemplatePartIdChange }\n\t\t\t\t\t\t\t\tonHover={ onHoverTemplatePart }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t\t<MenuGroup label={ __( 'Current theme' ) }>\n\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\tonMouseEnter={ onMouseEnterTheme }\n\t\t\t\t\t\t\t\tonMouseLeave={ onMouseLeaveTheme }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ currentTheme.name }\n\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t\t{ !! hoveredTemplate?.id && (\n\t\t\t\t\t\t\t<TemplatePreview item={ hoveredTemplate } />\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ themePreviewVisible && (\n\t\t\t\t\t\t\t<ThemePreview theme={ currentTheme } />\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<div className=\"edit-site-template-switcher__footer\" />\n\t\t\t\t\t</>\n\t\t\t\t) }\n\t\t\t</DropdownMenu>\n\t\t\t<AddTemplate\n\t\t\t\tids={ ids }\n\t\t\t\tonAddTemplateId={ onAddTemplateId }\n\t\t\t\tonRequestClose={ useCallback(\n\t\t\t\t\t() => setIsAddTemplateOpen( false ),\n\t\t\t\t\t[]\n\t\t\t\t) }\n\t\t\t\tisOpen={ isAddTemplateOpen }\n\t\t\t/>\n\t\t</>\n\t);\n}\n"]}