{"version":3,"sources":["@wordpress/edit-site/src/components/header/index.js"],"names":["useViewportMatch","useCallback","addQueryArgs","BlockNavigationDropdown","ToolSelector","BlockToolbar","__experimentalPreviewOptions","PreviewOptions","__experimentalResolveSelect","resolveSelect","useSelect","useDispatch","PinnedItems","__experimentalMainDashboardButton","MainDashboardButton","_x","plus","Button","useEditorContext","MoreMenu","PageSwitcher","TemplateSwitcher","SaveButton","UndoButton","RedoButton","FullscreenModeClose","window","fetch","Header","openEntitiesSavedStates","isInserterOpen","onToggleInserter","settings","setSettings","setActiveTemplateId","newTemplateId","prevSettings","templateId","templateType","setActiveTemplatePartId","newTemplatePartId","addTemplateId","templateIds","setActivePage","newPage","path","then","res","json","success","data","ID","getEntityRecords","resolved","slug","post_name","id","page","select","__experimentalGetPreviewDeviceType","isFeatureActive","deviceType","hasFixedToolbar","setPreviewDeviceType","__experimentalSetPreviewDeviceType","isLargeViewport","displayBlockToolbar","showOnFront","templatePartIds","homeTemplateId"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useViewportMatch } from '@wordpress/compose';\nimport { useCallback } from '@wordpress/element';\nimport { addQueryArgs } from '@wordpress/url';\nimport {\n\tBlockNavigationDropdown,\n\tToolSelector,\n\tBlockToolbar,\n\t__experimentalPreviewOptions as PreviewOptions,\n} from '@wordpress/block-editor';\nimport {\n\t__experimentalResolveSelect as resolveSelect,\n\tuseSelect,\n\tuseDispatch,\n} from '@wordpress/data';\nimport {\n\tPinnedItems,\n\t__experimentalMainDashboardButton as MainDashboardButton,\n} from '@wordpress/interface';\nimport { _x } from '@wordpress/i18n';\nimport { plus } from '@wordpress/icons';\nimport { Button } from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport { useEditorContext } from '../editor';\nimport MoreMenu from './more-menu';\nimport PageSwitcher from '../page-switcher';\nimport TemplateSwitcher from '../template-switcher';\nimport SaveButton from '../save-button';\nimport UndoButton from './undo-redo/undo';\nimport RedoButton from './undo-redo/redo';\nimport FullscreenModeClose from './fullscreen-mode-close';\n\n/**\n * Browser dependencies\n */\nconst { fetch } = window;\n\nexport default function Header( {\n\topenEntitiesSavedStates,\n\tisInserterOpen,\n\tonToggleInserter,\n} ) {\n\tconst { settings, setSettings } = useEditorContext();\n\tconst setActiveTemplateId = useCallback(\n\t\t( newTemplateId ) =>\n\t\t\tsetSettings( ( prevSettings ) => ( {\n\t\t\t\t...prevSettings,\n\t\t\t\ttemplateId: newTemplateId,\n\t\t\t\ttemplateType: 'wp_template',\n\t\t\t} ) ),\n\t\t[]\n\t);\n\tconst setActiveTemplatePartId = useCallback(\n\t\t( newTemplatePartId ) =>\n\t\t\tsetSettings( ( prevSettings ) => ( {\n\t\t\t\t...prevSettings,\n\t\t\t\ttemplateId: newTemplatePartId,\n\t\t\t\ttemplateType: 'wp_template_part',\n\t\t\t} ) ),\n\t\t[]\n\t);\n\tconst addTemplateId = useCallback(\n\t\t( newTemplateId ) =>\n\t\t\tsetSettings( ( prevSettings ) => ( {\n\t\t\t\t...prevSettings,\n\t\t\t\ttemplateId: newTemplateId,\n\t\t\t\ttemplateIds: [ ...prevSettings.templateIds, newTemplateId ],\n\t\t\t} ) ),\n\t\t[]\n\t);\n\tconst setActivePage = useCallback( async ( newPage ) => {\n\t\ttry {\n\t\t\tconst { success, data } = await fetch(\n\t\t\t\taddQueryArgs( newPage.path, { '_wp-find-template': true } )\n\t\t\t).then( ( res ) => res.json() );\n\t\t\tif ( success ) {\n\t\t\t\tlet newTemplateId = data.ID;\n\t\t\t\tif ( newTemplateId === null ) {\n\t\t\t\t\tnewTemplateId = (\n\t\t\t\t\t\tawait resolveSelect( 'core' ).getEntityRecords(\n\t\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t\t'wp_template',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresolved: true,\n\t\t\t\t\t\t\t\tslug: data.post_name,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t )[ 0 ].id;\n\t\t\t\t}\n\t\t\t\tsetSettings( ( prevSettings ) => ( {\n\t\t\t\t\t...prevSettings,\n\t\t\t\t\tpage: newPage,\n\t\t\t\t\ttemplateId: newTemplateId,\n\t\t\t\t\ttemplateType: 'wp_template',\n\t\t\t\t} ) );\n\t\t\t}\n\t\t} catch ( err ) {}\n\t}, [] );\n\n\tconst { deviceType, hasFixedToolbar } = useSelect( ( select ) => {\n\t\tconst { __experimentalGetPreviewDeviceType, isFeatureActive } = select(\n\t\t\t'core/edit-site'\n\t\t);\n\t\treturn {\n\t\t\tdeviceType: __experimentalGetPreviewDeviceType(),\n\t\t\thasFixedToolbar: isFeatureActive( 'fixedToolbar' ),\n\t\t};\n\t}, [] );\n\n\tconst {\n\t\t__experimentalSetPreviewDeviceType: setPreviewDeviceType,\n\t} = useDispatch( 'core/edit-site' );\n\n\tconst isLargeViewport = useViewportMatch( 'medium' );\n\tconst displayBlockToolbar =\n\t\t! isLargeViewport || deviceType !== 'Desktop' || hasFixedToolbar;\n\n\treturn (\n\t\t<div className=\"edit-site-header\">\n\t\t\t<MainDashboardButton.Slot>\n\t\t\t\t<FullscreenModeClose />\n\t\t\t</MainDashboardButton.Slot>\n\t\t\t<div className=\"edit-site-header__toolbar\">\n\t\t\t\t<Button\n\t\t\t\t\tisPrimary\n\t\t\t\t\tisPressed={ isInserterOpen }\n\t\t\t\t\tonClick={ onToggleInserter }\n\t\t\t\t\ticon={ plus }\n\t\t\t\t\tlabel={ _x(\n\t\t\t\t\t\t'Add block',\n\t\t\t\t\t\t'Generic label for block inserter button'\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t\t<ToolSelector />\n\t\t\t\t<UndoButton />\n\t\t\t\t<RedoButton />\n\t\t\t\t<BlockNavigationDropdown />\n\t\t\t\t{ displayBlockToolbar && (\n\t\t\t\t\t<div className=\"edit-site-header-toolbar__block-toolbar\">\n\t\t\t\t\t\t<BlockToolbar hideDragHandle />\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t\t<div className=\"edit-site-header__toolbar-switchers\">\n\t\t\t\t\t<PageSwitcher\n\t\t\t\t\t\tshowOnFront={ settings.showOnFront }\n\t\t\t\t\t\tactivePage={ settings.page }\n\t\t\t\t\t\tonActivePageChange={ setActivePage }\n\t\t\t\t\t/>\n\t\t\t\t\t<div className=\"edit-site-header__toolbar-switchers-separator\">\n\t\t\t\t\t\t/\n\t\t\t\t\t</div>\n\t\t\t\t\t<TemplateSwitcher\n\t\t\t\t\t\tids={ settings.templateIds }\n\t\t\t\t\t\ttemplatePartIds={ settings.templatePartIds }\n\t\t\t\t\t\tactiveId={ settings.templateId }\n\t\t\t\t\t\thomeId={ settings.homeTemplateId }\n\t\t\t\t\t\tisTemplatePart={\n\t\t\t\t\t\t\tsettings.templateType === 'wp_template_part'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonActiveIdChange={ setActiveTemplateId }\n\t\t\t\t\t\tonActiveTemplatePartIdChange={ setActiveTemplatePartId }\n\t\t\t\t\t\tonAddTemplateId={ addTemplateId }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"edit-site-header__actions\">\n\t\t\t\t<PreviewOptions\n\t\t\t\t\tdeviceType={ deviceType }\n\t\t\t\t\tsetDeviceType={ setPreviewDeviceType }\n\t\t\t\t/>\n\t\t\t\t<SaveButton\n\t\t\t\t\topenEntitiesSavedStates={ openEntitiesSavedStates }\n\t\t\t\t/>\n\t\t\t\t<PinnedItems.Slot scope=\"core/edit-site\" />\n\t\t\t\t<MoreMenu />\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"]}