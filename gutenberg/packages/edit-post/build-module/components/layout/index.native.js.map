{"version":3,"sources":["@wordpress/edit-post/src/components/layout/index.native.js"],"names":["Platform","SafeAreaView","View","SafeArea","sendNativeEditorDidLayout","Component","withSelect","BottomSheetSettings","__experimentalPageTemplatePicker","__experimentalWithPageTemplatePicker","FloatingToolbar","compose","withPreferredColorScheme","HTMLTextInput","KeyboardAvoidingView","AutosaveMonitor","styles","headerToolbarStyles","Header","VisualEditor","Layout","arguments","onSafeAreaInsetsUpdate","bind","onRootViewLayout","state","rootViewHeight","safeAreaInsets","top","bottom","right","left","getSafeAreaInsetsForRootView","then","_isMounted","addEventListener","removeEventListener","result","setState","event","setHeightState","height","nativeEvent","layout","isReady","props","setTitleRef","getStylesFromColorScheme","isTemplatePickerAvailable","isTemplatePickerVisible","mode","isHtmlView","marginBottom","OS","container","toolbarKeyboardAvoidingViewStyle","toolbarKeyboardAvoidingView","containerDark","background","backgroundDark","renderHTML","renderVisual","flex","flexBasis","select","isEditorReady","__unstableIsEditorReady","getEditorMode"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { Platform, SafeAreaView, View } from 'react-native';\nimport SafeArea from 'react-native-safe-area';\nimport { sendNativeEditorDidLayout } from 'react-native-gutenberg-bridge';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\nimport {\n\tBottomSheetSettings,\n\t__experimentalPageTemplatePicker,\n\t__experimentalWithPageTemplatePicker,\n\tFloatingToolbar,\n} from '@wordpress/block-editor';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport { HTMLTextInput, KeyboardAvoidingView } from '@wordpress/components';\nimport { AutosaveMonitor } from '@wordpress/editor';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport headerToolbarStyles from '../header/header-toolbar/style.scss';\nimport Header from '../header';\nimport VisualEditor from '../visual-editor';\n\nclass Layout extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onSafeAreaInsetsUpdate = this.onSafeAreaInsetsUpdate.bind( this );\n\t\tthis.onRootViewLayout = this.onRootViewLayout.bind( this );\n\n\t\tthis.state = {\n\t\t\trootViewHeight: 0,\n\t\t\tsafeAreaInsets: { top: 0, bottom: 0, right: 0, left: 0 },\n\t\t};\n\n\t\tSafeArea.getSafeAreaInsetsForRootView().then(\n\t\t\tthis.onSafeAreaInsetsUpdate\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis._isMounted = true;\n\t\tSafeArea.addEventListener(\n\t\t\t'safeAreaInsetsForRootViewDidChange',\n\t\t\tthis.onSafeAreaInsetsUpdate\n\t\t);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tSafeArea.removeEventListener(\n\t\t\t'safeAreaInsetsForRootViewDidChange',\n\t\t\tthis.onSafeAreaInsetsUpdate\n\t\t);\n\t\tthis._isMounted = false;\n\t}\n\n\tonSafeAreaInsetsUpdate( result ) {\n\t\tconst { safeAreaInsets } = result;\n\t\tif ( this._isMounted ) {\n\t\t\tthis.setState( { safeAreaInsets } );\n\t\t}\n\t}\n\n\tonRootViewLayout( event ) {\n\t\tif ( this._isMounted ) {\n\t\t\tthis.setHeightState( event );\n\t\t}\n\t}\n\n\tsetHeightState( event ) {\n\t\tconst { height } = event.nativeEvent.layout;\n\t\tthis.setState( { rootViewHeight: height }, sendNativeEditorDidLayout );\n\t}\n\n\trenderHTML() {\n\t\treturn <HTMLTextInput parentHeight={ this.state.rootViewHeight } />;\n\t}\n\n\trenderVisual() {\n\t\tconst { isReady } = this.props;\n\n\t\tif ( ! isReady ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn <VisualEditor setTitleRef={ this.props.setTitleRef } />;\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tgetStylesFromColorScheme,\n\t\t\tisTemplatePickerAvailable,\n\t\t\tisTemplatePickerVisible,\n\t\t\tmode,\n\t\t} = this.props;\n\n\t\tconst isHtmlView = mode === 'text';\n\n\t\t// add a margin view at the bottom for the header\n\t\tconst marginBottom =\n\t\t\tPlatform.OS === 'android' && ! isHtmlView\n\t\t\t\t? headerToolbarStyles.container.height\n\t\t\t\t: 0;\n\n\t\tconst toolbarKeyboardAvoidingViewStyle = {\n\t\t\t...styles.toolbarKeyboardAvoidingView,\n\t\t\tleft: this.state.safeAreaInsets.left,\n\t\t\tright: this.state.safeAreaInsets.right,\n\t\t\tbottom: this.state.safeAreaInsets.bottom,\n\t\t};\n\n\t\treturn (\n\t\t\t<SafeAreaView\n\t\t\t\tstyle={ getStylesFromColorScheme(\n\t\t\t\t\tstyles.container,\n\t\t\t\t\tstyles.containerDark\n\t\t\t\t) }\n\t\t\t\tonLayout={ this.onRootViewLayout }\n\t\t\t>\n\t\t\t\t<AutosaveMonitor />\n\t\t\t\t<View\n\t\t\t\t\tstyle={ getStylesFromColorScheme(\n\t\t\t\t\t\tstyles.background,\n\t\t\t\t\t\tstyles.backgroundDark\n\t\t\t\t\t) }\n\t\t\t\t>\n\t\t\t\t\t{ isHtmlView ? this.renderHTML() : this.renderVisual() }\n\t\t\t\t\t{ ! isHtmlView && Platform.OS === 'android' && (\n\t\t\t\t\t\t<FloatingToolbar />\n\t\t\t\t\t) }\n\t\t\t\t</View>\n\t\t\t\t<View\n\t\t\t\t\tstyle={ {\n\t\t\t\t\t\tflex: 0,\n\t\t\t\t\t\tflexBasis: marginBottom,\n\t\t\t\t\t\theight: marginBottom,\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t\t{ ! isHtmlView && (\n\t\t\t\t\t<KeyboardAvoidingView\n\t\t\t\t\t\tparentHeight={ this.state.rootViewHeight }\n\t\t\t\t\t\tstyle={ toolbarKeyboardAvoidingViewStyle }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ isTemplatePickerAvailable && (\n\t\t\t\t\t\t\t<__experimentalPageTemplatePicker\n\t\t\t\t\t\t\t\tvisible={ isTemplatePickerVisible }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ Platform.OS === 'ios' && <FloatingToolbar /> }\n\t\t\t\t\t\t<Header />\n\t\t\t\t\t\t<BottomSheetSettings />\n\t\t\t\t\t</KeyboardAvoidingView>\n\t\t\t\t) }\n\t\t\t</SafeAreaView>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { __unstableIsEditorReady: isEditorReady } = select(\n\t\t\t'core/editor'\n\t\t);\n\t\tconst { getEditorMode } = select( 'core/edit-post' );\n\n\t\treturn {\n\t\t\tisReady: isEditorReady(),\n\t\t\tmode: getEditorMode(),\n\t\t};\n\t} ),\n\twithPreferredColorScheme,\n\t__experimentalWithPageTemplatePicker,\n] )( Layout );\n"]}