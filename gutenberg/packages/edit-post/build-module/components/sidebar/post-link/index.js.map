{"version":3,"sources":["@wordpress/edit-post/src/components/sidebar/post-link/index.js"],"names":["get","__","PanelBody","TextControl","ExternalLink","withSelect","withDispatch","compose","ifCondition","withState","cleanForSlug","safeDecodeURIComponent","PANEL_NAME","PostLink","isOpened","onTogglePanel","isEditable","postLink","permalinkParts","editPermalink","forceEmptyField","setState","postSlug","postTypeLabel","prefix","suffix","prefixElement","postNameElement","suffixElement","newValue","event","target","value","select","isPermalinkEditable","getCurrentPost","isCurrentPostPublished","getPermalinkParts","getEditedPostAttribute","getEditedPostSlug","isEditorPanelEnabled","isEditorPanelOpened","getPostType","link","postTypeName","postType","isPublished","isEnabled","isViewable","dispatch","toggleEditorPanelOpened","editPost","newSlug","slug"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { get } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { PanelBody, TextControl, ExternalLink } from '@wordpress/components';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose, ifCondition, withState } from '@wordpress/compose';\nimport { cleanForSlug } from '@wordpress/editor';\nimport { safeDecodeURIComponent } from '@wordpress/url';\n\n/**\n * Module Constants\n */\nconst PANEL_NAME = 'post-link';\n\nfunction PostLink( {\n\tisOpened,\n\tonTogglePanel,\n\tisEditable,\n\tpostLink,\n\tpermalinkParts,\n\teditPermalink,\n\tforceEmptyField,\n\tsetState,\n\tpostSlug,\n\tpostTypeLabel,\n} ) {\n\tconst { prefix, suffix } = permalinkParts;\n\tlet prefixElement, postNameElement, suffixElement;\n\tif ( isEditable ) {\n\t\tprefixElement = prefix && (\n\t\t\t<span className=\"edit-post-post-link__link-prefix\">{ prefix }</span>\n\t\t);\n\t\tpostNameElement = postSlug && (\n\t\t\t<span className=\"edit-post-post-link__link-post-name\">\n\t\t\t\t{ postSlug }\n\t\t\t</span>\n\t\t);\n\t\tsuffixElement = suffix && (\n\t\t\t<span className=\"edit-post-post-link__link-suffix\">{ suffix }</span>\n\t\t);\n\t}\n\n\treturn (\n\t\t<PanelBody\n\t\t\ttitle={ __( 'Permalink' ) }\n\t\t\topened={ isOpened }\n\t\t\tonToggle={ onTogglePanel }\n\t\t>\n\t\t\t{ isEditable && (\n\t\t\t\t<div className=\"editor-post-link\">\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={ __( 'URL Slug' ) }\n\t\t\t\t\t\tvalue={ forceEmptyField ? '' : postSlug }\n\t\t\t\t\t\tonChange={ ( newValue ) => {\n\t\t\t\t\t\t\teditPermalink( newValue );\n\t\t\t\t\t\t\t// When we delete the field the permalink gets\n\t\t\t\t\t\t\t// reverted to the original value.\n\t\t\t\t\t\t\t// The forceEmptyField logic allows the user to have\n\t\t\t\t\t\t\t// the field temporarily empty while typing.\n\t\t\t\t\t\t\tif ( ! newValue ) {\n\t\t\t\t\t\t\t\tif ( ! forceEmptyField ) {\n\t\t\t\t\t\t\t\t\tsetState( {\n\t\t\t\t\t\t\t\t\t\tforceEmptyField: true,\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ( forceEmptyField ) {\n\t\t\t\t\t\t\t\tsetState( {\n\t\t\t\t\t\t\t\t\tforceEmptyField: false,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonBlur={ ( event ) => {\n\t\t\t\t\t\t\teditPermalink( cleanForSlug( event.target.value ) );\n\t\t\t\t\t\t\tif ( forceEmptyField ) {\n\t\t\t\t\t\t\t\tsetState( {\n\t\t\t\t\t\t\t\t\tforceEmptyField: false,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{ __( 'The last part of the URL.' ) }{ ' ' }\n\t\t\t\t\t\t<ExternalLink href=\"https://wordpress.org/support/article/writing-posts/#post-field-descriptions\">\n\t\t\t\t\t\t\t{ __( 'Read about permalinks' ) }\n\t\t\t\t\t\t</ExternalLink>\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t) }\n\t\t\t<h3 className=\"edit-post-post-link__preview-label\">\n\t\t\t\t{ postTypeLabel || __( 'View post' ) }\n\t\t\t</h3>\n\t\t\t<div className=\"edit-post-post-link__preview-link-container\">\n\t\t\t\t<ExternalLink\n\t\t\t\t\tclassName=\"edit-post-post-link__link\"\n\t\t\t\t\thref={ postLink }\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t>\n\t\t\t\t\t{ isEditable ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{ prefixElement }\n\t\t\t\t\t\t\t{ postNameElement }\n\t\t\t\t\t\t\t{ suffixElement }\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\tpostLink\n\t\t\t\t\t) }\n\t\t\t\t</ExternalLink>\n\t\t\t</div>\n\t\t</PanelBody>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tisPermalinkEditable,\n\t\t\tgetCurrentPost,\n\t\t\tisCurrentPostPublished,\n\t\t\tgetPermalinkParts,\n\t\t\tgetEditedPostAttribute,\n\t\t\tgetEditedPostSlug,\n\t\t} = select( 'core/editor' );\n\t\tconst { isEditorPanelEnabled, isEditorPanelOpened } = select(\n\t\t\t'core/edit-post'\n\t\t);\n\t\tconst { getPostType } = select( 'core' );\n\n\t\tconst { link } = getCurrentPost();\n\n\t\tconst postTypeName = getEditedPostAttribute( 'type' );\n\t\tconst postType = getPostType( postTypeName );\n\n\t\treturn {\n\t\t\tpostLink: link,\n\t\t\tisEditable: isPermalinkEditable(),\n\t\t\tisPublished: isCurrentPostPublished(),\n\t\t\tisOpened: isEditorPanelOpened( PANEL_NAME ),\n\t\t\tpermalinkParts: getPermalinkParts(),\n\t\t\tisEnabled: isEditorPanelEnabled( PANEL_NAME ),\n\t\t\tisViewable: get( postType, [ 'viewable' ], false ),\n\t\t\tpostSlug: safeDecodeURIComponent( getEditedPostSlug() ),\n\t\t\tpostTypeLabel: get( postType, [ 'labels', 'view_item' ] ),\n\t\t};\n\t} ),\n\tifCondition( ( { isEnabled, postLink, isViewable, permalinkParts } ) => {\n\t\treturn isEnabled && postLink && isViewable && permalinkParts;\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { toggleEditorPanelOpened } = dispatch( 'core/edit-post' );\n\t\tconst { editPost } = dispatch( 'core/editor' );\n\t\treturn {\n\t\t\tonTogglePanel: () => toggleEditorPanelOpened( PANEL_NAME ),\n\t\t\teditPermalink: ( newSlug ) => {\n\t\t\t\teditPost( { slug: newSlug } );\n\t\t\t},\n\t\t};\n\t} ),\n\twithState( {\n\t\tforceEmptyField: false,\n\t} ),\n] )( PostLink );\n"]}