{"version":3,"sources":["@wordpress/edit-post/src/components/header/post-publish-button-or-toggle.js"],"names":["PostPublishButtonOrToggle","forceIsDirty","forceIsSaving","hasPublishAction","isBeingScheduled","isPending","isPublished","isPublishSidebarEnabled","isPublishSidebarOpened","isScheduled","togglePublishSidebar","setEntitiesSavedStatesCallback","IS_TOGGLE","IS_BUTTON","isSmallerThanMediumViewport","component","select","getCurrentPost","isEditedPostBeingScheduled","isCurrentPostPending","isCurrentPostPublished","isCurrentPostScheduled","dispatch"],"mappings":";;;;;;;;;;AAGA;;AAKA;;AACA;;AACA;;AAVA;;;;AAKA;;;AAOO,SAASA,yBAAT,OAYH;AAAA,MAXHC,YAWG,QAXHA,YAWG;AAAA,MAVHC,aAUG,QAVHA,aAUG;AAAA,MATHC,gBASG,QATHA,gBASG;AAAA,MARHC,gBAQG,QARHA,gBAQG;AAAA,MAPHC,SAOG,QAPHA,SAOG;AAAA,MANHC,WAMG,QANHA,WAMG;AAAA,MALHC,uBAKG,QALHA,uBAKG;AAAA,MAJHC,sBAIG,QAJHA,sBAIG;AAAA,MAHHC,WAGG,QAHHA,WAGG;AAAA,MAFHC,oBAEG,QAFHA,oBAEG;AAAA,MADHC,8BACG,QADHA,8BACG;AACH,MAAMC,SAAS,GAAG,QAAlB;AACA,MAAMC,SAAS,GAAG,QAAlB;AACA,MAAMC,2BAA2B,GAAG,+BAAkB,QAAlB,EAA4B,GAA5B,CAApC;AACA,MAAIC,SAAJ;AAEA;;;;;;;;;;;;;;;;;;;;;;;AAsBA,MACCT,WAAW,IACTG,WAAW,IAAIL,gBADjB,IAEEC,SAAS,IAAI,CAAEF,gBAAf,IAAmC,CAAEW,2BAHxC,EAIE;AACDC,IAAAA,SAAS,GAAGF,SAAZ;AACA,GAND,MAMO,IAAKC,2BAAL,EAAmC;AACzCC,IAAAA,SAAS,GAAGH,SAAZ;AACA,GAFM,MAEA,IAAKL,uBAAL,EAA+B;AACrCQ,IAAAA,SAAS,GAAGH,SAAZ;AACA,GAFM,MAEA;AACNG,IAAAA,SAAS,GAAGF,SAAZ;AACA;;AAED,SACC,4BAAC,yBAAD;AACC,IAAA,YAAY,EAAGZ,YADhB;AAEC,IAAA,aAAa,EAAGC,aAFjB;AAGC,IAAA,MAAM,EAAGM,sBAHV;AAIC,IAAA,QAAQ,EAAGO,SAAS,KAAKH,SAJ1B;AAKC,IAAA,QAAQ,EAAGF,oBALZ;AAMC,IAAA,8BAA8B,EAAGC;AANlC,IADD;AAUA;;eAEc,sBACd,sBAAY,UAAEK,MAAF;AAAA,SAAgB;AAC3Bb,IAAAA,gBAAgB,EAAE,iBACjBa,MAAM,CAAE,aAAF,CAAN,CAAwBC,cAAxB,EADiB,EAEjB,CAAE,QAAF,EAAY,mBAAZ,CAFiB,EAGjB,KAHiB,CADS;AAM3Bb,IAAAA,gBAAgB,EAAEY,MAAM,CAAE,aAAF,CAAN,CAAwBE,0BAAxB,EANS;AAO3Bb,IAAAA,SAAS,EAAEW,MAAM,CAAE,aAAF,CAAN,CAAwBG,oBAAxB,EAPgB;AAQ3Bb,IAAAA,WAAW,EAAEU,MAAM,CAAE,aAAF,CAAN,CAAwBI,sBAAxB,EARc;AAS3Bb,IAAAA,uBAAuB,EAAES,MAAM,CAC9B,aAD8B,CAAN,CAEvBT,uBAFuB,EATE;AAY3BC,IAAAA,sBAAsB,EAAEQ,MAAM,CAC7B,gBAD6B,CAAN,CAEtBR,sBAFsB,EAZG;AAe3BC,IAAAA,WAAW,EAAEO,MAAM,CAAE,aAAF,CAAN,CAAwBK,sBAAxB;AAfc,GAAhB;AAAA,CAAZ,CADc,EAkBd,wBAAc,UAAEC,QAAF,EAAgB;AAAA,kBACIA,QAAQ,CAAE,gBAAF,CADZ;AAAA,MACrBZ,oBADqB,aACrBA,oBADqB;;AAE7B,SAAO;AACNA,IAAAA,oBAAoB,EAApBA;AADM,GAAP;AAGA,CALD,CAlBc,EAwBZV,yBAxBY,C","sourcesContent":["/**\n * External dependencies\n */\nimport { get } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useViewportMatch, compose } from '@wordpress/compose';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { PostPublishButton } from '@wordpress/editor';\n\nexport function PostPublishButtonOrToggle( {\n\tforceIsDirty,\n\tforceIsSaving,\n\thasPublishAction,\n\tisBeingScheduled,\n\tisPending,\n\tisPublished,\n\tisPublishSidebarEnabled,\n\tisPublishSidebarOpened,\n\tisScheduled,\n\ttogglePublishSidebar,\n\tsetEntitiesSavedStatesCallback,\n} ) {\n\tconst IS_TOGGLE = 'toggle';\n\tconst IS_BUTTON = 'button';\n\tconst isSmallerThanMediumViewport = useViewportMatch( 'medium', '<' );\n\tlet component;\n\n\t/**\n\t * Conditions to show a BUTTON (publish directly) or a TOGGLE (open publish sidebar):\n\t *\n\t * 1) We want to show a BUTTON when the post status is at the _final stage_\n\t * for a particular role (see https://wordpress.org/support/article/post-status/):\n\t *\n\t * - is published\n\t * - is scheduled to be published\n\t * - is pending and can't be published (but only for viewports >= medium).\n\t * \t Originally, we considered showing a button for pending posts that couldn't be published\n\t * \t (for example, for an author with the contributor role). Some languages can have\n\t * \t long translations for \"Submit for review\", so given the lack of UI real estate available\n\t * \t we decided to take into account the viewport in that case.\n\t *  \t See: https://github.com/WordPress/gutenberg/issues/10475\n\t *\n\t * 2) Then, in small viewports, we'll show a TOGGLE.\n\t *\n\t * 3) Finally, we'll use the publish sidebar status to decide:\n\t *\n\t * - if it is enabled, we show a TOGGLE\n\t * - if it is disabled, we show a BUTTON\n\t */\n\tif (\n\t\tisPublished ||\n\t\t( isScheduled && isBeingScheduled ) ||\n\t\t( isPending && ! hasPublishAction && ! isSmallerThanMediumViewport )\n\t) {\n\t\tcomponent = IS_BUTTON;\n\t} else if ( isSmallerThanMediumViewport ) {\n\t\tcomponent = IS_TOGGLE;\n\t} else if ( isPublishSidebarEnabled ) {\n\t\tcomponent = IS_TOGGLE;\n\t} else {\n\t\tcomponent = IS_BUTTON;\n\t}\n\n\treturn (\n\t\t<PostPublishButton\n\t\t\tforceIsDirty={ forceIsDirty }\n\t\t\tforceIsSaving={ forceIsSaving }\n\t\t\tisOpen={ isPublishSidebarOpened }\n\t\t\tisToggle={ component === IS_TOGGLE }\n\t\t\tonToggle={ togglePublishSidebar }\n\t\t\tsetEntitiesSavedStatesCallback={ setEntitiesSavedStatesCallback }\n\t\t/>\n\t);\n}\n\nexport default compose(\n\twithSelect( ( select ) => ( {\n\t\thasPublishAction: get(\n\t\t\tselect( 'core/editor' ).getCurrentPost(),\n\t\t\t[ '_links', 'wp:action-publish' ],\n\t\t\tfalse\n\t\t),\n\t\tisBeingScheduled: select( 'core/editor' ).isEditedPostBeingScheduled(),\n\t\tisPending: select( 'core/editor' ).isCurrentPostPending(),\n\t\tisPublished: select( 'core/editor' ).isCurrentPostPublished(),\n\t\tisPublishSidebarEnabled: select(\n\t\t\t'core/editor'\n\t\t).isPublishSidebarEnabled(),\n\t\tisPublishSidebarOpened: select(\n\t\t\t'core/edit-post'\n\t\t).isPublishSidebarOpened(),\n\t\tisScheduled: select( 'core/editor' ).isCurrentPostScheduled(),\n\t} ) ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { togglePublishSidebar } = dispatch( 'core/edit-post' );\n\t\treturn {\n\t\t\ttogglePublishSidebar,\n\t\t};\n\t} )\n)( PostPublishButtonOrToggle );\n"]}