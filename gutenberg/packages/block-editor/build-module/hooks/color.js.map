{"version":3,"sources":["@wordpress/block-editor/src/hooks/color.js"],"names":["classnames","isObject","addFilter","hasBlockSupport","getBlockSupport","__","useSelect","useRef","useEffect","Platform","getColorClassName","getColorObjectByColorValue","getColorObjectByAttributeValues","__experimentalGetGradientClass","getGradientValueBySlug","getGradientSlugByValue","cleanEmptyObject","ColorPanel","COLOR_SUPPORT_KEY","hasColorSupport","blockType","OS","hasGradientSupport","colorSupport","gradients","addAttributes","settings","attributes","backgroundColor","Object","assign","type","textColor","gradient","addSaveProps","props","hasGradient","style","backgroundClass","gradientClass","textClass","newClassName","className","color","text","background","undefined","addEditProps","existingGetEditWrapperProps","getEditWrapperProps","ColorEdit","blockName","name","select","getSettings","colors","localAttributes","current","gradientValue","onChangeColor","value","colorObject","attributeName","newStyle","slug","newNamedColor","newAttributes","setAttributes","onChangeGradient","clientId","label","onColorChange","colorValue","onGradientChange"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { isObject } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { addFilter } from '@wordpress/hooks';\nimport { hasBlockSupport, getBlockSupport } from '@wordpress/blocks';\nimport { __ } from '@wordpress/i18n';\nimport { useSelect } from '@wordpress/data';\nimport { useRef, useEffect, Platform } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport {\n\tgetColorClassName,\n\tgetColorObjectByColorValue,\n\tgetColorObjectByAttributeValues,\n} from '../components/colors';\nimport {\n\t__experimentalGetGradientClass,\n\tgetGradientValueBySlug,\n\tgetGradientSlugByValue,\n} from '../components/gradients';\nimport { cleanEmptyObject } from './utils';\nimport ColorPanel from './color-panel';\n\nexport const COLOR_SUPPORT_KEY = '__experimentalColor';\n\nconst hasColorSupport = ( blockType ) =>\n\tPlatform.OS === 'web' && hasBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\nconst hasGradientSupport = ( blockType ) => {\n\tif ( Platform.OS !== 'web' ) {\n\t\treturn false;\n\t}\n\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn isObject( colorSupport ) && !! colorSupport.gradients;\n};\n\n/**\n * Filters registered block settings, extending attributes to include\n * `backgroundColor` and `textColor` attribute.\n *\n * @param  {Object} settings Original block settings\n * @return {Object}          Filtered block settings\n */\nfunction addAttributes( settings ) {\n\tif ( ! hasColorSupport( settings ) ) {\n\t\treturn settings;\n\t}\n\n\t// allow blocks to specify their own attribute definition with default values if needed.\n\tif ( ! settings.attributes.backgroundColor ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\tbackgroundColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\tif ( ! settings.attributes.textColor ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\ttextColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\n\tif ( hasGradientSupport( settings ) && ! settings.attributes.gradient ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\tgradient: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\n\treturn settings;\n}\n\n/**\n * Override props assigned to save component to inject colors classnames.\n *\n * @param  {Object} props      Additional props applied to save element\n * @param  {Object} blockType  Block type\n * @param  {Object} attributes Block attributes\n * @return {Object}            Filtered props applied to save element\n */\nexport function addSaveProps( props, blockType, attributes ) {\n\tif ( ! hasColorSupport( blockType ) ) {\n\t\treturn props;\n\t}\n\n\tconst hasGradient = hasGradientSupport( blockType );\n\n\t// I'd have prefered to avoid the \"style\" attribute usage here\n\tconst { backgroundColor, textColor, gradient, style } = attributes;\n\n\tconst backgroundClass = getColorClassName(\n\t\t'background-color',\n\t\tbackgroundColor\n\t);\n\tconst gradientClass = __experimentalGetGradientClass( gradient );\n\tconst textClass = getColorClassName( 'color', textColor );\n\tconst newClassName = classnames(\n\t\tprops.className,\n\t\ttextClass,\n\t\tgradientClass,\n\t\t{\n\t\t\t// Don't apply the background class if there's a custom gradient\n\t\t\t[ backgroundClass ]:\n\t\t\t\t( ! hasGradient || ! style?.color?.gradient ) &&\n\t\t\t\t!! backgroundClass,\n\t\t\t'has-text-color': textColor || style?.color?.text,\n\t\t\t'has-background':\n\t\t\t\tbackgroundColor ||\n\t\t\t\tstyle?.color?.background ||\n\t\t\t\t( hasGradient && ( gradient || style?.color?.gradient ) ),\n\t\t}\n\t);\n\tprops.className = newClassName ? newClassName : undefined;\n\n\treturn props;\n}\n\n/**\n * Filters registered block settings to extand the block edit wrapper\n * to apply the desired styles and classnames properly.\n *\n * @param  {Object} settings Original block settings\n * @return {Object}          Filtered block settings\n */\nexport function addEditProps( settings ) {\n\tif ( ! hasColorSupport( settings ) ) {\n\t\treturn settings;\n\t}\n\tconst existingGetEditWrapperProps = settings.getEditWrapperProps;\n\tsettings.getEditWrapperProps = ( attributes ) => {\n\t\tlet props = {};\n\t\tif ( existingGetEditWrapperProps ) {\n\t\t\tprops = existingGetEditWrapperProps( attributes );\n\t\t}\n\t\treturn addSaveProps( props, settings, attributes );\n\t};\n\n\treturn settings;\n}\n\n/**\n * Inspector control panel containing the color related configuration\n *\n * @param {Object} props\n *\n * @return {WPElement} Color edit element.\n */\nexport function ColorEdit( props ) {\n\tconst { name: blockName, attributes } = props;\n\tconst { colors, gradients } = useSelect( ( select ) => {\n\t\treturn select( 'core/block-editor' ).getSettings();\n\t}, [] );\n\t// Shouldn't be needed but right now the ColorGradientsPanel\n\t// can trigger both onChangeColor and onChangeBackground\n\t// synchronously causing our two callbacks to override changes\n\t// from each other.\n\tconst localAttributes = useRef( attributes );\n\tuseEffect( () => {\n\t\tlocalAttributes.current = attributes;\n\t}, [ attributes ] );\n\n\tif ( ! hasColorSupport( blockName ) ) {\n\t\treturn null;\n\t}\n\n\tconst hasGradient = hasGradientSupport( blockName );\n\n\tconst { style, textColor, backgroundColor, gradient } = attributes;\n\tlet gradientValue;\n\tif ( hasGradient && gradient ) {\n\t\tgradientValue = getGradientValueBySlug( gradients, gradient );\n\t} else if ( hasGradient ) {\n\t\tgradientValue = style?.color?.gradient;\n\t}\n\n\tconst onChangeColor = ( name ) => ( value ) => {\n\t\tconst colorObject = getColorObjectByColorValue( colors, value );\n\t\tconst attributeName = name + 'Color';\n\t\tconst newStyle = {\n\t\t\t...localAttributes.current.style,\n\t\t\tcolor: {\n\t\t\t\t...localAttributes.current?.style?.color,\n\t\t\t\t[ name ]: colorObject?.slug ? undefined : value,\n\t\t\t},\n\t\t};\n\n\t\tconst newNamedColor = colorObject?.slug ? colorObject.slug : undefined;\n\t\tconst newAttributes = {\n\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t[ attributeName ]: newNamedColor,\n\t\t};\n\n\t\tprops.setAttributes( newAttributes );\n\t\tlocalAttributes.current = {\n\t\t\t...localAttributes.current,\n\t\t\t...newAttributes,\n\t\t};\n\t};\n\n\tconst onChangeGradient = ( value ) => {\n\t\tconst slug = getGradientSlugByValue( gradients, value );\n\t\tlet newAttributes;\n\t\tif ( slug ) {\n\t\t\tconst newStyle = {\n\t\t\t\t...localAttributes.current?.style,\n\t\t\t\tcolor: {\n\t\t\t\t\t...localAttributes.current?.style?.color,\n\t\t\t\t\tgradient: undefined,\n\t\t\t\t},\n\t\t\t};\n\t\t\tnewAttributes = {\n\t\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t\tgradient: slug,\n\t\t\t};\n\t\t} else {\n\t\t\tconst newStyle = {\n\t\t\t\t...localAttributes.current?.style,\n\t\t\t\tcolor: {\n\t\t\t\t\t...localAttributes.current?.style?.color,\n\t\t\t\t\tgradient: value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tnewAttributes = {\n\t\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t\tgradient: undefined,\n\t\t\t};\n\t\t}\n\t\tprops.setAttributes( newAttributes );\n\t\tlocalAttributes.current = {\n\t\t\t...localAttributes.current,\n\t\t\t...newAttributes,\n\t\t};\n\t};\n\n\treturn (\n\t\t<ColorPanel\n\t\t\tenableContrastChecking={\n\t\t\t\t// Turn on contrast checker for web only since it's not supported on mobile yet.\n\t\t\t\tPlatform.OS === 'web' && ! gradient && ! style?.color?.gradient\n\t\t\t}\n\t\t\tclientId={ props.clientId }\n\t\t\tsettings={ [\n\t\t\t\t{\n\t\t\t\t\tlabel: __( 'Text Color' ),\n\t\t\t\t\tonColorChange: onChangeColor( 'text' ),\n\t\t\t\t\tcolorValue: getColorObjectByAttributeValues(\n\t\t\t\t\t\tcolors,\n\t\t\t\t\t\ttextColor,\n\t\t\t\t\t\tstyle?.color?.text\n\t\t\t\t\t).color,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: __( 'Background Color' ),\n\t\t\t\t\tonColorChange: onChangeColor( 'background' ),\n\t\t\t\t\tcolorValue: getColorObjectByAttributeValues(\n\t\t\t\t\t\tcolors,\n\t\t\t\t\t\tbackgroundColor,\n\t\t\t\t\t\tstyle?.color?.background\n\t\t\t\t\t).color,\n\t\t\t\t\tgradientValue,\n\t\t\t\t\tonGradientChange: hasGradient\n\t\t\t\t\t\t? onChangeGradient\n\t\t\t\t\t\t: undefined,\n\t\t\t\t},\n\t\t\t] }\n\t\t/>\n\t);\n}\n\naddFilter(\n\t'blocks.registerBlockType',\n\t'core/color/addAttribute',\n\taddAttributes\n);\n\naddFilter(\n\t'blocks.getSaveContent.extraProps',\n\t'core/color/addSaveProps',\n\taddSaveProps\n);\n\naddFilter(\n\t'blocks.registerBlockType',\n\t'core/color/addEditProps',\n\taddEditProps\n);\n"]}