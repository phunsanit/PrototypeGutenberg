{"version":3,"sources":["@wordpress/block-editor/src/components/media-upload-progress/image-size.native.js"],"names":["Component","View","Image","calculatePreferedImageSize","image","container","maxWidth","clientWidth","exceedMaxWidth","width","ratio","height","ImageSize","arguments","state","undefined","onLayout","bind","prevProps","props","src","setState","fetchImageSize","dirtynessTrigger","calculateSize","getSize","event","nativeEvent","layout","clientHeight","sizes","imageWidth","imageHeight","containerWidth","containerHeight","imageWidthWithinContainer","imageHeightWithinContainer","children"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\n\n/**\n * External dependencies\n */\nimport { View, Image } from 'react-native';\n\n/**\n * Internal dependencies\n */\n\nfunction calculatePreferedImageSize( image, container ) {\n\tconst maxWidth = container.clientWidth;\n\tconst exceedMaxWidth = image.width > maxWidth;\n\tconst ratio = image.height / image.width;\n\tconst width = exceedMaxWidth ? maxWidth : image.width;\n\tconst height = exceedMaxWidth ? maxWidth * ratio : image.height;\n\treturn { width, height };\n}\n\nclass ImageSize extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\twidth: undefined,\n\t\t\theight: undefined,\n\t\t};\n\t\tthis.onLayout = this.onLayout.bind( this );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( this.props.src !== prevProps.src ) {\n\t\t\tthis.image = {};\n\n\t\t\tthis.setState( {\n\t\t\t\twidth: undefined,\n\t\t\t\theight: undefined,\n\t\t\t} );\n\t\t\tthis.fetchImageSize();\n\t\t}\n\n\t\tif ( this.props.dirtynessTrigger !== prevProps.dirtynessTrigger ) {\n\t\t\tthis.calculateSize();\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.fetchImageSize();\n\t}\n\n\tfetchImageSize() {\n\t\tImage.getSize( this.props.src, ( width, height ) => {\n\t\t\tthis.image = { width, height };\n\t\t\tthis.calculateSize();\n\t\t} );\n\t}\n\n\tcalculateSize() {\n\t\tif ( this.image === undefined || this.container === undefined ) {\n\t\t\treturn;\n\t\t}\n\t\tconst { width, height } = calculatePreferedImageSize(\n\t\t\tthis.image,\n\t\t\tthis.container\n\t\t);\n\t\tthis.setState( { width, height } );\n\t}\n\n\tonLayout( event ) {\n\t\tconst { width, height } = event.nativeEvent.layout;\n\t\tthis.container = {\n\t\t\tclientWidth: width,\n\t\t\tclientHeight: height,\n\t\t};\n\t\tthis.calculateSize();\n\t}\n\n\trender() {\n\t\tconst sizes = {\n\t\t\timageWidth: this.image && this.image.width,\n\t\t\timageHeight: this.image && this.image.height,\n\t\t\tcontainerWidth: this.container && this.container.width,\n\t\t\tcontainerHeight: this.container && this.container.height,\n\t\t\timageWidthWithinContainer: this.state.width,\n\t\t\timageHeightWithinContainer: this.state.height,\n\t\t};\n\t\treturn (\n\t\t\t<View onLayout={ this.onLayout }>\n\t\t\t\t{ this.props.children( sizes ) }\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nexport default ImageSize;\n"]}