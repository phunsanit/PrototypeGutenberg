{"version":3,"sources":["@wordpress/block-editor/src/components/block-styles/index.js"],"names":["find","noop","classnames","useMemo","useSelect","useDispatch","TokenList","ENTER","SPACE","_x","getBlockType","cloneBlock","getBlockFromExample","BlockPreview","getActiveStyle","styles","className","values","style","indexOf","potentialStyleName","substring","activeStyle","name","replaceActiveStyle","newStyle","list","remove","isDefault","add","value","useGenericPreviewBlock","block","type","example","attributes","innerBlocks","BlockStyles","clientId","onSwitch","onHoverClassName","selector","select","getBlock","getBlockStyles","blockType","updateBlockAttributes","genericPreviewBlock","length","unshift","label","map","styleClassName","BlockStyleItem","isActive","onBlur","onHover","onSelect","previewBlocks","event","keyCode","preventDefault"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { find, noop } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useMemo } from '@wordpress/element';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport TokenList from '@wordpress/token-list';\nimport { ENTER, SPACE } from '@wordpress/keycodes';\nimport { _x } from '@wordpress/i18n';\nimport {\n\tgetBlockType,\n\tcloneBlock,\n\tgetBlockFromExample,\n} from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport BlockPreview from '../block-preview';\n\n/**\n * Returns the active style from the given className.\n *\n * @param {Array} styles Block style variations.\n * @param {string} className  Class name\n *\n * @return {Object?} The active style.\n */\nexport function getActiveStyle( styles, className ) {\n\tfor ( const style of new TokenList( className ).values() ) {\n\t\tif ( style.indexOf( 'is-style-' ) === -1 ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst potentialStyleName = style.substring( 9 );\n\t\tconst activeStyle = find( styles, { name: potentialStyleName } );\n\t\tif ( activeStyle ) {\n\t\t\treturn activeStyle;\n\t\t}\n\t}\n\n\treturn find( styles, 'isDefault' );\n}\n\n/**\n * Replaces the active style in the block's className.\n *\n * @param {string}  className   Class name.\n * @param {Object?} activeStyle The replaced style.\n * @param {Object}  newStyle    The replacing style.\n *\n * @return {string} The updated className.\n */\nexport function replaceActiveStyle( className, activeStyle, newStyle ) {\n\tconst list = new TokenList( className );\n\n\tif ( activeStyle ) {\n\t\tlist.remove( 'is-style-' + activeStyle.name );\n\t}\n\n\tif ( ! newStyle.isDefault ) {\n\t\tlist.add( 'is-style-' + newStyle.name );\n\t}\n\n\treturn list.value;\n}\n\nconst useGenericPreviewBlock = ( block, type ) =>\n\tuseMemo(\n\t\t() =>\n\t\t\ttype.example\n\t\t\t\t? getBlockFromExample( block.name, {\n\t\t\t\t\t\tattributes: type.example.attributes,\n\t\t\t\t\t\tinnerBlocks: type.example.innerBlocks,\n\t\t\t\t  } )\n\t\t\t\t: cloneBlock( block ),\n\t\t[ type.example ? block.name : block, type ]\n\t);\n\nfunction BlockStyles( { clientId, onSwitch = noop, onHoverClassName = noop } ) {\n\tconst selector = ( select ) => {\n\t\tconst { getBlock } = select( 'core/block-editor' );\n\t\tconst { getBlockStyles } = select( 'core/blocks' );\n\t\tconst block = getBlock( clientId );\n\t\tconst blockType = getBlockType( block.name );\n\t\treturn {\n\t\t\tblock,\n\t\t\ttype: blockType,\n\t\t\tstyles: getBlockStyles( block.name ),\n\t\t\tclassName: block.attributes.className || '',\n\t\t};\n\t};\n\n\tconst { styles, block, type, className } = useSelect( selector, [\n\t\tclientId,\n\t] );\n\n\tconst { updateBlockAttributes } = useDispatch( 'core/block-editor' );\n\tconst genericPreviewBlock = useGenericPreviewBlock( block, type );\n\n\tif ( ! styles || styles.length === 0 ) {\n\t\treturn null;\n\t}\n\n\tif ( ! type.styles && ! find( styles, 'isDefault' ) ) {\n\t\tstyles.unshift( {\n\t\t\tname: 'default',\n\t\t\tlabel: _x( 'Default', 'block style' ),\n\t\t\tisDefault: true,\n\t\t} );\n\t}\n\n\tconst activeStyle = getActiveStyle( styles, className );\n\treturn (\n\t\t<div className=\"block-editor-block-styles\">\n\t\t\t{ styles.map( ( style ) => {\n\t\t\t\tconst styleClassName = replaceActiveStyle(\n\t\t\t\t\tclassName,\n\t\t\t\t\tactiveStyle,\n\t\t\t\t\tstyle\n\t\t\t\t);\n\t\t\t\treturn (\n\t\t\t\t\t<BlockStyleItem\n\t\t\t\t\t\tgenericPreviewBlock={ genericPreviewBlock }\n\t\t\t\t\t\tclassName={ className }\n\t\t\t\t\t\tisActive={ activeStyle === style }\n\t\t\t\t\t\tkey={ style.name }\n\t\t\t\t\t\tonSelect={ () => {\n\t\t\t\t\t\t\tupdateBlockAttributes( clientId, {\n\t\t\t\t\t\t\t\tclassName: styleClassName,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tonHoverClassName( null );\n\t\t\t\t\t\t\tonSwitch();\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonBlur={ () => onHoverClassName( null ) }\n\t\t\t\t\t\tonHover={ () => onHoverClassName( styleClassName ) }\n\t\t\t\t\t\tstyle={ style }\n\t\t\t\t\t\tstyleClassName={ styleClassName }\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t} ) }\n\t\t</div>\n\t);\n}\n\nfunction BlockStyleItem( {\n\tgenericPreviewBlock,\n\tstyle,\n\tisActive,\n\tonBlur,\n\tonHover,\n\tonSelect,\n\tstyleClassName,\n} ) {\n\tconst previewBlocks = useMemo( () => {\n\t\treturn {\n\t\t\t...genericPreviewBlock,\n\t\t\tattributes: {\n\t\t\t\t...genericPreviewBlock.attributes,\n\t\t\t\tclassName: styleClassName,\n\t\t\t},\n\t\t};\n\t}, [ genericPreviewBlock, styleClassName ] );\n\n\treturn (\n\t\t<div\n\t\t\tkey={ style.name }\n\t\t\tclassName={ classnames( 'block-editor-block-styles__item', {\n\t\t\t\t'is-active': isActive,\n\t\t\t} ) }\n\t\t\tonClick={ () => onSelect() }\n\t\t\tonKeyDown={ ( event ) => {\n\t\t\t\tif ( ENTER === event.keyCode || SPACE === event.keyCode ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tonSelect();\n\t\t\t\t}\n\t\t\t} }\n\t\t\tonMouseEnter={ onHover }\n\t\t\tonMouseLeave={ onBlur }\n\t\t\trole=\"button\"\n\t\t\ttabIndex=\"0\"\n\t\t\taria-label={ style.label || style.name }\n\t\t>\n\t\t\t<div className=\"block-editor-block-styles__item-preview\">\n\t\t\t\t<BlockPreview viewportWidth={ 500 } blocks={ previewBlocks } />\n\t\t\t</div>\n\t\t\t<div className=\"block-editor-block-styles__item-label\">\n\t\t\t\t{ style.label || style.name }\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default BlockStyles;\n"]}