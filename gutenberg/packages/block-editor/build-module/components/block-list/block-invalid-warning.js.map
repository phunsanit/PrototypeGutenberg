{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/block-invalid-warning.js"],"names":["__","_x","Button","Modal","Component","getBlockType","createBlock","rawHandler","compose","withDispatch","withSelect","Warning","BlockCompare","BlockInvalidWarning","props","state","compare","onCompare","bind","onCompareClose","setState","convertToHTML","convertToBlocks","convertToClassic","attemptBlockRecovery","block","hasHTMLBlock","hiddenActions","title","onClick","blockToBlocks","blockToClassic","content","originalContent","blockToHTML","HTML","recoverBlock","name","attributes","innerBlocks","select","clientId","getBlock","dispatch","replaceBlock"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __, _x } from '@wordpress/i18n';\nimport { Button, Modal } from '@wordpress/components';\nimport { Component } from '@wordpress/element';\nimport { getBlockType, createBlock, rawHandler } from '@wordpress/blocks';\nimport { compose } from '@wordpress/compose';\nimport { withDispatch, withSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport Warning from '../warning';\nimport BlockCompare from '../block-compare';\n\nexport class BlockInvalidWarning extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.state = { compare: false };\n\t\tthis.onCompare = this.onCompare.bind( this );\n\t\tthis.onCompareClose = this.onCompareClose.bind( this );\n\t}\n\n\tonCompare() {\n\t\tthis.setState( { compare: true } );\n\t}\n\n\tonCompareClose() {\n\t\tthis.setState( { compare: false } );\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tconvertToHTML,\n\t\t\tconvertToBlocks,\n\t\t\tconvertToClassic,\n\t\t\tattemptBlockRecovery,\n\t\t\tblock,\n\t\t} = this.props;\n\t\tconst hasHTMLBlock = !! getBlockType( 'core/html' );\n\t\tconst { compare } = this.state;\n\t\tconst hiddenActions = [\n\t\t\t{\n\t\t\t\ttitle: __( 'Convert to Classic Block' ),\n\t\t\t\tonClick: convertToClassic,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: __( 'Attempt Block Recovery' ),\n\t\t\t\tonClick: attemptBlockRecovery,\n\t\t\t},\n\t\t];\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Warning\n\t\t\t\t\tactions={ [\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tkey=\"convert\"\n\t\t\t\t\t\t\tonClick={ this.onCompare }\n\t\t\t\t\t\t\tisSecondary={ hasHTMLBlock }\n\t\t\t\t\t\t\tisPrimary={ ! hasHTMLBlock }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ // translators: Button to fix block content\n\t\t\t\t\t\t\t_x( 'Resolve', 'imperative verb' ) }\n\t\t\t\t\t\t</Button>,\n\t\t\t\t\t\thasHTMLBlock && (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tkey=\"edit\"\n\t\t\t\t\t\t\t\tonClick={ convertToHTML }\n\t\t\t\t\t\t\t\tisPrimary\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'Convert to HTML' ) }\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t),\n\t\t\t\t\t] }\n\t\t\t\t\tsecondaryActions={ hiddenActions }\n\t\t\t\t>\n\t\t\t\t\t{ __(\n\t\t\t\t\t\t'This block contains unexpected or invalid content.'\n\t\t\t\t\t) }\n\t\t\t\t</Warning>\n\t\t\t\t{ compare && (\n\t\t\t\t\t<Modal\n\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t// translators: Dialog title to fix block content\n\t\t\t\t\t\t\t__( 'Resolve Block' )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonRequestClose={ this.onCompareClose }\n\t\t\t\t\t\tclassName=\"block-editor-block-compare\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<BlockCompare\n\t\t\t\t\t\t\tblock={ block }\n\t\t\t\t\t\t\tonKeep={ convertToHTML }\n\t\t\t\t\t\t\tonConvert={ convertToBlocks }\n\t\t\t\t\t\t\tconvertor={ blockToBlocks }\n\t\t\t\t\t\t\tconvertButtonText={ __( 'Convert to Blocks' ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Modal>\n\t\t\t\t) }\n\t\t\t</>\n\t\t);\n\t}\n}\n\nconst blockToClassic = ( block ) =>\n\tcreateBlock( 'core/freeform', {\n\t\tcontent: block.originalContent,\n\t} );\nconst blockToHTML = ( block ) =>\n\tcreateBlock( 'core/html', {\n\t\tcontent: block.originalContent,\n\t} );\nconst blockToBlocks = ( block ) =>\n\trawHandler( {\n\t\tHTML: block.originalContent,\n\t} );\nconst recoverBlock = ( { name, attributes, innerBlocks } ) =>\n\tcreateBlock( name, attributes, innerBlocks );\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => ( {\n\t\tblock: select( 'core/block-editor' ).getBlock( clientId ),\n\t} ) ),\n\twithDispatch( ( dispatch, { block } ) => {\n\t\tconst { replaceBlock } = dispatch( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tconvertToClassic() {\n\t\t\t\treplaceBlock( block.clientId, blockToClassic( block ) );\n\t\t\t},\n\t\t\tconvertToHTML() {\n\t\t\t\treplaceBlock( block.clientId, blockToHTML( block ) );\n\t\t\t},\n\t\t\tconvertToBlocks() {\n\t\t\t\treplaceBlock( block.clientId, blockToBlocks( block ) );\n\t\t\t},\n\t\t\tattemptBlockRecovery() {\n\t\t\t\treplaceBlock( block.clientId, recoverBlock( block ) );\n\t\t\t},\n\t\t};\n\t} ),\n] )( BlockInvalidWarning );\n"]}