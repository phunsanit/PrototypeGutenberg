{"version":3,"sources":["@wordpress/block-editor/src/components/inserter/block-list.js"],"names":["map","includes","findIndex","flow","sortBy","groupBy","isEmpty","__","_x","_n","sprintf","withSpokenMessages","addQueryArgs","controlsRepeat","speak","createBlock","useMemo","useEffect","useSelect","compose","BlockTypesList","ChildBlocks","__experimentalInserterMenuExtension","searchBlockItems","InserterPanel","InserterNoResults","createBlocksFromInnerBlocksTemplate","innerBlocksTemplate","name","attributes","innerBlocks","getBlockNamespace","item","split","MAX_SUGGESTED_ITEMS","InserterBlockList","rootClientId","onInsert","onHover","selectBlockOnInsert","__experimentalSelectBlockOnInsert","filterValue","debouncedSpeak","select","getInserterItems","getBlockName","getSettings","getCategories","getCollections","getChildBlockNames","rootBlockName","__experimentalFetchReusableBlocks","categories","collections","rootChildBlocks","items","fetchReusableBlocks","onSelectItem","title","initialAttributes","insertedBlock","message","filteredItems","childItems","filter","suggestedItems","slice","reusableItems","category","uncategorizedItems","itemsPerCategory","getCategoryIndex","slug","itemList","itemsPerCollection","result","Object","keys","forEach","namespace","length","resultsFoundMessage","hasItems","hasChildItems","categoryItems","icon","collection","collectionItems","post_type","onSelect","fills"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tmap,\n\tincludes,\n\tfindIndex,\n\tflow,\n\tsortBy,\n\tgroupBy,\n\tisEmpty,\n} from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __, _x, _n, sprintf } from '@wordpress/i18n';\nimport { withSpokenMessages } from '@wordpress/components';\nimport { addQueryArgs } from '@wordpress/url';\nimport { controlsRepeat } from '@wordpress/icons';\nimport { speak } from '@wordpress/a11y';\nimport { createBlock } from '@wordpress/blocks';\nimport { useMemo, useEffect } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport BlockTypesList from '../block-types-list';\nimport ChildBlocks from './child-blocks';\nimport __experimentalInserterMenuExtension from '../inserter-menu-extension';\nimport { searchBlockItems } from './search-items';\nimport InserterPanel from './panel';\nimport InserterNoResults from './no-results';\n\n// Copied over from the Columns block. It seems like it should become part of public API.\nconst createBlocksFromInnerBlocksTemplate = ( innerBlocksTemplate ) => {\n\treturn map(\n\t\tinnerBlocksTemplate,\n\t\t( [ name, attributes, innerBlocks = [] ] ) =>\n\t\t\tcreateBlock(\n\t\t\t\tname,\n\t\t\t\tattributes,\n\t\t\t\tcreateBlocksFromInnerBlocksTemplate( innerBlocks )\n\t\t\t)\n\t);\n};\n\nconst getBlockNamespace = ( item ) => item.name.split( '/' )[ 0 ];\n\nconst MAX_SUGGESTED_ITEMS = 6;\n\nexport function InserterBlockList( {\n\trootClientId,\n\tonInsert,\n\tonHover,\n\t__experimentalSelectBlockOnInsert: selectBlockOnInsert,\n\tfilterValue,\n\tdebouncedSpeak,\n} ) {\n\tconst {\n\t\tcategories,\n\t\tcollections,\n\t\titems,\n\t\trootChildBlocks,\n\t\tfetchReusableBlocks,\n\t} = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getInserterItems, getBlockName, getSettings } = select(\n\t\t\t\t'core/block-editor'\n\t\t\t);\n\t\t\tconst {\n\t\t\t\tgetCategories,\n\t\t\t\tgetCollections,\n\t\t\t\tgetChildBlockNames,\n\t\t\t} = select( 'core/blocks' );\n\t\t\tconst rootBlockName = getBlockName( rootClientId );\n\t\t\tconst { __experimentalFetchReusableBlocks } = getSettings();\n\n\t\t\treturn {\n\t\t\t\tcategories: getCategories(),\n\t\t\t\tcollections: getCollections(),\n\t\t\t\trootChildBlocks: getChildBlockNames( rootBlockName ),\n\t\t\t\titems: getInserterItems( rootClientId ),\n\t\t\t\tfetchReusableBlocks: __experimentalFetchReusableBlocks,\n\t\t\t};\n\t\t},\n\t\t[ rootClientId ]\n\t);\n\n\t// Fetch resuable blocks on mount\n\tuseEffect( () => {\n\t\tif ( fetchReusableBlocks ) {\n\t\t\tfetchReusableBlocks();\n\t\t}\n\t}, [] );\n\n\tconst onSelectItem = ( item ) => {\n\t\tconst { name, title, initialAttributes, innerBlocks } = item;\n\t\tconst insertedBlock = createBlock(\n\t\t\tname,\n\t\t\tinitialAttributes,\n\t\t\tcreateBlocksFromInnerBlocksTemplate( innerBlocks )\n\t\t);\n\n\t\tonInsert( insertedBlock );\n\n\t\tif ( ! selectBlockOnInsert ) {\n\t\t\t// translators: %s: the name of the block that has been added\n\t\t\tconst message = sprintf( __( '%s block added' ), title );\n\t\t\tspeak( message );\n\t\t}\n\t};\n\n\tconst filteredItems = useMemo( () => {\n\t\treturn searchBlockItems( items, categories, collections, filterValue );\n\t}, [ filterValue, items, categories, collections ] );\n\n\tconst childItems = useMemo( () => {\n\t\treturn filteredItems.filter( ( { name } ) =>\n\t\t\tincludes( rootChildBlocks, name )\n\t\t);\n\t}, [ filteredItems, rootChildBlocks ] );\n\n\tconst suggestedItems = useMemo( () => {\n\t\treturn items.slice( 0, MAX_SUGGESTED_ITEMS );\n\t}, [ items ] );\n\n\tconst reusableItems = useMemo( () => {\n\t\treturn filteredItems.filter(\n\t\t\t( { category } ) => category === 'reusable'\n\t\t);\n\t}, [ filteredItems ] );\n\n\tconst uncategorizedItems = useMemo( () => {\n\t\treturn filteredItems.filter( ( item ) => ! item.category );\n\t}, [ filteredItems ] );\n\n\tconst itemsPerCategory = useMemo( () => {\n\t\tconst getCategoryIndex = ( item ) => {\n\t\t\treturn findIndex(\n\t\t\t\tcategories,\n\t\t\t\t( category ) => category.slug === item.category\n\t\t\t);\n\t\t};\n\n\t\treturn flow(\n\t\t\t( itemList ) =>\n\t\t\t\titemList.filter(\n\t\t\t\t\t( item ) => item.category && item.category !== 'reusable'\n\t\t\t\t),\n\t\t\t( itemList ) => sortBy( itemList, getCategoryIndex ),\n\t\t\t( itemList ) => groupBy( itemList, 'category' )\n\t\t)( filteredItems );\n\t}, [ filteredItems, categories ] );\n\n\tconst itemsPerCollection = useMemo( () => {\n\t\t// Create a new Object to avoid mutating collection\n\t\tconst result = { ...collections };\n\t\tObject.keys( collections ).forEach( ( namespace ) => {\n\t\t\tresult[ namespace ] = filteredItems.filter(\n\t\t\t\t( item ) => getBlockNamespace( item ) === namespace\n\t\t\t);\n\t\t\tif ( result[ namespace ].length === 0 ) {\n\t\t\t\tdelete result[ namespace ];\n\t\t\t}\n\t\t} );\n\n\t\treturn result;\n\t}, [ filteredItems, collections ] );\n\n\t// Announce search results on change\n\tuseEffect( () => {\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t/* translators: %d: number of results. */\n\t\t\t_n( '%d result found.', '%d results found.', filteredItems.length ),\n\t\t\tfilteredItems.length\n\t\t);\n\t\tdebouncedSpeak( resultsFoundMessage );\n\t}, [ filterValue, debouncedSpeak ] );\n\n\tconst hasItems = ! isEmpty( filteredItems );\n\tconst hasChildItems = childItems.length > 0;\n\n\treturn (\n\t\t<div>\n\t\t\t<ChildBlocks\n\t\t\t\trootClientId={ rootClientId }\n\t\t\t\titems={ childItems }\n\t\t\t\tonSelect={ onSelectItem }\n\t\t\t\tonHover={ onHover }\n\t\t\t/>\n\n\t\t\t{ ! hasChildItems && !! suggestedItems.length && ! filterValue && (\n\t\t\t\t<InserterPanel title={ _x( 'Most used', 'blocks' ) }>\n\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\titems={ suggestedItems }\n\t\t\t\t\t\tonSelect={ onSelectItem }\n\t\t\t\t\t\tonHover={ onHover }\n\t\t\t\t\t/>\n\t\t\t\t</InserterPanel>\n\t\t\t) }\n\n\t\t\t{ ! hasChildItems &&\n\t\t\t\tmap( categories, ( category ) => {\n\t\t\t\t\tconst categoryItems = itemsPerCategory[ category.slug ];\n\t\t\t\t\tif ( ! categoryItems || ! categoryItems.length ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<InserterPanel\n\t\t\t\t\t\t\tkey={ category.slug }\n\t\t\t\t\t\t\ttitle={ category.title }\n\t\t\t\t\t\t\ticon={ category.icon }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\t\t\titems={ categoryItems }\n\t\t\t\t\t\t\t\tonSelect={ onSelectItem }\n\t\t\t\t\t\t\t\tonHover={ onHover }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</InserterPanel>\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\n\t\t\t{ ! hasChildItems && !! uncategorizedItems.length && (\n\t\t\t\t<InserterPanel\n\t\t\t\t\tclassName=\"block-editor-inserter__uncategorized-blocks-panel\"\n\t\t\t\t\ttitle={ __( 'Uncategorized' ) }\n\t\t\t\t>\n\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\titems={ uncategorizedItems }\n\t\t\t\t\t\tonSelect={ onSelectItem }\n\t\t\t\t\t\tonHover={ onHover }\n\t\t\t\t\t/>\n\t\t\t\t</InserterPanel>\n\t\t\t) }\n\n\t\t\t{ ! hasChildItems &&\n\t\t\t\tmap( collections, ( collection, namespace ) => {\n\t\t\t\t\tconst collectionItems = itemsPerCollection[ namespace ];\n\t\t\t\t\tif ( ! collectionItems || ! collectionItems.length ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<InserterPanel\n\t\t\t\t\t\t\tkey={ namespace }\n\t\t\t\t\t\t\ttitle={ collection.title }\n\t\t\t\t\t\t\ticon={ collection.icon }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\t\t\titems={ collectionItems }\n\t\t\t\t\t\t\t\tonSelect={ onSelectItem }\n\t\t\t\t\t\t\t\tonHover={ onHover }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</InserterPanel>\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\n\t\t\t{ ! hasChildItems && !! reusableItems.length && (\n\t\t\t\t<InserterPanel\n\t\t\t\t\tclassName=\"block-editor-inserter__reusable-blocks-panel\"\n\t\t\t\t\ttitle={ __( 'Reusable' ) }\n\t\t\t\t\ticon={ controlsRepeat }\n\t\t\t\t>\n\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\titems={ reusableItems }\n\t\t\t\t\t\tonSelect={ onSelectItem }\n\t\t\t\t\t\tonHover={ onHover }\n\t\t\t\t\t/>\n\t\t\t\t\t<a\n\t\t\t\t\t\tclassName=\"block-editor-inserter__manage-reusable-blocks\"\n\t\t\t\t\t\thref={ addQueryArgs( 'edit.php', {\n\t\t\t\t\t\t\tpost_type: 'wp_block',\n\t\t\t\t\t\t} ) }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Manage all reusable blocks' ) }\n\t\t\t\t\t</a>\n\t\t\t\t</InserterPanel>\n\t\t\t) }\n\n\t\t\t<__experimentalInserterMenuExtension.Slot\n\t\t\t\tfillProps={ {\n\t\t\t\t\tonSelect: onSelectItem,\n\t\t\t\t\tonHover,\n\t\t\t\t\tfilterValue,\n\t\t\t\t\thasItems,\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t{ ( fills ) => {\n\t\t\t\t\tif ( fills.length ) {\n\t\t\t\t\t\treturn fills;\n\t\t\t\t\t}\n\t\t\t\t\tif ( ! hasItems ) {\n\t\t\t\t\t\treturn <InserterNoResults />;\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t} }\n\t\t\t</__experimentalInserterMenuExtension.Slot>\n\t\t</div>\n\t);\n}\n\nexport default compose( withSpokenMessages )( InserterBlockList );\n"]}