{"version":3,"sources":["@wordpress/block-editor/src/components/block-mover/index.js"],"names":["first","last","castArray","classnames","ToolbarGroup","__experimentalToolbarItem","ToolbarItem","getBlockType","Component","withSelect","BlockDraggable","BlockMoverUpButton","BlockMoverDownButton","BlockMover","arguments","state","isFocused","onFocus","bind","onBlur","setState","props","isFirst","isLast","clientIds","isLocked","isHidden","rootClientId","hideDragHandle","orientation","__experimentalOrientation","isDraggable","onDraggableStart","onDraggableEnd","itemProps","select","getBlock","getBlockIndex","getTemplateLock","getBlockOrder","getBlockRootClientId","normalizedClientIds","firstClientId","block","firstIndex","lastIndex","blockOrder","length","blockType","name"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { first, last, castArray } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tToolbarGroup,\n\t__experimentalToolbarItem as ToolbarItem,\n} from '@wordpress/components';\nimport { getBlockType } from '@wordpress/blocks';\nimport { Component } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport BlockDraggable from '../block-draggable';\nimport { BlockMoverUpButton, BlockMoverDownButton } from './button';\n\nexport class BlockMover extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tisFocused: false,\n\t\t};\n\t\tthis.onFocus = this.onFocus.bind( this );\n\t\tthis.onBlur = this.onBlur.bind( this );\n\t}\n\n\tonFocus() {\n\t\tthis.setState( {\n\t\t\tisFocused: true,\n\t\t} );\n\t}\n\n\tonBlur() {\n\t\tthis.setState( {\n\t\t\tisFocused: false,\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tisFirst,\n\t\t\tisLast,\n\t\t\tclientIds,\n\t\t\tisLocked,\n\t\t\tisHidden,\n\t\t\trootClientId,\n\t\t\thideDragHandle,\n\t\t\t__experimentalOrientation: orientation,\n\t\t} = this.props;\n\t\tconst { isFocused } = this.state;\n\t\tif ( isLocked || ( isFirst && isLast && ! rootClientId ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// We emulate a disabled state because forcefully applying the `disabled`\n\t\t// attribute on the buttons while it has focus causes the screen to change\n\t\t// to an unfocused state (body as active element) without firing blur on,\n\t\t// the rendering parent, leaving it unable to react to focus out.\n\t\treturn (\n\t\t\t<BlockDraggable clientIds={ clientIds }>\n\t\t\t\t{ ( { isDraggable, onDraggableStart, onDraggableEnd } ) => (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={ classnames( 'block-editor-block-mover', {\n\t\t\t\t\t\t\t'is-visible': isFocused || ! isHidden,\n\t\t\t\t\t\t\t'is-horizontal': orientation === 'horizontal',\n\t\t\t\t\t\t} ) }\n\t\t\t\t\t\tdraggable={ isDraggable && ! hideDragHandle }\n\t\t\t\t\t\tonDragStart={ onDraggableStart }\n\t\t\t\t\t\tonDragEnd={ onDraggableEnd }\n\t\t\t\t\t>\n\t\t\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\t\t\t\tonBlur={ this.onBlur }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ ( itemProps ) => (\n\t\t\t\t\t\t\t\t\t<BlockMoverUpButton\n\t\t\t\t\t\t\t\t\t\tclientIds={ clientIds }\n\t\t\t\t\t\t\t\t\t\t{ ...itemProps }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</ToolbarItem>\n\t\t\t\t\t\t\t<ToolbarItem\n\t\t\t\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\t\t\t\tonBlur={ this.onBlur }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ ( itemProps ) => (\n\t\t\t\t\t\t\t\t\t<BlockMoverDownButton\n\t\t\t\t\t\t\t\t\t\tclientIds={ clientIds }\n\t\t\t\t\t\t\t\t\t\t{ ...itemProps }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</ToolbarItem>\n\t\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t</BlockDraggable>\n\t\t);\n\t}\n}\n\nexport default withSelect( ( select, { clientIds } ) => {\n\tconst {\n\t\tgetBlock,\n\t\tgetBlockIndex,\n\t\tgetTemplateLock,\n\t\tgetBlockOrder,\n\t\tgetBlockRootClientId,\n\t} = select( 'core/block-editor' );\n\tconst normalizedClientIds = castArray( clientIds );\n\tconst firstClientId = first( normalizedClientIds );\n\tconst block = getBlock( firstClientId );\n\tconst rootClientId = getBlockRootClientId( first( normalizedClientIds ) );\n\tconst firstIndex = getBlockIndex( firstClientId, rootClientId );\n\tconst lastIndex = getBlockIndex(\n\t\tlast( normalizedClientIds ),\n\t\trootClientId\n\t);\n\tconst blockOrder = getBlockOrder( rootClientId );\n\tconst isFirst = firstIndex === 0;\n\tconst isLast = lastIndex === blockOrder.length - 1;\n\n\treturn {\n\t\tblockType: block ? getBlockType( block.name ) : null,\n\t\tisLocked: getTemplateLock( rootClientId ) === 'all',\n\t\trootClientId,\n\t\tfirstIndex,\n\t\tisFirst,\n\t\tisLast,\n\t};\n} )( BlockMover );\n"]}