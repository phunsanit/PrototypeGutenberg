{"version":3,"sources":["@wordpress/block-editor/src/components/block-mobile-toolbar/block-actions-menu.native.js"],"names":["Platform","findNodeHandle","partial","first","castArray","last","compact","ToolbarButton","Picker","getBlockType","getDefaultBlockName","__","sprintf","withDispatch","withSelect","withInstanceId","compose","moreHorizontalMobile","trash","cog","useRef","getMoversSetup","BlockActionsMenu","onDelete","isStackedHorizontally","wrapBlockSettings","wrapBlockMover","openGeneralSidebar","onMoveDown","onMoveUp","isFirst","isLast","blockTitle","isEmptyDefaultBlock","anchorNodeRef","pickerRef","moversOptions","keys","icon","backwardButtonIcon","backward","forwardButtonIcon","forward","actionTitle","backwardButtonTitle","forwardButtonTitle","deleteOption","id","label","value","separated","disabled","settingsOption","backwardButtonOption","forwardButtonOption","options","onPickerSelect","onPickerPresent","current","presentPicker","disabledButtonIndices","map","option","index","filter","Boolean","accessibilityHint","OS","hint","length","undefined","select","clientIds","getBlockIndex","getBlockRootClientId","getBlockOrder","getBlockName","getBlock","normalizedClientIds","block","blockName","blockType","title","firstClientId","rootClientId","blockOrder","firstIndex","lastIndex","isDefaultBlock","isEmptyContent","attributes","content","isExactlyOneBlock","dispatch","moveBlocksDown","moveBlocksUp"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { Platform, findNodeHandle } from 'react-native';\nimport { partial, first, castArray, last, compact } from 'lodash';\n/**\n * WordPress dependencies\n */\nimport { ToolbarButton, Picker } from '@wordpress/components';\nimport { getBlockType, getDefaultBlockName } from '@wordpress/blocks';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport { moreHorizontalMobile, trash, cog } from '@wordpress/icons';\nimport { useRef } from '@wordpress/element';\n/**\n * Internal dependencies\n */\nimport { getMoversSetup } from '../block-mover/mover-description';\n\nconst BlockActionsMenu = ( {\n\tonDelete,\n\tisStackedHorizontally,\n\twrapBlockSettings,\n\twrapBlockMover,\n\topenGeneralSidebar,\n\tonMoveDown,\n\tonMoveUp,\n\tisFirst,\n\tisLast,\n\tblockTitle,\n\tisEmptyDefaultBlock,\n\tanchorNodeRef,\n} ) => {\n\tconst pickerRef = useRef();\n\tconst moversOptions = { keys: [ 'icon', 'actionTitle' ], blockTitle };\n\n\tconst {\n\t\ticon: { backward: backwardButtonIcon, forward: forwardButtonIcon },\n\t\tactionTitle: {\n\t\t\tbackward: backwardButtonTitle,\n\t\t\tforward: forwardButtonTitle,\n\t\t},\n\t} = getMoversSetup( isStackedHorizontally, moversOptions );\n\n\tconst deleteOption = {\n\t\tid: 'deleteOption',\n\t\t// translators: %s: block title e.g: \"Paragraph\".\n\t\tlabel: sprintf( __( 'Remove %s' ), blockTitle ),\n\t\tvalue: 'deleteOption',\n\t\ticon: trash,\n\t\tseparated: true,\n\t\tdisabled: isEmptyDefaultBlock,\n\t};\n\n\tconst settingsOption = {\n\t\tid: 'settingsOption',\n\t\t// translators: %s: block title e.g: \"Paragraph\".\n\t\tlabel: sprintf( __( '%s Settings' ), blockTitle ),\n\t\tvalue: 'settingsOption',\n\t\ticon: cog,\n\t};\n\n\tconst backwardButtonOption = {\n\t\tid: 'backwardButtonOption',\n\t\tlabel: backwardButtonTitle,\n\t\tvalue: 'backwardButtonOption',\n\t\ticon: backwardButtonIcon,\n\t\tdisabled: isFirst,\n\t};\n\n\tconst forwardButtonOption = {\n\t\tid: 'forwardButtonOption',\n\t\tlabel: forwardButtonTitle,\n\t\tvalue: 'forwardButtonOption',\n\t\ticon: forwardButtonIcon,\n\t\tdisabled: isLast,\n\t};\n\n\tconst options = compact( [\n\t\twrapBlockMover && backwardButtonOption,\n\t\twrapBlockMover && forwardButtonOption,\n\t\twrapBlockSettings && settingsOption,\n\t\tdeleteOption,\n\t] );\n\n\tfunction onPickerSelect( value ) {\n\t\tswitch ( value ) {\n\t\t\tcase deleteOption.value:\n\t\t\t\tonDelete();\n\t\t\t\tbreak;\n\t\t\tcase settingsOption.value:\n\t\t\t\topenGeneralSidebar();\n\t\t\t\tbreak;\n\t\t\tcase forwardButtonOption.value:\n\t\t\t\tonMoveDown();\n\t\t\t\tbreak;\n\t\t\tcase backwardButtonOption.value:\n\t\t\t\tonMoveUp();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfunction onPickerPresent() {\n\t\tif ( pickerRef.current ) {\n\t\t\tpickerRef.current.presentPicker();\n\t\t}\n\t}\n\n\tconst disabledButtonIndices = options\n\t\t.map( ( option, index ) => option.disabled && index + 1 )\n\t\t.filter( Boolean );\n\n\tconst accessibilityHint =\n\t\tPlatform.OS === 'ios'\n\t\t\t? __( 'Double tap to open Action Sheet with available options' )\n\t\t\t: __( 'Double tap to open Bottom Sheet with available options' );\n\n\treturn (\n\t\t<>\n\t\t\t<ToolbarButton\n\t\t\t\ttitle={ __( 'Open Block Actions Menu' ) }\n\t\t\t\tonClick={ onPickerPresent }\n\t\t\t\ticon={ moreHorizontalMobile }\n\t\t\t\textraProps={ {\n\t\t\t\t\thint: accessibilityHint,\n\t\t\t\t} }\n\t\t\t/>\n\t\t\t<Picker\n\t\t\t\tref={ pickerRef }\n\t\t\t\toptions={ options }\n\t\t\t\tonChange={ onPickerSelect }\n\t\t\t\tdestructiveButtonIndex={ options.length }\n\t\t\t\tdisabledButtonIndices={ disabledButtonIndices }\n\t\t\t\thideCancelButton={ Platform.OS !== 'ios' }\n\t\t\t\tanchor={\n\t\t\t\t\tanchorNodeRef ? findNodeHandle( anchorNodeRef ) : undefined\n\t\t\t\t}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default compose(\n\twithSelect( ( select, { clientIds } ) => {\n\t\tconst {\n\t\t\tgetBlockIndex,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockOrder,\n\t\t\tgetBlockName,\n\t\t\tgetBlock,\n\t\t} = select( 'core/block-editor' );\n\t\tconst normalizedClientIds = castArray( clientIds );\n\t\tconst block = getBlock( normalizedClientIds );\n\t\tconst blockName = getBlockName( normalizedClientIds );\n\t\tconst blockType = getBlockType( blockName );\n\t\tconst blockTitle = blockType.title;\n\t\tconst firstClientId = first( normalizedClientIds );\n\t\tconst rootClientId = getBlockRootClientId( firstClientId );\n\t\tconst blockOrder = getBlockOrder( rootClientId );\n\n\t\tconst firstIndex = getBlockIndex( firstClientId, rootClientId );\n\t\tconst lastIndex = getBlockIndex(\n\t\t\tlast( normalizedClientIds ),\n\t\t\trootClientId\n\t\t);\n\n\t\tconst isDefaultBlock = blockName === getDefaultBlockName();\n\t\tconst isEmptyContent = block.attributes.content === '';\n\t\tconst isExactlyOneBlock = blockOrder.length === 1;\n\t\tconst isEmptyDefaultBlock =\n\t\t\tisExactlyOneBlock && isDefaultBlock && isEmptyContent;\n\n\t\treturn {\n\t\t\tisFirst: firstIndex === 0,\n\t\t\tisLast: lastIndex === blockOrder.length - 1,\n\t\t\trootClientId,\n\t\t\tblockTitle,\n\t\t\tisEmptyDefaultBlock,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientIds, rootClientId } ) => {\n\t\tconst { moveBlocksDown, moveBlocksUp } = dispatch(\n\t\t\t'core/block-editor'\n\t\t);\n\t\tconst { openGeneralSidebar } = dispatch( 'core/edit-post' );\n\n\t\treturn {\n\t\t\tonMoveDown: partial( moveBlocksDown, clientIds, rootClientId ),\n\t\t\tonMoveUp: partial( moveBlocksUp, clientIds, rootClientId ),\n\t\t\topenGeneralSidebar: () => openGeneralSidebar( 'edit-post/block' ),\n\t\t};\n\t} ),\n\twithInstanceId\n)( BlockActionsMenu );\n"]}